年

第

2022
卷
43

11
第

11

月

计算机工程与设计

期

COMPUTERENGINEERING AND DESIGN

Nov.2022
Vol.43 No.11

基于眼睛状态多特征融合的疲劳驾驶检测

任

俊,魏

霞 + ,黄德启,刘

栋

摘

要:为解决驾驶状态中光照及头部姿势变化等因素对眼睛状态检测影 响 的 问 题, 提 出 一 种 基 于 多 特 征 融 合 的 眼 睛 状 态

(新疆大学 电气工程学院,新疆 乌鲁木齐

)

830047

识别方法。采用级联回归树算法定位人脸特征点,利用欧拉角对人脸特征 点 校 正 后 得 到 人 眼 的 纵 横 比 特 征、 根 据 人 眼 二 值

图像得到累积黑色素差值特征以及人眼水平投影高宽比特征,在此基础上提 出 融 合 这

个 特 征 并 使 用 支 持 向 量 机 分 类 器 进

行眼睛状态识别,根据筛选机制以及

准则判别 疲 劳 状 态。实 验 结 果 表 明, 该 算 法 疲 劳 检 测 准 确 率 为

可以检测多种姿态下的眼睛状态,满足实时性的要求。

PERCLOSE

3

,

97.05%

关键词:特征点检测;眼部状态识别;支持向量机分类器;多特征疲劳检测;眼睛筛选机制

中图法分类号:

TP391.4 

文献标识号:

A  

文章编号:

1000-7024

(
2022

)

11-3187-08

doi:

10.16208/j.issn1000-7024.2022.11.025

Fatiguedrivingdetectionbasedonmulti-featurefusionofeyestate

RENJun,WEIXia

+

,HUANG De-qi,LIU Dong

(SchoolofElectricalEngineering,XinjiangUniversity,Urumqi830047,China)

Abstract

:Tosolvetheproblemoftheinfluenceofilluminationandthechangeofheadpostureoneyestatedetectionindriving
state,aneyestaterecognitionmethodbasedonmulti-featurefusionwasproposed.Cascaderegressiontreealgorithm wasusedto
locatefacialfeaturepoints,Eulerangleoffacefeaturepointswasusedforcorrectiontogetaspectratiocharacteristicsofthe
humaneye,accumulated melanindifferencecharacteristicsaccordingtothehumaneyebinaryimageandhorizontalprojection

ratiocharacteristics.Thesethreecharacteristicswerefusedandthesupportvectormachineclassifierwasusedforeyestatereco-

gnition.ThefatiguestatewasdeterminedaccordingtothescreeningmechanismandPERCLOSEcriterion.Experimentalresults
showthatthefatiguedetectionaccuracyofthealgorithmis97.05%,whichcandetectthestateofeyesinavarietyofpostures

andmeetthereal-timerequirements.
Keywords

:featurepointdetection;eyestaterecognition;SVMclassifier;multi-featurefatiguedetection;eyescreeningmecha-

nism

0

引

言

视觉检测 [1-3]主要提取面部 特 征 来 判 断 疲 劳 状 态

然 而

,

这些特征提 取 会 受 到 外 界 干 扰

如 何 避 免 光 照

眼 镜 以 及

、

,

姿势等因素的影 响

究的关键

其中

。

,

提 高 疲 劳 状 态 检 测 的 精 度 和 速 度 是 研

,
吴 良 超 等 [4]提 出 构 建 特 征 点 动 态 变 化 图

和神经网络的动 态 表 情 结 合 的 识 别 法

该 方 法 通 过 特 征 点

,

动态变化图提取 人 脸 轮 廓 信 息

用 卷 积 和 循 环 神 经 网 络 提

取人脸的纹 理 信 息

、

,
人 脸 序 列 的 时 序 信 息

树结合统计量特 征

提 出

,
够有效提高疲劳 识 别 准 确 率 和 稳 定 性

CNBT

人 脸 特 征 点 检 测 算 法

能

,

但 是 没 有 考 虑 驾 驶

,

员头部姿势变化等情况

对于上述提到的 问 题

,

在真实环 境 下 的 实 用 性 有 待 提 高

,
需 要 设 计 一 种 实 用 性 广 泛 的 疲 劳 检

。

测框架尤为重要

,

同 时 由 于 驾 驶 员 会 有 不 同 程 度 的 头 部 偏

转

采用单眼检 测 来 代 替 传 统 的 双 眼 检 测 机 制

增 强 检 测

,

提高实 用 性

,
累积黑色素 差 值 以 及 人 眼 水 平 投 影 高 度 和 宽 度 比 值

。

根 据 特 征 点 和 二 值 图 像 得 到 的 纵 横

,
的范围

比值

、

3

个 输 入 特 征

,

进 而 在 三 维 立 体 图 形 中

最后根 据 眼 睛 状 态 计 算 ECR 值 作

,

着人脸特征点检 测 改 进 算 法 进 行 疲 劳 检 测

通 过 牛 顿 提 升

得到眼睛状态分类结果

樊 飞 等 [5]围 绕

作为支持向量机 的

。

,

修订日期

:2021-04-21;

:2021-09-10

国家自然科学基金项目

收稿日期

基金项目

作者简介

:

:

任俊

男

湖北黄冈人

硕士研究 生

(51468062)

,

(1996 ),

,
副教授

,

,

新疆乌鲁木齐人

硕士

研究方 向 为 工 业 大 数 据 技 术 与 控 制

黄 德 启

智能交通

刘栋

;

(1996 ),

男

,

硕士研究生

,

,

,
辽宁大连人

;
研究方向为智能算法

(1972 ),

。E-mail:1207876082@qq.com

男

,

湖 北 武 汉 人

博 士

,

,

副 教 授

研 究 方 向 为

,

研 究 方 向 为 计 算 机 视 觉 与 疲 劳 驾 驶 检 测

,

通 讯 作 者

魏 霞

:

; +

(1976 ),

女

,

 
 
 
 
 
 
 
计算机工程与设计

年

2022

·8813·

为眼部疲劳特征参数判断驾驶员的疲劳状态

。

1

图像预处理及人脸检测与跟踪

1.1

本文整体流程设计图

本文框架分 为

3
对定位 好 的

踪人脸

,
合判别疲劳状态

,

个 部 分

,

经 过 图 像 预 处 理 后 检 测 和 跟

类 特 征 点 进 行 提 取 和 校 正

特 征 融

,

3

本文设计流程如图

所示

。

1

图

2 

光照均匀化前后对比

1.3

基于 AdaBoost人脸检测

基于

特征的

人脸检测算法

1.3.1 

Haar-like

目前在人脸 检 测 过 程 中

AdaBoost
人 脸 图 像 可 以 用 图 像 灰 度 变

,

化 的 特 征 来 表 征

而

,

Haar-like

特 征 [7]可 以 反 映 灰 度 变 化

。

先用积分图算法 快 速 得 到 任 意 区 域 的 像 素 和

素灰度和差值来得到

模板特征

用于人脸检 测

,
果较好强分 类 器

Haar-like

。AdaBoost

是 通 过 训 练 集 训 练 弱 分 类 器

形 成 分 类 效

,

进 而 训 练 出 最 能 代 表 面 部 特 征

从 而 加

,

,

再 可 以 由 像

,

算法 [8]

快检测速度和提高准确率

其算法流程如图

。

所示

。

3

图

1 

设计流程

1.2

图像滤波去噪与光照均衡化处理

在实际采集驾 驶 员 视 频 和 图 片 时 可 能 会 受 到 周 围 环 境

的噪声和光 照 的 影 响

,

采集的图像进行 滤 波 去 噪

使 得 图 像 变 得 模 糊

因 此 需 要 先 对

,
提 高 后 期 人 脸 检 测 和 特 征 提 取

,
采 用 自 适 应 中 值 滤 波 [6]的 方 式

的准 确 率

。

值滤波来消除孤立的斑点

,

,
并采取自适应邻域中值代替是 噪

实 际 是 利 用 中

声的原始像素 值

,

再 采 用 图 像 动 态 阈 值 的 光 照 均 衡 化 处 理

,

使图像的光照均匀分布

如图

,

光照和亮度得到较好的改善

,

所示

均衡 化 处 理 后

,
2
进而有效提取人脸的特征

,

图 片

。

图

3 AdaBoost

算法流程

实验结果分析

1.3.2 

对人脸特征 识 别 完 成 后 进 而 对 眼 睛 特 征 进 行 检 测

输

,

出可以识别的人 脸 区 域 和 眼 睛 区 域 的 矩 形 框

检 测 效 果 如

,

 
 
 
 
 
第

43

卷

第

期

11

任俊,魏霞,黄德启,等:基于眼睛状态多特征融合的疲劳驾驶检测  

·9813·

所示

图

4

,

可以清楚标识出来

。

点

,

眼睛纵横比计算公式

EAR =

|P

2

-P

|+|P
-P

6
|P

-P
|

5

|

2

1

3
4

(1)

图

4 

人脸检测效果

1.4

面部目标跟踪算法

由式

得来的

,

图

6 

人眼特征点分布

可知EAR 由 眼 睛 纵 向 长 度 与 横 向 长 度 比 值

(1)
当 头 部 左 右 偏 转 时

眼 睛 的 横 向 长 度 发 生 变 化

,

,

考虑到在实 际 图 像 采 集 的 过 程 中

,

由 于 驾 驶 员 面 部 偏

当头部上下 点 动 时

眼 睛 的 纵 向 长 度 发 生 变 化

,

移距离较小

都在一定范围内

,
只需要跟踪人脸 上 一 帧 人 脸 信 息

,

在 第 一 次 检 测 到 人 脸 之 后

,

头部左右偏转和 上 下 点 动 时 进 行 特 征 点 校 正

。

快 速 获 得 下 一 帧 人 脸 位

纵向长度变化

。

,

。
图

因 此 针 对

为 眼 睛

7

置信息

脸跟踪

。

,

采用基于 帧 间 差 分 法 的

算 法 [9]进 行 人

MeanShift

利 用 连 续 两 帧 图 像 之 间 的 联 系

进 行 差 分 运 算

,

,

然后利用二分阈 值 法 提 取 边 缘 区 域

获 得 下 一 帧 人 脸 的 位

,

置信息

,

提高检测速度

。

2

基于SVM 的睁闭眼状态识别

2.1

基于级联回归树的人脸特征点定位

为了减少外界 环 境 因 素 对 人 脸 特 征 部 位 的 检 测 及 定 位

的影响

,

在人眼检 测 定 位 之 前 先 使 用 了 基 于 级 联 回 归 树 算

法 [10-12]

对人脸的 关 键 特 征 点 进 行 定 位

然 后 在 人

,

(ERT)
脸特征点定 位 的 基 础 上

快 速 定 位 到 人 眼

基 于 级 联 回 归

。

,

树算法是一种人 脸 对 齐 算 法

,

不 断 检 测 特 征 点 然 后 进 行 更

新

,

最后逐步定位到真实人脸位置

。

如图

所示

5

,ERT

点定位且效果较好

。

算 法 可 以 实 现 多 个 角 度 的 人 脸 特 征

图

5 

不同角度人脸特征定位

2.2

基于人眼特征点计算人眼纵横比

在提取人脸 特 征 点 之 后

通 过 实 验 发 现

,

常眨眼过程 中

,

眼 睛 的 特 征 点 也 会 随 之 变 化

驾 驶 员 在 正

因 此 我 们 根

,

,

据人眼特征点来求 取 眼 睛 的 纵 横 比 值 来 表 示 人 眼 的 状 态 信

睁开时纵横比维持在

息

。

而且纵横比值 不 会 因 为 驾 驶 员 面 部 位 置 和 摄 像 头 距 离

为闭眼状态

。

改变而改变

如图

所示P
1

到 P
6

6

。

分 别 对 应 人 眼

6

个 特 征

状态

。

则有

h
0

β0

cos

=

h
1

β1

cos

图

7 

人眼纵向长度变化

中l

0

表示初 始 状 态 下 真 实 眼 睛 的 纵 向 长 度

导致俯仰角β0
,
为l

和β2,
l
0
投 影 到 二 维 图 像 的 高 度
h
,
1

变成β1

2。
1
由于 实 际 情 况 下 点 头 和 偏 转 眼 睛 真 实 纵 向 长

为l

h
0

0

分 别

,
也随之

图

7

发生了点头和抬头

变化为l

1

和l

投影的高度

度不变

,

,
即l

l

1,

0=

(2)
分 别

以 w

和 w

1

,

0
α
0

,
得到 w

0

和α

1

分 别

和 w

1

关系

(3)

人眼左右偏转变化和上 述 过 程 类 似

表示初始 状 态 下 以 及 变 化 后 的 眼 睛 横 向 长 度

代表初始状态下以及变化后的偏转角

,

w
0
α
0

cos

=

w
1
α
1

cos

由此可以得到图像中人眼纵横比为

EAR

0 =

h
0
w
0

=EAR

式中

EAR
1

:

是校正前眼睛纵横比值

纵横比值随 帧 数 变 化 的 折 线 图

α
1 ×cos
α
cos
图

1cos
0cos

β0
(4)
β1
是校正后的眼睛

,
由 图

8
可 以 看 出

8

当 纵 横 比 小 于

,

当 眼 睛

时 可 视

0.2

,

左 右

,

0.32

因此 可 以 通 过 计 算 人 眼 纵 横 比 值 来 判 断 人 眼

 
  
 
 
 
 
·0913·

计算机工程与设计

年

2022

图

8 

人眼纵横比值随帧数变化

2.3

基于自适应阈值计算人眼黑色像素累积差值

根据定位 的 人 眼 区 域

,

先 进 行 人 眼 图 像 二 值 化 处 理

,

再经过中值滤波 处 理 后 显 示 眼 睛 的 轮 廓

状态下的二值图像

。

表

,

1

为 人 眼 不 同

表

1 

人眼不同状态二值图像

人眼状态

人眼图像

人眼二值图像

保持

右睁眼

右半闭

右闭眼

图

9 

人眼睁闭过程中黑色像素值随帧数变化

因此它不累加

,
然而对于如图

。

所 示

图

,

10

(a)

法在识别眼睛状态时存在以下问题

如 图

帧所示

,
虽 然 它 们 显 示 的 是 闭 眼

这 种 情 况

累 积 差 值

,
的 第

(b)

和

257

但 是 由 于 差 值 大 于

260

,
它们不是累 积 的

0,
被错误地识别为 睁 开 眼 睛

,

导 致 图

,

,
的 第

(b)

帧 到

帧 都

255

260

因 此 使 用 了 具 有 自 适 应 阈 值 的

在眼睛闭上 的 情 况 下

,

计 算 眼 睛 区 域 内 的 黑 色 像 素 数

累积差值作为特征

。

的累积差值

,

虽 然 睫 毛 和 眼 睑 等 黑 色 区 域 可 能 会 保 留

但

是瞳孔区域 最 大 的 黑 色 区 域 不 会 出 现

也 就 是 说

,

,

闭上的时候

,

黑 色 像 素 数 量 会 比 睁 眼 的 时 候 大 幅 减 少

而

,

黑色像素的 数 量 不 仅 会 随 着 眼 睛 状 态 变 化 而 变 化

然

还

,

,

会随摄像头与驾 驶 员 面 部 的 距 离 变 化 而 变 化

当 这 个 距 离

,

,
当 眼 睛

增大时

眼睛区域黑色素的数量会减小

。

所 示

图

显 示 了 根 据 帧 数 变 化 的 二 值 化 区

,
域内的黑色像素数

9

(a)
看到在第

101
眼睛区域的黑色像素减小

,

帧之后当面 部 离 开 摄 像 头

因 此 仅 使 用 第

,

101

帧 之

就无法区分第

帧之后的眼睛是 睁 开 还 是 闭 上

,

101
可以采用连续图像中眼睛区域的黑色素的差值

。

,
如图

更远时

,
前的阈值

的

,

当采用的连续 图 像 中 眼 睛 区 域 的 黑 色 像 素 的 差 值 作 为

特征时

,

可 以 识 别 部 分 闭 眼 状 态

但 如 图

,

帧

帧和

帧的差值小于静态阈值

中 在 第

(b)
41
错误地识别眼 睛

、105

106
为了解 决 这 一 问 题

状况

,

,
像中黑色像素数 的 累 积 差 值

的差 值 小 于

的 条 件 下

,

0

(c)
帧时

102

尽管差值小于

,

0,

,

使 用 一 种 新 的 特 征

即 眼 睛 图

,

当 检 测 连 续 两 帧 及 以 上 图 像

,
将 连 续 的 差 值 进 行 累 加

如

,
而 在 第

帧

,

40

但是 它 没 有 在 超 过 两 帧 情 况 下

图

中第一个 满 足 条 件 的 情 况 出 现 在 第

图

10 

自适应人眼睁闭过程中黑色像素值随帧数变化

如图

所 示

,

11

将 累 积 差 与 自 适 应 阈 值 的 使 用 规 则 建 模

 
 
第

43

卷

第

期

11

任俊,魏霞,黄德启,等:基于眼睛状态多特征融合的疲劳驾驶检测  

·1913·

为有限状 态 机 [13]

(FSM),FSM

有 两 种 状 态

状 态

,

0

和 状

线的高度

计 算 并 保 存

态

首先检测当前帧黑色像素与前一帧的差值是否大于或

分别记为

当 满 足

若大于或等于

设定为此时为状态

并保持状态不

睁眼状态

否则为闭眼状态

1,

等于

变

,

0,
否则由状态

0
变成状态

0

1,

差值是否小于阈值T

若 小 于 T

在状态

再检测此时 的

0

时

1
t
(

)

,
保 持 状 态

并

1,

连续累积差值

否则

,

,

变成状态

1

0,

差值不累积

t
(

时

)
状态

,

。

(5)

图

11 

有限状态机

基于自适应阈值黑色像素算法如下

N

t
(

Δ

),(

状态

F =

∑Δ
)=α
*

T

t
(
定义如下

N

t
(

)≤
|D

T

t
)Δ
(
t-
(

,

其中

N

Δ
为在t

-1

D

t-
(

,

1)

1)

N

状态

),(

0)
t
(
α
1)|,
t
)
(
帧的 累 积 差 值

FSM

像素数差值

之间的定值

。

设定为状态

1,

0,
如图

通过自适应阈值算法

如图

,

10 (c)
且差 值 小 于 阈 值

帧 开 始 差 值

255
进 行 连 续 累 加 差

中

,

中

帧和

帧差值可 以 正 确 累 计

10 (c)
帧到

257

260
帧可以正确判断为闭眼状态

因

,

255

260

基于积分投影计算人眼水平投影高度和宽度比值

小于

值

,
此第

2.4

根据定位的 人 眼 区 域

提 取 人 眼 二 值 化 图 像

,
得到如图

再 对 二

,

所 示 不 同 状 态 下 人 眼

12

值化图像进行水平投影

,

水平投影曲线

。

∈ [0,1]

(6)
为第t帧 与 前 一 帧 的 黑 色

首 先 对 每 个 样 本 进 行 提 取 人 脸 特 征 点

然 后 通 过

,

α为

,

0

到

1

式

计算眼睛 纵 横 比 值 记 为 第 一 个 特 征 值

(4)

F1、
应阈值法得到的黑色像素累积差值记为第二个特征值

。

由于不同特征 参 数 之 间 的 量 纲 不 同 导 致 数 值 较 小 的 特

和宽度

h

w,

H、W、K。

,

K

。

h、w
值 大 于

和

h/w
时

这

个 值

,

3

可 以 定 义

0.4

,

差较小

,
行二分 类

PyCharm

2.5.1 

ZJU
人戴眼镜

2.5

SVM 分类器融合多特征状态识别

SVM

类的分类器

通过找出边际最大的 决 策 边 界

来 对 数 据 进 行 分

,

拥有 更 大 的 边 际 的 决 策 边 界 在 分 类 中 泛 化 误

。

从而使实际样本间隔更大

通过

。

SVM

分类器 来 进

其 中 数 据 选 取

处 理

训 练

测 试 都 是 基 于

、

、

、
视觉库等平台进行具体实现的

,
开发环境和

数据选取

OpenCV

本文 从

驾 驶 环 境 中 拍 摄 的 视 频 数 据 集 [13]

YawDD
眨眼数据集 [14]中各选 取

人

男 女 各

,
20
再 从 中 采 集

人

,

其 中

20

张 睁 眼 图 像

人不 带 眼 镜

,20
张闭 眼 图 像

,
同 时 自 己 采 集

4000
张 睁 眼 图 像

4000
张闭眼图像

,
一共采集

2000

张睁眼和闭眼状态图像

、2000

。

12000

,
数据处理

2.5.2 

。

、

20

、

由 自 适

把

即

F2、

F3,

。

水平投影高度 和 宽 度 的 比 值

记 为 第 三 个 特 征 值

h/w

对每个样本提取

个特征 值

个 特 征 值 分 别 对 应

,3
对每个睁眼样本和闭眼样本都进行特征提取操作

3

X、Y、Z

轴

,

2.5.3 

特征参数归一化

征参数在训练过 程 中 的 占 比 较 小

需 要 对 每 个 特 征 参 数 数

,
标 准 化 方 法

即 求 取 原 始

,

据进行归一化处理

采用

,

参数数据的均值 和 标 准 差

再 把 均 值 和 标 准 差 进 行 数 据 的

标准化处理

,

使 处 理 后 的 均 值 和 标 准 差 符 合 正 态 分 布

然

,

后再进行以下转化函数

Z-score

,

x* =

x-μx
σx

式中

x* 为归一化后的值

:

,

x 为 原 始 特 征 值

本数据的均值

σx 为所有样本数据的标准差

,

模型训练即参数寻优

2.5.4 

SVM

分类器 [15]可以表示为

N

(7)
,μx 为 所 有 样
。

x
f(

)=sign

aiyiK
1

i=

(
∑

x
(

xi)+b
)
,

K

x
(

,y)=e-γ x-y 2
w 2 +

m

ﻙ

minw
b
,

= 1
2

i=

C∑

1

(8)

(9)

(10)

:

状态类别

,yi

∈ {-

1,1}
表 示 睁 眼 状 态

为训练样本眼睛

,-1

表 示 闭 眼 状 态

xi)
,
系 数ai 可 以 通 过 由 线 性 约 束 的 二 次 规 划 得

x
(

,1

K

,

本 文 采 取

个 特 征 输 入

通 过 引 入

,
支持向 量 机 可 以 扩 展 到 非 线 性 决 策 面 上

3

。

然 后 利

,
来 寻 找 让 数 据 线

图

12 

不同状态下人眼水平投影曲线

式中

N 是训练数据的总数

如图

峰值较 小

12

,

中所示

,

眼睛睁开 时 纵 坐 标 跨 度 较 大

横 坐 标

,

而 闭 眼 时 纵 坐 标 跨 度 较 小

横 坐 标 峰 值 较 大

,

,

但是实际情况二 者 差 距 不 大

,

因 此 通 过 计 算 人 眼 水 平 投 影

表示核函 数

,
常数b是偏 差 项

到

,
核函数

,

的高度与宽度的 比 值 来 识 别 眼 睛 状 态

。

先 计 算 水 平 投 影 曲

用支持向量确定 可 以 区 分 两 类 的 超 平 面

,

 
  
 
 
 
·2913·

计算机工程与设计

年

2022

核 函 数 分 类

,RBF
核 函 数 进 行 模 型 训

的分类准确率对比

,

识别方法相较于

结果表明提出的

三维立体分类 的

SVM
二维平面分类的状态识别方法分类 准

参 数γ定 义 单 个 样 本 的 影 响
ﻙ 参 数 为

w 和b 是 模 型 参 数

,

确率更高

与 文 献

,
的准确率也都要更高

[16]

。

SVM

相 比

,

本 文 算 法 睁 眼 和 闭 眼 识 别

根 据 最 小 分 类 误 差

故本文 采 用

RBF

性可分的高位空 间

。
非线性情况效果较好

练

,
大小

式

,

松弛变量

,
核 函 数

为

(9)
式

RBF
为目标方程

(10)
惩罚参数

,

C

,

,

是 在 错 误 分 类 样 本 和 分 界 面 简 单 性

这 两 个 参 数 的 选 取 对 预 测 结 果 的 精 度 非 常

之间进行权衡

,

关键

。
的参数

为

和γ

,
每次选

C

组

我们通过分 类 器 交 叉 验 证 法 来 寻 找 使 预 测 结 果 最 优

从收集到的 特 征 值 中 选 取

组 特 征 值 分

2000

10

,
的所有特征值都 经 过 归 一 化 处 理

,

9

1

测 试 结 果 标 签 保 存 到 对

组为训 练 集

剩 余

组 为 测 试 集

选 取

,

应类别中

,

经 过 寻 优 发 现

,

模型预测分类效果较好

。

2.5.5 

当用

实验检测

SVM

分类器融合校正后的特征点计算人眼的纵 横

比值以及人眼二值图像计算累积黑 色 素 差 值 这 两 个 特 征 时

得出的二维平面分类结果如图

类别基本 可 以 区 分 开 来

,

所 示

,

睁 眼 和 闭 眼 这 两 种

13

但 是 还 是 有 少 量 类 别 区 分 错 误

,

。

SVM

和人眼二值图像计 算 累 积 黑 色 素 差 值 以 及 人 眼 水 平 投 影 高

度和宽度比值这

个 特 征 时

在 三 维 立 体 坐 标 系 中 进 行 分

3

所示

图

,
和 图

,

(b)
在二 维 平 面 分 类 错 误 的 点 在 三 维 坐 标 系 中 得

(a)

采 用 了 不 同 的 角 度 展

类

,

如图

14

示分类效果

,
到正确的区分

,
当 参 数

C=1.92,

=0.9

γ

时

,

表

3 

算法

表

2 

基于

SVM

融合多特征算法分类测试结果

眼睛
状态

睁眼

闭眼

识别状态

评估参数

睁眼 闭眼 准确率

/%

精确率

/%

召回率

/%

391 9

6 194

97.50

95.56

97

不同算法在眼睛状态分类对比

二维平面分类

三维立体分类

SVM

SVM

文献

[16]

闭眼准确

睁眼准确

平均准确

率

/%

95.03

97.26

—

率

/%

95.13

97.76

—

率

/%

95.08

97.51

97.18

在实际驾驶 过 程 中

,

驾 驶 员 会 有 多 种 头 部 姿 态

当 左

右偏头幅度 过 大 时

确提取双眼 的 特 征

终眼睛状态 的 判 断

,

,

,

会 出 现 一 只 眼 睛 被 遮 挡

一 旦 出 现 一 只 眼 睛 错 检

对 实 验 结 果 有 很 大 干 扰

,

,

。

,
这 时 很 难 准

就 会 影 响 最

为 验 证 头 部

当用

分类器融合校正后的特征点计算人眼的纵横比 值

2.6

基于眼睛筛选机制的实验对比

分类准确率提升到

,

97.51%。

多姿态时检测结果的准确率

,

以驾 驶 员 的 正 前 方 为 中 心 轴

,

头部向各个方向偏转一定角度进行双眼检测

。

如图

态实验图

15

。

所示

,

给出部分具有 代 表 性 的

种 头 部 偏 转 状

当驾 驶 员 头 部 偏 转 较 小 方 位 内

双 眼 检 测 可 以

4

,

达到较好效果

图

,

检测时出现 了 错 检

当头部出现极 端 角 度 时

眼 睛 状 态

,

准 确 率 会 大 幅 下 降

因 此 可 以 采 用 单

,

(d)

,

眼检测机 制

,
具体操作如图

用 未 被 遮 挡 的 单 只 眼 睛 代 替 双 眼 检 测 机 制

。

所示

。

16

图

13 SVM

二维平面分类结果

图

15 

双眼检测示例

图

中x

和x

2
个瞳孔中心间 的 距 离

16

1

分 别 表 示 检 测 框 的 宽 和 高

s表 示 两

,

d 表 示 瞳 孔 连 线 中 心 点 到 人 脸 右 框

,

图

14 SVM

三维立体分类结果

可 以 看 出

,

提 出 基 于 融 合 多 特 征 算 法 可 以 较

通过表

2

准确的识别眼睛 的 两 种 状 态

表

,

3

为 不 同 算 法 对 眼 睛 状 态

动角检测结果如图

17

,
所示

。

的距离

由于检 测 到 的 人 脸 大 小 不 一

切 割

,
提高准确率

,

,
中右眼进 行 状 态 判 断

令w=

x

3/4

1,

,

所 以 要 对 边 框 进 行

,

当d大于w

时只对图

/2

反 之 只 对 图 中 左 眼 进 行 状 态 判 断

这里测试

张人脸图像

分 别 选 取 在 转 动 角 度 为

600
以及转动角度为

30°
第二组检测闭眼 状 态

,
到

-60°

60°

情况

,

-30°
第一组检测睁眼状态

实 验 部 分 单 眼 检 测 不 戴 眼 镜 各 种 转

。

到

,

 
 
第

43

卷

第

期

11

任俊,魏霞,黄德启,等:基于眼睛状态多特征融合的疲劳驾驶检测  

·3913·

检测和双眼检测的准确率

各选取

,

眼镜

总共 从 拍 摄 的 视 频 中 选 取

20

组不戴眼镜

组戴

,10

帧 图 片

见 表

,

6,
实验结果表明自适 应 单 眼 检 测 无 论 是 在 戴 眼 镜 还 是 不 戴 眼

10000

,

镜情况下准确率都更高

。

表

6 

单眼检测和双眼检测眼睛状态对比

戴眼镜

不戴眼镜

总计

双眼

单眼

双眼

单眼

双眼

单眼

2000 2000 3000 3000 5000 5000

212

108

174

72

386

180

参数

检测

错检

准确率

/% 89.4 94.6 94.2 97.6 91.8 96.4

2.7

疲劳驾驶检测

当在实际行 驶 过 程 中

,

驾 驶 员 疲 劳 时 会 出 现 频 繁 眨 眼

的现象

,

同时眼 部 状 态 信 息 是 最 能 显 示 疲 劳 状 态

为 此 可

,

以通过获取驾驶员 眼 部 的 状 态 信 息 来 判 断 驾 驶 员 的 疲 劳 状

态

。

本文选取基于

准 则 [17]的 ECR 作 为 眼 部 疲
ECR 指检 测 到 闭 合 状 态 时 帧 数 与 一 次 眨 眼 整

PERCLOSE

劳特征参数

,

个过程帧数的比率

即

,

ECR =

n
N

×

100%

式中

n为闭合状 态 时 帧 数

:

N 为 眨 眼 整 个 过 程 帧 数

,

据眼睛筛 选 机 制 判 断 眼 睛 状 态 方 法 得 到 参 数n 和 N

(11)
根

,

当

,

ECR 范围在

到

视 为 疲 劳 状 态

视为正常状态

ECR范围在

到

0.2

0.3

0.3

1

,

,

ECR 范 围 在

到

0.2
内时介于正常和疲劳

0

状态之间

,

为 此 对 ECR 这 个 范 围 的 阈 值 进 行

组 测 试

,

6000

测试结果见表

当ECR为

时

,

0.25

7,

检测的准确率最高

。

表

7 

不同

ECR

ECR

正常状态误检个数

疲劳状态误检个数

准确率

/%

值的疲劳检测准确率对比

0.2

0.25

0.3

67

91

21

38

7

176

92.1

97.05 90.85

文献

采用

[18]

CNN

回归网络检测人脸 关 键 点

并 用

,

宽度学习对 面 部 状 态 进 行 判 别

最 后

,

,

通 过 二 级 宽 度 学 习

网络融合眼 睛

,

嘴 部 和 头 部 状 态 预 测 驾 驶 员 疲 劳 状 态

文

。

献

[19]

采用 深 度 卷 积 层 学 习 获 取 图 像 和 特 征

并 利 用 相

,

邻帧间关系预测疲劳 状 态

不 同 算 法 疲 劳 检 测 对 比 见 表

相比之下本 文 精 度 更 高

,
根 据 研 究 发 现

8,
驾 驶 员 正 常 情 况

。

,

下的眨眼频率为

到

15

30

次

分钟

/

本文 提 出 的 方 法 检 测 每

,

帧图片只需要

正常平均每次眨眼

所以本文算法可 以 检 测 多 种 姿 态 下 的 眼 睛 状 态

0.091s,

到

0.3s,
同 时 满 足

0.25s

,

实时性的要求

。

3

结束语

图

16 

眼睛筛选机制

图

17 

基于眼睛筛选机制单眼检测不戴眼镜示例

如图

18

所示

,

第一组检测 睁 眼 状 态

第 二 组 检 测 闭 眼

,

戴眼镜时单眼检测不同转动角识别效果也较好

。

状态

,

图

18 

基于眼睛筛选机制单眼检测戴眼镜示例

由表

和表

4

5

可 知

,

单 眼 检 测 对 头 部 适 应 性 较 好

当

,

检测到头部大幅度偏转时采用单眼检测具有较高准确率

。

表

4 

单眼检测不戴眼镜结果

转动角

检测

错检

准确率

/%

右偏

右偏

左偏

左偏

30°

60°

30°

60°

100

100

100

100

0

3

0

2

100

97

100

98

表

5 

单眼检测戴眼镜结果

转动角

检测

错检

准确率

/%

右偏

右偏

左偏

左偏

30°

60°

30°

60°

100

100

100

100

1

5

0

4

99

95

100

96

采用

YawDD

视频数据集

、ZJU

眨眼数据集来测试单眼

的方法进行特征提取

基于

,

SVM

分类器融合人眼的纵横比

本文提出多 特 征 融 合 的 疲 劳 驾 驶 检 测 方 法

通 过 传 统

,

 
  
 
 
·4913·

表

算法

8 
准确率

不同算法的疲劳检测性能对比

/%

精度

/%

召回率

/%

速率

/ms

文献

[18]

94.9

—

—

文献

[19]
本文算法

96.12

95.83

95.83

97.05

97.86

96.2

52

132

91

值

、
特征

累积黑色素 差 值

、

人 眼 水 平 投 影 高 度 和 宽 度 比 值

3

再结合眼 睛 筛 选 机 制 进 行 状 态 检 测

,

,

不 仅 可 以 适 应

不同光照强 度

、

减 少 头 部 姿 态 和 戴 眼 镜 的 干 扰

而 且 能 实

,

实 验 结 果 表 明 该 方 法 具 有 较 高 的

时更新检测的疲 劳 状 况

,

识别率和较强的实用性

。

参考文献:

[1]ZhangYingyu.Humanfactorsrelatedtomajorroadtrafficacci-

dentsinChina [J].TrafficInjuryPrevention,2019,20 (8):

796-800.

[2] WangJun.Researchonkeytechnologiesofintelligenttranspor-

tationbasedonimagerecognitionandanti-fatiguedriving [J].

EURASIPJournalonImageand VideoProcessing,2019 (1):

1-13.

[3]XU Lian,REN Xiaohong,CHEN Runxue.Fatigue driving

detectionbasedoneyestaterecognition [J].ScienceTechnology

andEngineering,2020,20 (20):8292-8299 (in Chinese).
基 于 眼 睛 状 态 识 别 的 疲 劳 驾 驶 检 测

陈闰 雪

任小洪

徐莲

[

[J].

,
科学技术与工程

,

.

,2020,20 (20):8292-8299.]

[4] WU Liangchao.Faceexpressionrecognitionalgorithmbasedon

dynamicchangeoffeaturepoints [D].Guangzhou:SouthChina
吴 良

UniversityofTechnology,2019:46-63 (inChinese). [
超

基于 特 征 点 动 态 变 化 的 人 脸 表 情 识 别 算 法

广 州

.

华南理工大学

,2019:46-63.]

[5]FAN Fei.Improvementoffacefeature pointdetection algo-

rithm andresearchoffatiguedetectionalgorithm [D].Nan-
樊

jing:SoutheastUniversity,2019:23-31 (inChinese). [
人脸特征点检测算法的改进 与 疲 劳 检 测 算 法 的 研 究
飞

.
南京

东南大学

:

,2019:23-31.]

[6]Bharat Garg. Restoration of salt-and-pepper-noise-corrupted

imagesusingnoveladaptivetrimmedmedianfilter [J].Signal,

ImageandVideoProcessing,2020 (5):1-9.

计算机工程与设计

年

2022

[J].InternationalJournalofComputer Applicationsin Tech-

nology,2019,6 (1):1-6.

[10]XU Qingyun.Researchandimplementationoffatiguedriving

recognitionalgorithmbasedon multi-feature [D].Changsha:
基

徐 青 云

HunanUniversity,2019:28-31 (inChinese). [
于多特征的疲劳驾驶识别算 法 研 究 与 实 现

长 沙

.
湖 南

[D].

:

大学

,2019:28-31.]

个

[11]LIYuelong,JIN Yan, WANGJianming,etal.Areviewof

facialfeaturepointextraction methods [J].JournalofCom-

puters,2016,39 (7):1356-1374 (inChinese). [
靳彦

人脸特 征 点 提 取 方 法 综 述

汪剑鸣

等

,

,

.

李 月 龙

,

计 算 机

[J].

学报

,2016,39 (7):1356-1374.]

[12]Nagumo Kent. Face alignmentin thermalinfrared images

usingcascadedshaperegression [J].InternationalJournalof

EnvironmentalResearchand Public Health,2021,18 (4):

110-113.

[13]Gadelhag Mohmed, Ahmad Lotfi, Amir Pourabdollah.En-

hancedfuzzyfinitestatemachineforhumanactivity modelling

andrecognition [J].JournalofAmbientIntelligenceand Hu-

manizedComputing,2020 (2):1-15.

[14]CHEN Xuexin.Deepbeliefnetworkfacerecognitionalgorithm

basedon multi-leveltexturefeature [J].Computer Applica-

tionsandSoftware,2020,37 (4):156-163 (in Chinese).
基于多级纹 理 特 征 的 深 度 信 念 网 络 人 脸 识 别 算 法

陈雪鑫

[

.

[J].

计算机应用与软件

,2020,37 (4):156-163.]

[15]DongYanchao.Comparisonofrandom forest,random ferns

andsupportvector machineforeyestateclassification [J].

MultimediaToolsand Applications,2016,75 (19):11763-

11783. 

[D].

[16]HUANG Xin,SHEN Yingchao.Fatigue driving detection

:

methodbasedondeeplearning [J].JournalofGuilinUniver-

sityof Electronic Scienceand Technology,2020,40 (3):
基于深度学习的疲劳

沈英超

黄新

201-206 (inChinese).[
驾驶检测方法

,

.

桂林电子科 技 大 学 学 报

[J].

,2020,40 (3):

[D].

201-206.]

[17]HU Xizhi, HUANG Bingyu.Fatiguedrivingdetection method

basedonfacialfeatureanalysis [J].ScienceTechnologyand
胡习

Engineering,2021,21 (4):1629-1636 (inChinese).[
之

基 于 面 部 特 征 分 析 的 疲 劳 驾 驶 检 测 方 法

黄冰瑜

[J].

,

.

科学技术与工程

,2021,21 (4):1629-1636.]

[7]HU Fengsong.Fatiguedrivingidentification methodandsys-

[18]ZHU Yubin.Fatigue driving detection based on cascading

tem based on multi-feature [P]. China: CN111582086A,
基于多特征 的 疲 劳 驾 驶 识
胡峰松

2020-08-25 (inChinese).[
别方法及系统

中国

.

[P].

:CN111582086A,2020-08-25.]

widthlearning [J].ComputerEngineeringandDesign,2020,
基于级联宽度学习

朱玉斌

41 (2):537-541 (inChinese).[
的疲劳驾驶 检 测

.
计 算 机 工 程 与 设 计

[J].

,2020,41 (2):

[8]Yan Chen, Wang Zhengqun,Xu Chunlin. Gentle Adaboost

537-541.]

algorithmbasedonmulti-featurefusionforfacedetection [J].

[19]XiaoZ, Hu Z,Geng L,etal.Fatiguedrivingrecognition

TheJournalofEngineering,2019 (15):609-612.

network:Fatiguedrivingrecognitionviaconvolutionalneural

[9]Jiao Ding.Improvedfacerecognition with acceleratedrobust

networkandlongshort-term memoryunits [J].IETIntelli-

featuresimprovedby meansof meanshiftk-meansclustering

gentTransportSystems,2019,13 (9):1410-1416.

 
