　 ２０２４ 年第４３ 卷第４ 期　

　 传感器与微系统（Ｔｒａｎｓｄｕｃｅｒ ａｎｄ Ｍｉｃｒｏｓｙｓｔｅｍ Ｔｅｃｈｎｏｌｏｇｉｅｓ）

５１１

ＤＯＩ：１０． １３８７３ ／ Ｊ． １０００—９７８７（２０２４）０４—０１１５—０４

■■■■■

■计算与测试

■■■■■

■
■
■

■
■

基于注意力机制改进的疲劳驾驶检测方法*
徐敬一１，田　 瑾１，刘　 翔１，龚　 利２
（１． 上海工程技术大学电子电气工程学院，上海２０１６２０;
２． 华东师范大学通信与电子工程学院，上海２０００６２）
摘　 要：由于疲劳驾驶采集过程中存在因识别角度不佳，部分区域遮挡等原因，在不同时间段丢失了不同
特征的时间信息，导致算法的泛用性较差。此外，驾驶疲劳的检测需要在保证综合准确率的同时，需要具
有更低的漏检率。针对以上问题，提出了一种基于注意力机制和长短期记忆（ＬＳＴＭ）神经网络的疲劳驾驶
检测模型。通过对不同特征定位点计算多维特征向量，并对特征向量的时间序列进行学习，同时引入注意
力机制，赋予各维度隐含状态不同的概率权重，加强重要信息对疲劳状态判定的影响和降低丢失特征信息
的历史数据对参数的影响。根据实验可得，该方法在更普遍的检测环境下有着９２． １９ ％的准确率和１． ９ ％
的漏检率，同时在丢失部分特征的环境下漏检率仅有３． ０７ ％。
关键词：疲劳检测；特征丢失；注意力机制；长短期记忆
中图分类号：ＴＰ ３９１　

　 文章编号：１０００—９７８７（２０２４）０４—０１１５—０４

　 文献标识码：Ａ　

Ｉｍｐｒｏｖｅｄ ｆａｔｉｇｕｅ ｄｒｉｖｉｎｇ ｄｅｔｅｃｔｉｏｎ ｍｅｔｈｏｄ ｂａｓｅｄ ｏｎ
ａｔｔｅｎｔｉｏｎ ｍｅｃｈａｎｉｓｍ*
ＸＵ Ｊｉｎｇｙｉ１，ＴＩＡＮ Ｊｉｎ１，ＬＩＵ Ｘｉａｎｇ１，ＧＯＮＧ Ｌｉ２
（１． Ｓｃｈｏｏｌ ｏｆ Ｅｌｅｃｔｒｏｎｉｃ ａｎｄ Ｅｌｅｃｔｒｉｃａｌ Ｅｎｇｉｎｅｅｒｉｎｇ，Ｓｈａｎｇｈａｉ Ｕｎｉｖｅｒｓｉｔｙ ｏｆ Ｅｎｇｉｎｅｅｒｉｎｇ ａｎｄ Ｔｅｃｈｎｏｌｏｇｙ，Ｓｈａｎｇｈａｉ ２０１６２０，Ｃｈｉｎａ；
２． Ｓｃｈｏｏｌ ｏｆ Ｃｏｍｍｕｎｉｃａｔｉｏｎ ａｎｄ Ｅｌｅｃｔｒｏｎｉｃ Ｅｎｇｉｎｅｅｒｉｎｇ，Ｅａｓｔ Ｃｈｉｎａ Ｎｏｒｍａｌ Ｕｎｉｖｅｒｓｉｔｙ，Ｓｈａｎｇｈａｉ ２０００６２，Ｃｈｉｎａ）

ｕｎｉｖｅｒｓａｌｉｔｙ ｏｆ

ｆａｔｉｇｕｅ ｄｒｉｖｉｎｇ

ｃａｌｃｕｌａｔｉｎｇ ｍｕｌｔｉ-ｄｉｍｅｎｓｉｏｎａｌ ｆｅａｔｕｒｅ ｖｅｃｔｏｒｓ ｆｏｒ ｄｉｆｆｅｒｅｎｔ ｆｅａｔｕｒｅ ｌｏｃａｌｉｚａｔｉｏｎ ｐｏｉｎｔｓ ａｎｄ ｌｅａｒｎｉｎｇ ｔｈｅ ｔｉｍｅ ｓｅｒｉｅｓ ｏｆ

Ａｂｓｔｒａｃｔ：Ｄｕｅ ｔｏ ｔｈｅ ｐｏｏｒ ｒｅｃｏｇｎｉｔｉｏｎ ａｎｇｌｅ ａｎｄ ｐａｒｔｉａｌ ａｒｅａ ｏｃｃｌｕｓｉｏｎ ｉｎ ｔｈｅ ｐｒｏｃｅｓｓ ｏｆ
ａｃｑｕｉｓｉｔｉｏｎ，ｔｈｅ ｔｉｍｅ ｉｎｆｏｒｍａｔｉｏｎ ｗｉｔｈ ｄｉｆｆｅｒｅｎｔ ｃｈａｒａｃｔｅｒｉｓｔｉｃｓ ｉｓ ｌｏｓｔ ｉｎ ｄｉｆｆｅｒｅｎｔ ｔｉｍｅ ｐｅｒｉｏｄｓ，ｒｅｓｕｌｔｉｎｇ ｉｎ ｐｏｏｒ
ｔｈｅ ａｌｇｏｒｉｔｈｍ． Ｉｎ ａｄｄｉｔｉｏｎ，ｔｈｅ ｄｅｔｅｃｔｉｏｎ ｏｆ ｄｒｉｖｉｎｇ ｆａｔｉｇｕｅ ｎｅｅｄｓ ｔｏ ｎｏｔ ｏｎｌｙ ｅｎｓｕｒｅ ｔｈｅ
ｃｏｍｐｒｅｈｅｎｓｉｖｅ ａｃｃｕｒａｃｙ，ｂｕｔ ａｌｓｏ ｈａｖｅ ａ ｌｏｗｅｒ ｍｉｓｓｅｄ ｄｅｔｅｃｔｉｏｎ ｒａｔｅ． Ｔｏ ｓｏｌｖｅ ｔｈｅ ａｂｏｖｅ ｐｒｏｂｌｅｍｓ，ａ ｆａｔｉｇｕｅ ｄｒｉｖｉｎｇ
ｄｅｔｅｃｔｉｏｎ ｍｏｄｅｌ ｂａｓｅｄ ｏｎ ａｔｔｅｎｔｉｏｎ ｍｅｃｈａｎｉｓｍ ａｎｄ ｌｏｎｇ ｓｈｏｒｔ-ｔｅｒｍ ｍｅｍｏｒｙ（ＬＳＴＭ）ｎｅｕｒａｌ ｎｅｔｗｏｒｋ ｉｓ ｐｒｏｐｏｓｅｄ． Ｂｙ
ｆｅａｔｕｒｅ ｖｅｃｔｏｒｓ，ｔｈｅ ａｔｔｅｎｔｉｏｎ ｍｅｃｈａｎｉｓｍ ｉｓ ｉｎｔｒｏｄｕｃｅｄ ｔｏ ｇｉｖｅ ｄｉｆｆｅｒｅｎｔ ｐｒｏｂａｂｉｌｉｔｙ ｗｅｉｇｈｔｓ ｔｏ ｔｈｅ ｈｉｄｄｅｎ ｓｔａｔｅｓ ｏｆ
ｅａｃｈ ｄｉｍｅｎｓｉｏｎ，ｓｏ ａｓ ｔｏ ｓｔｒｅｎｇｔｈｅｎ ｔｈｅ ｉｎｆｌｕｅｎｃｅ ｏｆ ｉｍｐｏｒｔａｎｔ ｉｎｆｏｒｍａｔｉｏｎ ｏｎ ｔｈｅ ｄｅｔｅｒｍｉｎａｔｉｏｎ ｏｆ ｆａｔｉｇｕｅ ｓｔａｔｅ ａｎｄ
ｒｅｄｕｃｅ ｔｈｅ ｉｎｆｌｕｅｎｃｅ ｏｆ ｈｉｓｔｏｒｉｃａｌ ｄａｔａ ｌｏｓｉｎｇ ｆｅａｔｕｒｅ ｉｎｆｏｒｍａｔｉｏｎ ｏｎ ｐａｒａｍｅｔｅｒｓ． Ａｃｃｏｒｄｉｎｇ ｔｏ ｔｈｅ ｅｘｐｅｒｉｍｅｎｔ，ｔｈｉｓ
ｍｅｔｈｏｄ ｈａｓ ａｃｃｕｒａｃｙ ｏｆ ９２． １９ ％ ａｎｄ ｍｉｓｓｅｄ ｄｅｔｅｃｔｉｏｎ ｒａｔｅ ｏｆ １． ９ ％ ｉｎ ｍｏｒｅ ｇｅｎｅｒａｌ ｄｅｔｅｃｔｉｏｎ ｅｎｖｉｒｏｎｍｅｎｔ，ａｎｄ
Ｋｅｙｗｏｒｄｓ：ｆａｔｉｇｕｅ ｄｅｔｅｃｔｉｏｎ；ｆｅａｔｕｒｅ ｌｏｓｓ；ａｔｔｅｎｔｉｏｎ ｍｅｃｈａｎｉｓｍ；ｌｏｎｇ ｓｈｏｒｔ-ｔｅｒｍ ｍｅｍｏｒｙ（ＬＳＴＭ）

ｔｈｅ ｍｉｓｓｅｄ ｄｅｔｅｃｔｉｏｎ ｒａｔｅ ｉｓ ｏｎｌｙ ３． ０７ ％ ｉｎ ｔｈｅ ｅｎｖｉｒｏｎｍｅｎｔ ｗｈｅｒｅ ｓｏｍｅ ｆｅａｔｕｒｅｓ ａｒｅ ｌｏｓｔ．

０　 引　 言

疲劳驾驶是威胁道路安全、造成严重伤害、死亡和经济
损失的主要因素之一。由于疲劳状态下，驾驶员从清醒到
睡眠的无意识过渡会产生缺乏警觉，从而使得驾驶性能下
降，将会导致严重的交通事故。目前，基于视觉的疲劳检测
算法［１］从单帧视频中提取驾驶员的面部特征，包括眼部行
为［２，３］和打呵欠频率［４］，并通过计算时间帧在滑动窗口内
的疲劳时间帧比值来判断驾驶员是否疲劳，或是通过对多

用户特征的综合分析判断疲劳状态［５］，提高单帧的检测精
度。此类算法无法获取准确的时序特征，或是在不同时间
段丢失了不同特征的时间信息，虽然在特定的采集环境中
有不错的准确率，但泛用性较差，抗干扰能力弱，应用性
不高。

针对以上问题，本文提出了一种基于注意力机制和长
短期记忆（ｌｏｎｇ ｓｈｏｒｔ-ｔｅｒｍ ｍｅｍｏｒｙ，ＬＳＴＭ）神经网络的疲劳
驾驶多注意力（ｍｕｌｔｉ-ａｔｔｅｎｔｉｏｎ）检测模型。通过对尺度不变

收稿日期：２０２２—０５—２３
*基金项目：民航重点项目（Ｕ２０３３２１８）

　
　
　
　
　
　
　
６１１

传感器与微系统

第４３ 卷

特征变换（ｓｃａｌｅ ｉｎｖａｒｉａｎｔ ｆｅａｔｕｒｅ ｔｒａｎｓｆｏｒｍ，ＳＩＦＴ）算法获取的
定位点计算多维特征向量，使用ＬＳＴＭ 网络学习特征向量
的时间序列进行建模学习，同时引入注意力机制赋予各维
度隐含状态不同的概率权重，加强重要信息对疲劳状态判
定的影响。此模型旨在利用不同结构更有效的分析处理驾
驶员面部数据，以更准确地判断驾驶员的疲劳状态变化。
实验证明，与其他方法对比，本文所提方法具有更高检测精
度和更低的漏检率。
１　 模型原理
１． １　 ＬＳＴＭ 神经网络

ＬＳＴＭ 网络［６］的主体是一个自我不断循环的神经元结
构，随着输入数据的不断增加，这个自循环神经元能将上一
次的状态和下一次的输入一起作为新的输入数据进行当次
的学习训练。通过自循环结构神经元，ＬＳＴＭ 网络能实现对
时间序列的数据的记忆学习。其网络单元是由存储单元及
它们包含的栅极单元组成的特殊结构，主要由遗忘门，输入
门和输出门组成。长期状态ｃｔ －１从左向右在网络中传播，
依次经过遗忘门时丢弃一些记忆，并通过加法操作从输入
门中计算获取并更新一部分记忆。相关函数如下
ｆｔ ＝ σ（Ｗ［ｘｔ，ｈｔ －１］＋ ｂｆ）， ｃｔ ＝ ｆｔ × ｃｔ －１，
ｇｔ ＝ σ（Ｗ［ｘｔ，ｈｔ －１］＋ ｂｉ），
ｉｔ ＝ ｔａｎｈ（Ｗ［ｘｔ，ｈｔ －１］＋ ｂｃ），
ｃｔ ＝  ｃｔ ＋ ｉｔ × ｇｔ，
ｏｔ ＝ σ（Ｗ［ｘｔ，ｈｔ －１］＋ ｂｏ），
ｈｔ ＝ ｔａｎｈ（ｃｔ）× ｏｔ
其中，ｘｔ 为输入数据序列，ｈｔ －１为前一个神经单元的输

出数据，ｃｔ －１为前一个神经单元的存储单元内容，ｂｆ，ｂｉ，ｂｃ，ｂｏ
为偏置向量。Ｗ 表示每个输入为独立的向量，σ 为ｌｏｇｉｓｔｉｃ
Ｓｉｇｍｏｄ 函数。通过对激活函数的输出ｆｔ 和ｃｔ －１进行元素乘
积运算，确定前一个存储单元的各部分内容对ＬＳＴＭ 的有
效程度，若存在过低的值，则该值对应的信息将被舍弃，并
更新输出。ｇｔ 通过Ｓｉｇｍｏｉｄ 函数计算获取待更新的参数向
量，ｉｔ 通过ｔａｎｈ 函数创建候选向量，并与遗忘门的输出相
加，决定该神经单元更新后的长期记忆，最终结果更新保存
至神经单元的存储单元ｃｔ。ｏｔ 决定哪些特征参数将被添加
至短期记忆中。ｈｔ 为输出门参数决定该神经单元输出的短
时记忆值。
１． ２　 注意力机制

（１）

注意力机制［７］是一种模拟了人脑注意力的资源分配机
制，其核心思想是巧妙合理的改变对信息的注意力，忽略无
关信息并放大所需信息，其结构如图１ 所示。注意力机制
通过概率分配的方式，对关键信息分配足够的关注，突出重
要信息的影响，从而提高模型的准确率。

yt-1

St-1

…

yt

St

…

 
h1

 
h2

 
h3

…

 
ht

x1

x2

x3

xt

图１　 注意力机制结构

２　 基于ＬＳＴＭ 网络的疲劳驾驶检测方法
２． １　 提取各区域的特征矢量

本文首先对视频帧获取ＳＩＦＴ 特征点作为不同特征的
定位点，并整合出１２ 个嘴部定位点点集，１２ 个嘴部定位点
点集和６ 个嘴部定位点点集，并计算各自的特征矢量。

１）计算嘴部特征矢量。嘴部特征包含嘴型区域的
１２ 个定位点Ｐ１ ～Ｐ１２（如图２（ａ）），使用嘴型纵向长度比横
向长度的比值建立嘴型的时序曲，其公式如下

ｒＥＡＲ ＝（‖Ｐ３ － Ｐ１１ ‖ ＋ ‖Ｐ４ － Ｐ１０ ‖ ＋ ‖Ｐ５ － Ｐ９ ‖）／ ３，
（２）
Ｗ ＝ ‖Ｐ１ － Ｐ７ ‖，ｆ ＝ Ｈ ／ Ｗ
式中　 Ｈ 为嘴的高度，以上下唇的中心６ 点在纵轴方向
上的欧氏距离和的平均值表示；Ｗ 为嘴的宽度，以嘴角
Ｐ１ 和Ｐ７ 在横轴方向上的距离表示；ｆ 为１ 个视频帧中嘴
的宽度和高度的比率，ｆ 的值越大嘴的张开程度越大，反
之越小。

P2

P1

P12

P3

P4

P5

P11

P10

P9

P6

P8

P7

P1

P2

P3

P6 P5

P4

P1

P2

P3

P6 P5

P4

(a) 嘴部定位点

(b) 眼部定位点

图２　 嘴部和眼部定位点图
　 ２）计算眼部特征矢量。眼部特征由每个眼睛的６ 个定
位点决定其特征（如图２（ｂ）所示），并由纵横比来确定眼睛
的状态，即定义人眼的张合度为ｒＥＡＲ，通过单只眼的６ 个特
征点的距离运算获得ｒＥＡＲ的值，其公式如下

ｒＥＡＲ ＝（‖Ｐ２ － Ｐ６ ‖ ＋ ‖Ｐ３ － Ｐ５ ‖）／ ２‖Ｐ１ － Ｐ４ ‖ （３）
通过计算Ｐ２ 与Ｐ６，Ｐ３ 与Ｐ５ 的差值，获取眼睛在纵轴
方向上的欧氏距离和，将Ｐ１ 与Ｐ４ 的差值作为眼睛在横轴
方向上的距离，其比值ｒＥＡＲ为眼睛特征点的纵横比。该
值越大表明眼睛越张开；反之，则表明眼睛越接近闭合
状态。

３）计算头部特征矢量。选用梁、鼻尖、右眼右眼角、右
眼左眼角、左眼左眼角、左眼右眼角６ 个点坐标。通常头部
姿态由αｙａｗ，αｐｉｔｃｈ和αｒｏｌｌ角度来定义。其中，αｙａｗ为水平偏移
角度，αｐｉｔｃｈ为竖直偏移角度，αｒｏｌｌ为平面偏移角度，根据这
３ 个参数可得出人脸所在位置的空间角，继而可以对头部
姿态进行较好的估计。因此，本文以眼部直线的近似向量
Ｌ １，鼻梁的近似向量Ｌ ２，相机的水平向量Ｌ ３和相机的垂直向

　
第４ 期

徐敬一，等：基于注意力机制改进的疲劳驾驶检测方法

７１１

（５）

量Ｌ 

４作为计算３ 个角度的基准向量
Ｌ １ ＝（Ｐ１ ＋ Ｐ２ ＋ Ｐ３ ＋ Ｐ４）／ ４ － Ｐ１，Ｌ ２ ＝ Ｐ５ － Ｐ６，
Ｌ ３ ＝（１，０），Ｌ ４ ＝（０，１）
（４）
基于以上４ 个基准向量，设定αｙａｗ为眼部向量与相机
水平向量的夹角，αｐｉｔｃｈ为鼻梁向量与相机垂直向量的夹角，
αｒｏｌｌ为眼部向量与鼻梁向量的夹角，其计算公式如下
，

Ｌ ２·Ｌ ４
‖Ｌ ２ ‖ × ‖Ｌ ４ ‖

，αｐｉｔｃｈ ＝

αｙａｗ ＝

Ｌ １·Ｌ ３
‖Ｌ １ ‖ × ‖Ｌ ３ ‖
Ｌ １·Ｌ ２
‖Ｌ １ ‖ × ‖Ｌ ２ ‖
２． ２　 计算疲劳概率结果

αｒｏｌｌ ＝

将计算的特征矢量输入至基于注意力机制设计的
ＬＳＴＭ 网络中进行二次分类。第一次分类基于ｅｎｃｏｄｅｒ 模
块，通过将输入序列（特征时间序列）输入ＬＳＴＭ 网络中，获
取当前时间步对特征状态的状态概率向量ｈｔ，并将该向量
压缩成指定长度的向量ｃ，公式如下

ｙｔ ＝ ＳｏｆｔＭａｘ（ｈｔ），ｃ ＝ ｑ（ｙ１，ｙ２，…，ｙｔ）
（６）
第二次分类基于ｄｅｃｏｄｅｒ 分类模块，将接收到的每一个
隐含特征计算一个注意力权重，即将计算得到的概率值与
隐含特征相乘，其公式如下

Ｔ

ｔ ＝ １

αｉｔ ｈｔ

（７）
ｃｉ ＝ ∑
将注意力权重与语义向量此时间步上的向量值相乘加
权后的得到输入向量，作为此模块中当前时间步的输入，其
公式如下

（８）
Ｘｔ ＝ Ｃｔ × ｃｉ
最后将同时间帧不同特征的判断值和其准确率组成该
时间帧的特征向量Ｘｔ 输入至一个具有独立参数和层数的
ＬＳＴＭ 中，学习并获得输出序列Ｈｔ。通过激活函数ＳｏｆｔＭａｘ
对Ｈｔ 进行归一化处理，获得当前时间步特征状态的概率向
量，计算获得最终的疲劳状态。
３　 实验结果与分析
３． １　 实验内容与评估方式

实验选用ＮＴＨＵ Ｄｒｏｗｙ Ｄｒｉｖｅｒ Ｄｅｔｅｃｔｉｏｎ（ＤＤＤ）数据
集［８］，该数据集由１８ ～４０ 岁之间，具有不同面部特征的男
女性成员，在不同场景下完成模拟驾驶的视频构成。本文
从中筛选分割出包含嘴部，眼部，头部不同状态的６００ 组视
频源，每组视频源包含５００ 帧的驾驶视频作为本实验的训
练和测试数据集和１０ 组每组包含５００ 帧视频帧的驾驶视
频作为验证数据集。根据五折交叉验证的思路，将６００ 组
视频源随机分成５ 等分，最终训练集、测试集、验证集的数
据比例为４８:１２:１。本文采用查准率Ｐ 和查全率Ｒ 作为评
估模型的性能的指标，同时选用漏检率作为模型检测能力
的额外指标，即

Ｐ ＝ ＴＰ ／ （ＦＰ ＋ ＴＰ），Ｒ ＝ ＴＰ ／ （ＴＰ ＋ ＦＮ），
（９）
漏检率＝ ＦＮ ／ 疲劳总数
其中，ＴＰ 为判定正确且实际正确的数据数量，ＦＰ 为判
定正确实际错误的数据数量，ＦＮ 为判定错误但实际正确的
数据数量。

同时，本文采用额外以上视频源外包含４ 种不同情况
合计１２０ 组６０ 帧的视频源（包含５０ 组丢失嘴部区域特征，
５０ 组丢失眼部区域特征，１０ 组丢失头部区域特征和４０ 组
丢失多个特征区间的视频片段）作为异常片段的对照数据
集，每种情况均含有疲劳和非疲劳的视频源，比例为３:１。
对照组采用计算判断正确帧数／ 总帧数的准确率作为不同
模型在特征丢失区间检测能力的判定标准。
３． ２　 模型学习结果

图３ 为网络训练过程中随迭代次数增加，其准确率和

损失值的变化。

%

/

率
确
准

100
95
90
85
80
75
70
65

训练

测试

率
失
损

0.7
0.6
0.5
0.4
0.3
0.2
0.1
0

损失

1

19

37

55

73

91

1

19

37

55

73

91

迭代次数

迭代次数

图３　 准确率和损失率曲线
　 由图３ 可以看出，随迭代次数的增加，损失值呈下降趋
势，且趋于平缓，网络收敛较快，准确率整体呈上升趋势，在
迭代５５ 次时进入平稳状态，最终完成训练时，其训练准确
率为９５． ２２ ％，测试准确率为９２． １９ ％。
３． ３　 模型对比分析

目前常用的３ 类模型进行性能分析，第一类为通过卷
积网络获取不同特征区域图块后直接识别的方法［９］；第
二类为获取关键点后通过ＰＥＲＣＬＯＳ 算法计算疲劳概率的
方法［１０］；第三类为使用仅使用ＬＳＴＭ 学习判断的方法［１］。

Ｍｕｌｔｉ-Ａｔｔｅｎｔｉｏｎ 与上述３ 类模型进行比较分析，实验结

果如表１ 所示。

表１　 不同网络模型结果对比

％　

丢失特征区间准确率

眼部 嘴部 头部 多个 查准率 查全率准确率漏检率

Ｍｕｌｔｉ-Ａｔｔｅｎｔｉｏｎ

ＣＮＮ［９］

９４

６５

ＰＥＲＣＬＯＳ［１０］ ８０

８９

７４

８１

９８

８３

９３

５

３２

３５

９３． ３２

９８． ７０

９２． １９

１． ３０

９０． ４８

９０． ８１

８２． ８９

９． １９

８３． １９

８６． ８６

７３． ８９

１３． １４

８５

５５

８７

９７

３． ６３

９１． ６８

８８． ６２

９６． ３７

ＬＳＴＭ［１］
　 实验表明，引入注意力机制后的模型保留了ＬＳＴＭ 网
络在时间上的学习能力，相比于其他模型能获取更多的时
间信息。同时相比于ＬＳＴＭ 模型在查准率，查全率和准确
率上均有提高。

表２ 为验证数据集和对照数据集所有数据判断结果分

　
　
８１１

传感器与微系统

第４３ 卷

类总和，其中对照数据集在“丢失多个特征区间”的数据在
所有模型上的判断准确率均较低，不存在参考性并剔除相
关结果。由表中数据可得，Ｍｕｌｔｉ-Ａｔｔｅｎｔｉｏｎ 模型未查出的疲
劳状态在所有错误中仅占１． ３ ％，相比于ＬＳＴＭ 的３． ６３ ％，
其漏检率降低了２． ３３ ％，丢失特征区间的疲劳漏检率降低
了７． ２１ ％，表明本文方法有更好的疲劳检出能力。

表２　 不同网络模型的错误分布

验证数据集

ＴＰ

ＦＰ

ＦＮ 漏检率／ ％

对照数据集

ＴＰ

ＦＰ

ＦＮ 漏检率／ ％

Ｍｕｌｔｉ-Ａｔｔｅｎｔｉｏｎ ２７６ ５７０

１９ ７８６

３ ６４４

１． ３０

６ ２２１

２２７

１５２

３． ０７

ＣＮＮ［９］

２４８ ６８８

２６ １５３

２５ １５９

９． １９

４ ８１７

９０１

８８２

１７． ８１

ＰＥＲＣＬＯＳ［１０］ ２２１ ６８９
ＬＳＴＭ［１］ ２６５ ８６１

４４ ７９３

３３ ５１８

１３． １４

５ ４０６

５７６

６１８

１２． ４８

２４ １３４

１０ ００５

３． ６３

５ ７２０

３７１

５０９

１０． ２８

４　 结　 论

本文提出了一种基于注意力机制和ＬＳＴＭ 神经网络的
疲劳驾驶检测模型。通过引入注意力机制赋予各维度隐含
状态不同的概率权重，增加对有效特征的概率倾斜，加强重
要信息对疲劳状态判定的影响，能降低驾驶过程中的疲劳
漏检率，对提高驾驶安全有较高的现实意义，未来可以通过
捕获更多的特征区间，进一步提高模型对疲劳状态检测的
适用性和判断能力。
参考文献：
［１］　 ＤＥＮＧＷ Ｈ，ＷＵ Ｒ Ｘ． Ｒｅａｌ-ｔｉｍｅ ｄｒｉｖｅｒ-ｄｒｏｗｓｉｎｅｓｓ ｄｅｔｅｃｔｉｏｎ
ｆｅａｔｕｒｅｓ ［Ｊ］． ＩＥＥＥ Ａｃｃｅｓｓ，２０１９ （９９ ）：

ｓｙｓｔｅｍ ｕｓｉｎｇ ｆａｃｉａｌ

情识别［Ｊ］． 传感器与微系统，２０２２，４１（２）：１４０ －１４３．
［４］　 ＳＡＲＡＤＡＤＥＶＩ Ｍ，ＢＡＪＡＪ Ｐ． Ｄｒｉｖｅｒ ｆａｔｉｇｕｅ ｄｅｔｅｃｔｉｏｎ ｕｓｉｎｇ ｍｏｕｔｈ
ａｎｄ ｙａｗｎｉｎｇ ａｎａｌｙｓｉｓ ［Ｊ］． Ｉｎｔｅｒｎａｔｉｏｎａｌ Ｊｏｕｒｎａｌ ｏｆ Ｃｏｍｐｕｔｅｒ
Ｓｃｉｅｎｃｅ ａｎｄ Ｎｅｔｗｏｒｋ Ｓｅｃｕｒｉｔｙ，２００８，８（６）：１８３ －１８８．
［５］　 ＬＡＮ Ｘ Ｙ，ＹＥ Ｍ，ＺＨＡＮＧ Ｓ Ｐ，ｅｔ ａｌ． Ｍｏｄａｌｉｔｙ-ｃｏｒｒｅｌａｔｉｏｎ-ａｗａｒｅ
ｓｐａｒｓｅ ｒｅｐｒｅｓｅｎｔａｔｉｏｎ ｆｏｒ ＲＧＢ-ｉｎｆｒａｒｅｄ ｏｂｊｅｃｔ ｔｒａｃｋｉｎｇ［Ｊ］． Ｐａｔｔｅｒｎ
Ｒｅｃｏｇｎｉｔｉｏｎ Ｌｅｔｔｅｒｓ，２０２０，１３０：１２ －２０．

［６］　 ＹＩＬＤＩＲＩＭ Ｏ． Ａ ｎｏｖｅｌ ｗａｖｅｌｅｔ ｓｅｑｕｅｎｃｅｓ ｂａｓｅｄ ｏｎ ｄｅｅｐ ｂｉｄｉｒｅｃ-
ｔｉｏｎａｌ ＬＳＴＭ ｎｅｔｗｏｒｋ ｍｏｄｅｌ ｆｏｒ ＥＣＧ ｓｉｇｎａｌ ｃｌａｓｓｉｆｉｃａｔｉｏｎ ［Ｊ］．
Ｃｏｍｐｕｔｅｒｓ ｉｎ Ｂｉｏｌｏｇｙ ＆ Ｍｅｄｉｃｉｎｅ，２０１８，９６（５）：１８９ －２０２．
［７］　 赵兵，王增平，纪维佳，等． 基于注意力机制的ＣＮＮ-ＧＲＵ 短期
电力负荷预测方法［Ｊ］． 电网技术，２０１９，４３ （１２）：４３７０ －

４３７６．

［８］　 ＳＨＩＨ Ｔ Ｈ，ＨＳＵ Ｃ Ｔ． ＭＳＴＮ：Ｍｕｌｔｉｓｔａｇｅ ｓｐａｔｉａｌ-ｔｅｍｐｏｒａｌ ｎｅｔｗｏｒｋ
ｆｏｒ ｄｒｉｖｅｒ ｄｒｏｗｓｉｎｅｓｓ ｄｅｔｅｃｔｉｏｎ ［Ｃ ］∥ Ａｓｉａｎ Ｃｏｎｆｅｒｅｎｃｅ ｏｎ
Ｃｏｍｐｕｔｅｒ Ｖｉｓｉｏｎ，２０１６：１４６ －１５３．

［９］　 刘明周，蒋倩男，扈静． 基于面部几何特征及手部运动特征的
驾驶员疲劳检测［Ｊ］． 机械工程学报，２０１９，５５（２）：１８ －２６．
［１０］耿磊，袁菲，肖志涛，等． 基于面部行为分析的驾驶员疲劳检

测方法［Ｊ］． 计算机工程，２０１８，４４（１）：２７４ －２７９．

作者简介：

机视觉。

徐敬一（１９９６ －），男，硕士研究生，研究方向为疲劳检测，计算

田　 瑾（１９８２ －），女，通讯作者，博士，副教授，研究领域为计

算电磁学，异构并行计算。

１１８７２７ －１１８７３８．

析，模式识别。

刘　 翔（１９７２ －），男，博士，副教授，研究领域为医学图像分

［２］　 王从澳，黄润才，孙延标，等． 基于特征融合与选择的小样本
表情识别［Ｊ］． 传感器与微系统，２０２２，４１（１０）：１１２ －１１６．
［３］　 冯桑，方涂杰，严楷淳，等． 面向智能驾培系统的深度学习表
■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
（上接第１１４ 页）
［２］　 ＵＳＵＮＧ Ｐ，ＲＨＩＭ Ｊ，ＪＵＥＯＮ Ｊ Ｕ，ｅｔ ａｌ． Ａ ｍｉｃｒｏｍａｃｈｉｎｅｄ ｄｉｆｆｅｒｅｎ-
ｔｉａｌ ｒｅｓｏｎａｎｔ ａｃｃｅｌｅｒｏｍｅｔｅｒ ｂａｓｅｄ ｏｎ ｒｏｂｕｓｔ ｓｔｒｕｃｔｕｒａｌ ｄｅｓｉｇｎ［Ｊ］．
Ｍｉｃｒｏｅｌｅｃｔｒｏｎｉｃ Ｅｎｇｉｎｅｅｒｉｎｇ，２０１４，１２９（５）：５ －１１．

ｎａｔｉｏｎ［Ｊ］． ＩＥＥＥ Ｓｅｎｓｏｒｓ Ｊｏｕｒｎａｌ，２０２２，２２（７）：６４５４ －６４６５．
［７］　 范书聪，张基强，黄丽斌，等． 硅微谐振加速度计电路宽带测
试方法研究［Ｊ］． 传感器与微系统，２０２０，３９（８）：２０ －２２．
［８］　 ＤＩＮＧ Ｈ，ＷＵ Ｃ Ｊ，ＸＩＥ Ｊ． Ａ ＭＥＭＳ ｒｅｓｏｎａｎｔ ａｃｃｅｌｅｒｏｍｅｔｅｒ ｗｉｔｈ

龚　 利（１９８１ －），男，博士，副教授，研究领域为能源政策
。

ＭＥＭＳ ｒｅｓｏｎａｎｔ ａｃｃｅｌｅｒｏｍｅｔｅｒ ｂａｓｅｄ ｏｎ ｄｉｓｐｌａｃｅｍｅｎｔ ｃｏｏｒｄｉ-

［３］　 ＬＥＦＯＲＴ Ｏ，ＴＨＯＭＡＳ Ｉ，ＪＡＵＤ Ｓ． Ｔｏ ｔｈｅ ｐｒｏｄｕｃｔｉｏｎ ｏｆ ａ ｒｏｂｕｓｔ
ａｎｄ ｈｉｇｈｌｙ ａｃｃｕｒａｔｅ ＭＥＭＳ ｖｉｂｒａｔｉｎｇ ａｃｃｅｌｅｒｏｍｅｔｅｒ［Ｃ］∥ ２０１７
ＤＧＯＮ Ｉｎｅｒｔｉａｌ Ｓｅｎｓｏｒｓ ａｎｄ Ｓｙｓｔｅｍｓ，Ｋａｒｌｓｒｕｈｅ，Ｇｅｒｍａｎｙ，Ｉｎｓｔｉｔｕｔｅ
ｏｆ Ｅｌｅｃｔｒｉｃａｌ ａｎｄ Ｅｌｅｃｔｒｏｎｉｃｓ Ｅｎｇｉｎｅｅｒｓ，２０１７：１ －１９．
［４］　 ＪＯＨＮＳＯＮ Ｂ，ＡＬＢＲＥＣＨＴ Ｃ，ＢＲＡＭＡＮ Ｔ，ｅｔ ａｌ． Ｄｅｖｅｌｏｐｍｅｎｔ ｏｆ
ａ ｎａｖｉｇａｔｉｏｎ-ｇｒａｄｅ ＭＥＭＳ ＩＭＵ［Ｃ］∥ ２０２１ ＩＥＥＥ Ｉｎｔｅｒｎａｔｉｏｎａｌ
Ｓｙｍｐｏｓｉｕｍ ｏｎ Ｉｎｅｒｔｉａｌ Ｓｅｎｓｏｒｓ ＆ Ｓｙｓｔｅｍｓ，Ｋａｉｌｕａ Ｋｏｎａ，ＨＩ，
ＵＳＡ，ＩＥＥＥ，２０２１：１ －４．

［５］　 ＦＡＮＧ Ｚ Ｘ，ＹＩＮ Ｙ Ｇ，ＣＨＥＮ Ｃ，ｅｔ ａｌ． Ａ ｓｅｎｓｉｔｉｖｅ ｍｉｃｒｏｍａｃｈｉｎｅｄ
ｒｅｓｏｎａｎｔ ａｃｃｅｌｅｒｏｍｅｔｅｒ ｆｏｒ ｍｏｖｉｎｇ-ｂａｓｅ ｇｒａｖｉｍｅｔｒｙ［Ｊ］． Ｓｅｎｓｏｒｓ
ａｎｄ Ａｃｔｕａｔｏｒｓ Ａ，２０２１，３２５：１１２６９４．

［６］　 ＨＵＡＮＧ Ｊ，ＺＨＡＯ Ｙ，ＸＩＡ Ｇ Ｍ，ｅｔ ａｌ． Ｓｙｓｔｅｍａｔｉｃ ｍｏｄｅｌｉｎｇ ｏｆ ａ

ｈｉｇｈ ｒｅｌａｔｉｖｅ ｓｅｎｓｉｔｉｖｉｔｙ ｂａｓｅｄ ｏｎ ｓｅｎｓｉｎｇ ｓｃｈｅｍｅ ｏｆ ｅｌｅｃｔｒｏ-

ｓｔａｔｉｃａｌｌｙ ｉｎｄｕｃｅｄ ｓｔｉｆｆｎｅｓｓ ｐｅｒｔｕｒｂａｔｉｏｎ［Ｊ］． Ｊｏｕｒｎａｌ ｏｆ Ｍｉｃｒｏｅｌｅｃ-
ｔｒｏｍｅｃｈａｎｉｃａｌ Ｓｙｓｔｅｍｓ，２０２１，３０（１）：３２ －４１．

［９］　 ＷＡＮＧ Ｃ，ＨＵ Ｑ Ｆ，ＷＡＮＧ Ｙ，ｅｔ ａｌ． Ｓｔｒｕｃｔｕｒｅ ｄｅｓｉｇｎ ａｎｄ ｓｉｍｕｌａｔｅｄ
ｏｐｔｉｍｉｚａｔｉｏｎ ｏｆ ｓｉｌｉｃｏｎ ｒｅｓｏｎａｎｔ ａｃｃｅｌｅｒｏｍｅｔｅｒ［Ｊ］． Ｎａｖｉｇａｔｉｏｎ ａｎｄ
Ｃｏｎｔｒｏｌ，２０１６，１５（１）：４１ －４６．

［１０］ ＺＨＡＮＧ Ｊ，ＳＵ Ｙ，ＳＨＩ Ｑ，ｅｔ ａｌ． Ｍｉｃｒｏｅｌｅｃｔｒｏｍｅｃｈａｎｉｃａｌ ｒｅｓｏｎａｎｔ
ａｃｃｅｌｅｒｏｍｅｔｅｒ ｄｅｓｉｇｎｅｄ ｗｉｔｈ ａ ｈｉｇｈ ｓｅｎｓｉｔｉｖｉｔｙ［Ｊ］． Ｓｅｎｓｏｒｓ，２０１５，
１５（１２）：３０２９３ －３０３１０．

高乃坤（１９９１ －），男，博士，高级工程师，研究领域为ＭＥＭＳ 惯

作者简介：

性器件技术。

　
