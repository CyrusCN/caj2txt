基于Dlib的疲劳驾驶远程监测系统设计

于星橦
（东北大学计算机科学与工程学院，辽宁110169）

摘要：阐述设计疲劳驾驶远程监测系统，利用Dlib人脸检测模型，通过计算EAR与MAR参数值来判断驾
驶员是否闭眼或打哈欠，并通过HPE算法判断驾驶员头部姿态。若发现疲劳驾驶，系统会进行警告提
示，并通过云端发送到监测平台进行人为干预，实现“双重保险”。经实验测试，此系统可以准确判定
货车驾驶员的疲劳状态，降低事故风险。
关键词：智能控制技术，Dlib，EAR，MAR，HPE，疲劳驾驶。

中图分类号：TP391.41     文章编号：1674-2583(2024)02-0412-04 
DOI：10.19339/j.issn.1674-2583.2024.02.183
文献引用格式：于星橦.基于Dlib的疲劳驾驶远程监测系统设计[J].集成电路应用, 2024, 41(02): 412-415.

Design of a Fatigue Driving Remote Monitoring 
System Based on Dlib
YU Xingtong 
( School of Computer Science and Engineering, Northeastern University, Liaoning 110169, China. )
Abstract  —  This  paper  describes  the  design  of  a  remote  monitoring  system  for  fatigue  driving, 
using the Dlib face detection model to determine whether the driver is closing their eyes or yawning by 
calculating the EAR and MAR parameter values, and using the HPE algorithm to determine the driver's 
head posture. If fatigue driving is detected, the system will issue a warning prompt and send it to the 
monitoring  platform  through  the  cloud  for  human  intervention,  achieving  "dual  insurance".  Through 
experimental testing, this system can accurately determine the fatigue status of truck drivers and reduce 
the risk of accidents.
Index Terms — intelligent control technology, Dlib, EAR, MAR, HPE, fatigue driving.

0  引言

疲劳驾驶，是指驾驶员在行车时间达到4h及以
上时，驾驶员身心发生的变化，在客观上表现为感
知机能下降、判断能力弱化、操作失误增加和反应
迟钝等现象。在重度疲劳时，往往会在短时间内出
现昏睡状态，进而无法正确驾驶车辆，从而导致交
通事故的发生。

1  研究背景

对高速路上货车驾驶员的疲劳状态进行实时检
测是实现交通安全的关键一环。目前，国内外的疲
劳驾驶检测技术主要是对驾驶员驾驶货车时异常的
生物电信号进行识别与判断；或利用GPS和惯导模块
对车辆状态，如：方向盘转动角度、车距、车辆轨
迹等进行监测。但目前仍缺少被广泛认可并普遍适
用的系统，这是因为多数系统监测指标单一、监测
成本高昂、判定驾驶员疲劳状态的准确度不高等。

然而，货车驾驶员在疲劳驾驶时的头部状态行
为也会发生异常。为此，本系统利用小型车载摄像
头实时采集货车驾驶员在驾驶状态下的面部特征，
利用Dlib人脸关键点检测模型获取驾驶员的眼部、
嘴部以及头部区域的特征信息。进而利用EAR算法判

断驾驶员眼部状态；利用MAR算法对驾驶员是否打
哈欠进行判断；并利用HPE算法，结合2D、3D转换
技术，判断驾驶员的点头行为。综合以上技术，当
系统判定驾驶员处于疲劳驾驶状态时，则会闪烁警
示灯并发出语音提示，并在驾驶员长时间无反应的
情况下震动座椅，进行物理警报，从视、听、感三
方面进行提示，有效降低了驾驶员发生疲劳驾驶的
几率。与此同时，本系统建立数据库，将实时车辆
GPS与驾驶员多种状态信息发送至云服务器，在后
台监测中心进行实时监测，一旦驾驶员长时间处于
疲劳驾驶状态，监测平台将发出提示，便于进行人
为干预，有效降低了事故风险。

2  系统总体方案
  2.1 系统框架

疲劳驾驶远程监测系统采用了飞腾FT-2000/4
开发板作为嵌入式开发平台。该核心板搭载多种外
设接口及硬件资源。经过多种环境下测试，结合系
统的实用性，最终选定在Linux操作系统下嵌入疲
劳检测程序，进而通过Dlib模型和OpenCV视觉库进
行算法处理。本系统主要由摄像头、GPS模块、飞
腾FT-2000/4开发板、LED警示灯、预警音响、4G模

作者简介：于星橦，东北大学计算机科学与工程学院；研究方向：智能控制技术。
收稿日期：2023-07-09；修回日期：2024-01-22。

412     集成电路应用  第 41 卷 第 2 期（总第 365 期）2024 年 2 月 

Applications创新应用块、云平台及可视化网页等几大部分组成，系统框
架如图1所示。在工作状态下，货车驾驶员的头部实
时状态通过摄像头以视频流的形式读入检测程序，
通过多种判断方法判断驾驶员是否存在疲劳状态。
如果存在，则通过LED警示灯和预警音响提醒驾驶
员；并在必要时上传预警信息和GPS定位至云服务
器，在Web端予以显示。

这一问题，作为内置的人脸检测算法，其使用HOG 
pyramid [3]，可以更精准快速的定位人脸模型。在
此基础上，利用脸部特征位置检测器dlib.shape_
predictor对关键点进行定位，检测一个区域内的
特征点，并输出这些特征点的坐标，如图3[4]所示。
通过该68点可以进行人脸状态估计等应用。

图 1  系统框架

  2.2 监测流程

本系统的监测流程主要有三部分组成，分别为
检测模块、报警模块和服务器模块。系统的监测流
程如图2所示。

图3  人脸关键68点

3  疲劳检测算法
  3.1 闭眼检测
    3.1.1 基于EAR算法的闭眼检测

EAR（Eye  Aspect  Ratio，EAR)为眼睛纵横
比，其作为眼部关键参数对判断是否疲劳驾驶有着
重要作用[5]。当使用Dlib的68个关键点模型获取并
标定人脸关键点坐标后，如图4所示，可以看到左眼
坐标为（43～48），右眼坐标为（37～42），分别
将左右眼的6个关键点转换为P 1至P 6，如图5所示，
则眼睛长宽比的计算公式如式（1）所示[6]。当眼睛
活动时，EAR会在一定范围内小幅度变化，且眼睛开
度与EAR值成正相关。经过多次实验表明，EAR值在
睁眼时会在0.3～0.4s内波动；而闭眼时则通常低于
0.2s。

  （1）

图2  监测流程

基于Dlib库的人脸关键68个点的提取
Dlib是一个开源数据工具库，在人脸面部特
征获取等方面具有独特作用，因此，Dlib正被广
泛应用于人脸识别技术领域[1]。在Dlib中，shape_
predictor_68_face_landmarks.dat是一个用于检
测人脸关键68个点的dat模型库，使用这个模型库可
以进行人脸检测和简单的应用[2]。

摄 像 头 获 取 到 的 图 像 是 一 张 大 画 布 ， 人 脸 在
上边显得很小，这时候按照传统的方法需要写一些
回归算法来定位到人脸，而Dlib的脸部位置检测器
dlib.get_frontal_face_detector可以有效解决

图4  关键点识别结果

图5  眼部坐标点
    3.1.2 疲劳判断标准PERCLOS

眼睑闭合与瞳孔闭合时间的百分比(Percentage 

of  Eyelid  Closure  over  the  PupiloverTime，

集成电路应用  第 41 卷 第 2 期（总第 365 期）2024 年 2 月    413

Applications创新应用PERCLOS)为单位时间内闭眼时间占总时间的比例。
通常分为三种评价标准：P70、P80和EM[7]，分别为
眼睑遮住瞳孔的面积超过70%就计为眼睛闭合、眼睑
遮住瞳孔的面积超过80%就计为眼睛闭合和眼睑遮住
瞳孔的面积超过50%就计为眼睛闭合。其中，常用的
为P80评价标准。如图6所示，通常以计算式（2）[8]
计算PERCLOS的参数值f1。

  3.2 基于MAR算法的打哈欠检测

嘴长宽比（Mouth  Aspect  Ratio，MAR）为嘴
部纵横比。与对眼睛的闭眼检测相类似，如图3所
示，嘴部的人脸检测点为49～68，从中取关键六
点：（51、59、53、57的纵坐标和49、55的横坐
标)作为嘴部纵横比的计算参数，则MAR的计算如式
（4）[9]所示。

（2）

（4） 

由于对嘴部的疲劳检测方法与对眼睛所用的方
法大致相同，所以不再赘述，直接给出疲劳判定标
准。如式（5）所示，通过计算单位时间内张嘴的帧
数m与总帧数M的比值k，来判定疲劳状态。其中阈值
选取0.1。

（5）

  3.3 基于HPE算法的点头检测

头部姿势估计（Head  Pose  Estimation，
HPE）的目标是在三维空间中估计人体关键点的位
置。得益于2D  HPE泛化能力的高精度，本系统以 
2D  HPE  作为中间步骤，根据2D姿态和原始图像特
征去估算3D姿态。而各种面部特征的3D姿态是建立
在世界坐标系中的，所以还需要将世界坐标系中的
3D姿态点转换到相机坐标系中，进而利用焦距、光
学中心等相机参数投影到图像坐标系。而后根据旋
转矩阵求解欧拉角[10]。经多次测试，可设定参数阈

图6  PERCLOSP80原理

然而，实验中发现时间t的定位难以确定，故
本系统采用帧率f2比值来替代f1。如式（3）所示，
n为一段时间内闭眼帧数，N为一段时间内总帧数，
两者的比值即为所求。选取阈值0.4作为疲劳驾驶判
定标准，大于此阈值则判定为疲劳状态，小于等于
此阈值则为清醒状态。

（3）

（a）                                                              （b） 

  （c）                                                                （d）
图7  测试截图

414     集成电路应用  第 41 卷 第 2 期（总第 365 期）2024 年 2 月 

Applications创新应用   
 
 
 
 
 
 
值为0.3，在一个时间段内，当低头欧拉角大于等
于22°或者头部倾斜欧拉角大于18°的时间比例超
过0.3时，则判定货车驾驶员处于点头疲劳状态。

在 本 算 法 中 ， 使 用 的 3 D 姿 态 点 有 ： 鼻 尖
（ 0 . 0 ， 0 . 0 ， 0 . 0 ） 、 下 巴 （ 0 . 0 ， - 3 3 0 . 0 ， -
65.0）、左眼左角（-225.0，170.0，-135.0）、
右眼右角(  225.0 ，1 70.0，-1 35. 0）、 嘴角 左
侧 （ - 1 5 0 . 0 ， - 1 5 0 . 0 ， - 1 2 5 . 0 ） 和 嘴 角 右 侧
（150.0，-150.0，-125.0）。

4  测试结果
  4.1 测试环境与截图

本 系 统 检 测 部 分 训 练 环 境 为 L i n u x U b u n t u 

1 8 . 0 4 操 作 系 统 ， 采 用 飞 腾 F T - 2 0 0 0 / 4 作 为 实 验
核 心 板 ， F T C 6 6 3 作 为 处 理 器 内 核 ， 主 频 为 2 . 2 、
2 . 6 G H z ； P y t h o n   3 . 7 ， P y t o r c h 1 . 1 3 . 0 g p u ，
D l i b 1 9 . 1 7 . 9 9 ， O p e n C V 4 . 6 . 0 ， J u p y t e r _
core4.11.2。采用华为云云端服务器，MySQL，可
视化网页端在Windows10环境下运行。如图7所示，
依次为闭眼检测、打哈欠检测、点头检测和网页
端截图。图中degree、EAR、MAR、分别为头部角
度、眼睛纵横比和嘴部纵横比，下方分别对应检测
到的疲劳次数。当出现异常时，屏幕上将实时显
示驾驶员所对应的疲劳状态，并在屏幕中心显示
“YouAreTired”。同时，网页端实时显示出货车
的GPS以及驾驶员的驾驶状态。

  4.2 疲劳驾驶检测结果

表1、表2、表3分别为对数据集中5条典型视频

表1  闭眼疲劳检测结果

表2  打哈欠疲劳检测结果

表3  点头疲劳检测结果

进行测试的结果，依次从闭眼检测、打哈欠检测和
点头检测三方面进行测试。

综合所有数据集，分析可知，本系统在正常高
速路驾驶环境下多种检测结果基本准确。然而，闭
眼疲劳检测中第2组数据处于隧道测试环境，光线极
暗，准确率明显降低。点头疲劳检测中第4组由于驾
驶员低头挂挡，造成误判，从而导致检测次数高于
实际点头疲劳次数。

5  结语

本文实现了一个基于Dlib的疲劳驾驶远程监
测系统，通过Dlib和OpenCV视觉库，采用EAR闭眼
检测、MAR打哈欠检测、HPE点头检测等算法，结合
PERCLOS等判断方法，对驾驶员的驾驶状态进行实
时判断，极大提高了高速路上货车驾驶员的安全保
障。试验结果表明，本系统拥有相比于其他检测系
统更高的敏感性，能够实时准确地识别驾驶员的疲
劳状态，并通过云端向后台人员发送预警，具有切
实可行性。本系统对隧道环境内光线依赖性较强，
疲劳检测响应敏感度明显降低，可能导致漏检或误
判。今后将在识别算法上进一步优化，以克服外部
环境对检测系统的影响，提高系统的准确率。

参考文献
[1]  刘兆丰.Dlib在人脸识别技术中的运用[J].电

子制作,2020(21):39-41+7. 

[2]  齐伟,张来刚,刘朝阳.基于人脸追踪和特征
分 析 的 疲 劳 驾 驶 预 警 系 统 设 计 [ J ] . 时 代 汽
车,2020,(15):169-170.

[3]  侍新兰,杜友福,王同喜.基于OpenCV的活体检
测[J].电脑知识与技术,2020,16(15):211-
213. 

[4]  林桂佳,蔡海文,朱贤泽等.基于人工智能的
车载瞌睡检测预警系统研究[J].现代信息科
技,2021,5(19):84-88. 

[5]  高龙琛,邢猛,丁月等.嵌入式疲劳驾驶远程监
测系统[J].电子器件,2022,45(01):229-234.
[6]  廖冬杰.基于Dlib和变种Transformer的哈欠检
测方法[J].汽车技术,2023(03):42-48. 
[7]  巩晓倩,蒲亦非,杨智勇等.基于有限状态自动
机的人眼开度PERCLOS实现算法[J].计算机应
用研究,2014,31(01):307-310.

[8]  蒋建国,王雷,齐美彬等.基于眼睛状态检测的
驾驶员疲劳驾驶分析[J].合肥工业大学学报
(自然科学版),2015,38(02):175-180.

[9]  朱亨,王添烽,陶剑文等.疲劳状态检测系统的
设计与实现[J].福建电脑,2022,38(10):83-
85.

[10]  王秀,周枫晓,刘保罗等.基于Dlib库的驾驶

员疲劳驾驶检测系统[J].物联网技术,2021, 
11(12):26-29.

集成电路应用  第 41 卷 第 2 期（总第 365 期）2024 年 2 月    415

Applications创新应用