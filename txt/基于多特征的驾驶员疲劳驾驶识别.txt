分 类 号： TP391

学校代码： 10109

密

级： 公 开

太原科技大学硕士学位论文
（专业型）

学位论文题目：基于多特征的驾驶员疲劳驾驶识别

英 文 题 目： Driver fatigue driving recognition based

on multi features

研 究 生 姓 名 ： 王冠男

导师姓名及职称： 陈立潮 教授

培 养 单 位 ： 计算机科学与技术学院

工 程 专 业 ： 软件工程

论 文 提 交 日 期 ： 2021 年 5 月 6 日

论 文 答 辩 日 期 ： 2021 年 6 月 10 日

答辩委员会主席： 郎鹏

中文摘要

中 文 摘 要

近年来，随着汽车保有量和驾驶员数量的增加，交通安全面临的形势变得越来越严

重。根据调查显示，大约有接近百分之二十的道路安全事故是由疲劳驾驶造成的，因此

对驾驶员进行疲劳状况的检测显得尤为重要。然而，目前所采用的疲劳检测算法准确率

低，疲劳特征考虑单一，研究高准确率的疲劳驾驶识别算法非常迫切。

本文研究和分析了当前流行的疲劳检测算法，针对目前存在的问题加以修正，提出

了一种将驾驶员多个疲劳特征融合的疲劳检测算法。具体研究如下：

1.提出了一种改进的人脸定位算法。针对传统的 AdaBoost 算法的弱分类器对困难样

本分类错误率较高的问题，采用局部敏感哈希方法的余弦相似性寻找待检测样本的近邻

点；再将待检测样本通过局部敏感哈希方式哈希到一起构建新的测试集；然后进行分类

测试，将分类的准确率作为动态权重系数，构建强分类器检测人脸信息；最后通过实验

进行模拟检测，发现本文检测算法在白天图像的检测率为 94%，误检率为 9.3%，而夜

间的图像的检测率为 87.3%，误检率为 11%。与传统的人脸定位算法那相比，本文所改

进的算法，检测性能大大提升，满足实际应用需要。

2.提出了基于多因子的疲劳特征检测和提取算法。利用改进的局部二值拟合算法进

行人脸眼部的检测，采用三庭五眼的方法检测嘴部区域。在宽高比的基础上，加入了眼

部像素比和嘴部圆形度进行眼部和嘴部的疲劳特征提取量化。实验结果表明，与传统提

取方法相比，多因子的疲劳特征提取的检测率大大提高。

3.提出了基于逻辑回归模型的检测算法。针对传统的检测算法疲劳特征考虑单一问

题，将眼部和嘴部在疲劳时的四种特征现象进行融合判定，并将其带到逻辑回归模型中

进行判断。实验结果验证了本文检测算的可行性。

4.搭建了实时的疲劳驾驶识别原型系统。依靠前面的疲劳检测模型使用模糊推理的

方法构建了综合疲劳驾驶识别系统。通过眼部和嘴部的疲劳多特征引入基于眼部和嘴部

疲劳的模糊规则，综合制定了疲劳检测模糊推理规则。实验结果表明，通过多段实验视

频序列的测试，疲劳状态的检测率超过了 95%。与传统的基于单一特征的疲劳检测算法

相比，检测率更加准确。

关键词：智能驾驶；疲劳检测；逻辑回归；视觉特征；模糊推理；

I

ABSTRACT

ABSTRACT

In recent years, with the increase of car ownership and the number of

drivers, the situation of traffic safety is becoming more and more serious.

According to the survey, about 20% of road safety accidents are caused by

fatigue driving, so it is particularly important to detect the fatigue status of

drivers. However, the current fatigue detection algorithm has low accuracy and

single fatigue feature, so it is urgent to study a high accuracy fatigue driving

recognition algorithm.

In this paper, the current popular fatigue detection algorithm is studied and

analyzed. Aiming at the existing problems, a fatigue detection algorithm based

on the fusion of multiple fatigue features is proposed. The specific research is as

follows

1. An improved face location algorithm is proposed. Aiming at the problem

that the traditional AdaBoost weak classifier has high classification error rate for

difficult samples, the cosine similarity of local sensitive hash method is used to

find the nearest neighbor of the sample to be detected; Then the samples to be

tested are hashed together by local sensitive hashing to construct a new test set;

Then, the classification test is carried out, and the classification accuracy is

taken as the dynamic weight coefficient to construct a strong classifier to detect

face information; Finally,

through the simulation test,

it

is found that

the

detection rate of this algorithm is 94% in the daytime image, and the false

detection rate is 9.3%, while the detection rate of the night image is 87.3%, and

the false detection rate is 11%. Compared with the traditional face location

algorithm,

the detection performance of the improved algorithm is greatly

improved to meet the needs of practical application.

2. A fatigue feature detection and extraction algorithm based on multi factor

is proposed. The improved local binary fitting algorithm is used to detect the

face and eyes, and the mouth region is detected by the method of three Court

and five eyes. On the basis of aspect ratio, eye pixel ratio and mouth roundness

are added to extract and quantify the fatigue features of eyes and mouth. The

experimental results show that compared with the traditional extraction method,

III

基于多特征的驾驶员疲劳驾驶识别

the detection rate of multi factor fatigue feature extraction is greatly improved.

3. A detection algorithm based on logistic regression model is proposed.

Aiming at the single problem of fatigue feature in traditional detection algorithm,

four feature phenomena of eyes and mouth in fatigue are fused and judged, and

they are brought to the logistic regression model for judgment. The experimental

results verify the feasibility of the proposed algorithm.

4. Build a real-time fatigue driving recognition prototype system. Based on

the previous fatigue detection model, the fuzzy reasoning method is used to

build a comprehensive fatigue driving recognition system. According to the

multi features of eye and mouth fatigue, the fuzzy rules based on eye and mouth

fatigue are introduced, and the fuzzy inference rules for fatigue detection are

formulated. The experimental results show that the detection rate of fatigue state

is more than 95% through the test of multiple experimental video sequences.

Compared with the traditional fatigue detection algorithm based on single

feature, the detection rate is more accurate.

Key words: Intelligent Driving; Fatigue Testing; Logistic Regression;

Visual Features; Fuzzy Reasoning

IV

目录

目录

第一章 绪论...............................................................................................................................I
1.1 研究背景及意义...........................................................................................................1
1.2 研究现状.......................................................................................................................1
1.3 本文研究内容...............................................................................................................5
1.4 论文章节安排...............................................................................................................5
第二章 相关技术.......................................................................................................................7
2.1 常用的人脸定位技术...................................................................................................7
2.2 常用的人眼定位方法...................................................................................................7
2.3 常用的机器学习模型及指标........................................................................................8
2.4 模糊推理.......................................................................................................................9
第三章 人脸定位.....................................................................................................................11
3.1 引言.............................................................................................................................11
3.2 驾驶员人脸图像预处理.............................................................................................11
3.2.1 肤色分割算法....................................................................................................11
3.2.2 光照补偿算法....................................................................................................12
3.3 AdaBoost 算法介绍.....................................................................................................13
3.4 基于改进的 AdaBoost 算法的驾驶员人脸定位........................................................13
3.5 实验结果分析.............................................................................................................14
3.5.1 视觉效果对比....................................................................................................14
3.5.2 检测指标对比....................................................................................................15
3.6 本章小结.....................................................................................................................16
第四章 面部特征提取及疲劳量化.........................................................................................17
4.1 引言.............................................................................................................................17
4.2 人眼定位.....................................................................................................................17
4.2.1 基于 LBF 算法的人眼定位............................................................................. 17
4.3 嘴部定位......................................................................................................................18
4.4 疲劳视觉特征分析......................................................................................................19
4.5 疲劳特征量化..............................................................................................................19
4.5.1 基于多因子的眨眼频率检测...........................................................................19
4.5.2 基于眼部疲劳的 PERCLOS 计算................................................................... 21
4.6 嘴部疲劳特征的提取量化..........................................................................................22
4.6.1 基于多因子的打哈欠检测频率.......................................................................22
4.6.2 打哈欠的总时长................................................................................................24
4.7 模拟实验及分析.........................................................................................................24
4.8 本章小结.....................................................................................................................25
第五章 基于逻辑回归的多特征疲劳检测算法.....................................................................27
5.1 引言.............................................................................................................................27
5.2 模型筛选.....................................................................................................................28
5.3 基于逻辑回归模型的疲劳检测.................................................................................29
5.3.1 核函数选择.......................................................................................................29
5.3.2 基于逻辑回归的疲劳检测模型.......................................................................30
5.4 眼部和嘴部疲劳判定.................................................................................................30

V

基于多特征的驾驶员疲劳驾驶识别

5.5 仿真结果分析..............................................................................................................31
5.5.1 实验环境与数据来源.......................................................................................31
5.5.2 实验结果分析...................................................................................................31
5.6 本章小结.....................................................................................................................32
第六章 基于模糊推理的疲劳识别原型系统.........................................................................33
6.1 基于眼部和嘴部的模糊规则制定..............................................................................33
6.1.1 基于眼部的疲劳规则.......................................................................................33
6.1.2 基于嘴部的疲劳规则.......................................................................................33
6.2 系统的软硬件平台......................................................................................................35
6.3 系统分析.....................................................................................................................35
6.4 系统设计.....................................................................................................................35
6.5 系统展示.....................................................................................................................36
6.5.1 系统界面...........................................................................................................36
6.5.2 数据预处理模块...............................................................................................37
6.5.3 人脸检测模块...................................................................................................38
6.5.4 疲劳检测模块...................................................................................................39
6.5.5 疲劳程度判定模块...........................................................................................39
6.6 实验仿真及结果评价...............................................................................................39
6.6.1 实验数据...........................................................................................................39
6.6.2 实验分析...........................................................................................................39
6.7 本章小结.....................................................................................................................40
第七章 总结与展望.................................................................................................................41
7.1 本文主要工作总结.....................................................................................................41
7.2 下一步工作展望.........................................................................................................42
参 考 文 献.............................................................................................................................43
致谢...........................................................................................................................................47
攻读学位期间的工作与成果...................................................................................................49

VI

第一章 绪论

第一章 绪论

1.1 研究背景及意义

交通事故是现今世界上每个国家都非常重视的社会危害，已经被全球各个国家一致

认为是目前全球范围内对人类生命安全造成最大伤害的隐患。每年有超过百万人在交通

事故中失去生命。世界卫生组织对道路交通事故的成因进行了分析后，统计结果的占比

情况如图 1.1 所示。图中表明，因疲劳驾驶造成的交通事故的发生率高达百分之十九。

根据欧洲和美国在交通事故中的伤亡人数统计表明[1],大约六到七成的交通事故是因为

人为因素造成的。依照美国国家安全局的数据显示，随着社会的发展和人均车辆数目的

增加，美国每年都会因为司机疲劳驾驶而造成大量的人员伤亡[2]。在欧洲因疲劳驾驶而

导致的交通事故也具有很高的死亡率。比如在德意志联邦共和国境内，超过四分之一的

交通事故是由疲劳驾驶造成的[3]。新世纪以来，我国交通产业高速发展的背后也隐藏着

巨大的危险。我国每年超过一半的交通事故是因为驾驶员疲劳操作引起的，经济损失高

达千万之巨，人民的生命财产受到了严重威胁[4]。

图 1.1 道路交通事故成因分析

Figure 1.1 Cause analysis of road traffic accidents

尽管疲劳驾驶这一现象会造成很严重的交通事故，但是，这一现象是可以控制的。

因此能准确判断驾驶员疲劳状态，及时地对产生疲劳现象的驾驶员示警，可以极大程度

的提升驾驶员在道路上行驶的安全系数。

1.2 研究现状

通过对疲劳驾驶进行研究可以减少很多危险事故的发生，减小因交通的发展对社会

1

基于多特征的驾驶员疲劳驾驶识别

产生的负面影响，同时也可以提高道路安全指数。因此，全球各地展开了疲劳检测的研

究热潮。目前一般使用主观或客观的方法对疲劳检测进行评估。主观方法主要是通过一

些问卷调查或者是走访调查的形式完成，例如斯坦福嗜睡量表等。但是主观检测方式主

观性质太高，在调查的过程中容易受到外界因素的干扰，从而导致结果的准确性受到影

响。与主观检测方法相比，客观检测方法的可信度更高，具有稳定性和通用性的优点。

因此，目前的疲劳检测大多采用客观的检测方法。大致可以分为以下几类：

（1）基于车辆状况的疲劳检测

如果驾驶员处于疲劳驾驶的状况，车辆行驶的部分参数将会发生变化，因此车辆的

行驶数据中很多参数可以用于疲劳驾驶的判定，包括方向盘转角、汽车对于车道线的偏

离情况等。Pia M. Forsman[5]等人，模拟了在 10 个工作日中，对受试者分别处于白天和

夜间的条件下，在一个标准化的农村公路场景模拟驾驶。实验表明，横向车道位置可变

性度量与疲劳的独立测量相关。重庆大学的Li Zuojin[6]等人，通过转向杆上的传感器收

集实际驾驶条件下的方向盘转角信息，对真实驾驶条件下的驾驶员进行疲劳状况的检测，

实验的准确率超过 75%，说明可以利用方向盘的转角信息进行疲劳判定。沙春发[7]等人

通过检测方向盘握力信号，从时空两个角度选择与疲劳有关指标，最后利用BP神经网络

构建疲劳检测模型。Sandberg[8]人设计实验使用神经网络，将表现最佳的嗜睡指标与嗜

睡的数学模型相结合，即睡眠/觉醒预测因子(SWP)，研究了汽车驾驶员的嗜睡检测问题。
Xu Yuhong[9]等人开发了一个纳米级别发电机的智能系统，实时检测驾驶员状态，通过对

旋转次数和平均转角等参数进行信号处理，确定警戒阈值，通过比较参数和阈值，评估

驾驶员状态。同济大学的郭思强、腾靖[10]等人通过对车辆多源数据的采集，然后选取其

中与疲劳相关的因素，最后从时空两个维度进行验证。清华大学的屈肖蕾[11]对驾驶员在

不同疲劳状态下的转向操作以及车辆的波动幅度、频度等变化进行分析，使用统计学方

法进行疲劳指标的显著差异性判别。并建立相关模型，将驾驶员的状态分为清醒、疲劳、

特别疲劳。同时考虑了不同驾驶员的操作差异建立基于个性指标的疲劳检测模型，结果

表明该模型的识别率为 87.7%，识别效果较为优异。基于车辆信息的疲劳检测方法不与

驾驶员的身体直接接触，但该方法会受到类似于天气状况以及驾驶员行车习惯等多种外

部条件的干扰，一般来说只能作为辅助参考，不具有全面性。

（2）基于生理状态进行检测

在行驶之前如果驾驶员长时间没有得到一段时间的休息，或者在行驶的过程中处于

精神疲惫的情况，驾驶员的疲劳指数会大幅度增加，如果驾驶员处于精疲力竭的情况下，

身体机能指标的相关参数与正常状态下行驶时的参数相比，会极度下降。因此对驾驶员

2

第一章 绪论

生理状态进行检测，可以得到驾驶员的疲劳信息。比如通过对肌电信号进行分析得到疲

劳信息。S.Edward Jero[12]等人利用人体表面的肌电信号判别疲劳状态，并提出了利用傅
里叶变换描述的形状变化和几何特征组成的框架。祝荣欣[13]从肌电信号对疲劳影响的角

度展开对当前疲劳驾驶现状的研究。叶成文[14]使用神经网络建立疲劳模型，并通过实验

验证了模型的可行性。

如果驾驶员在疲劳状态行驶，其精神较为涣散，注意力会有所下降，此时驾驶员的

脑电信号和清醒状态下相比也有很大差别[15]，因此脑电信号也可以成为疲劳判定的参考

因素。Schneider Lisa[16]通过实验证明人体的脑电纺锤体和疲劳有关。电子科技大学的成
怡波、肖超[17]等人开发了一种基于脑波音乐的疲劳检测系统，将获得的脑电数字信号根

据幅值定义音高，根据疲劳等级定义音长，最后加入音色获得脑波音乐，从而反馈检测

人员疲劳状况。邱达峰[18]将脑电信号和眼电信号通过神经网络融合，实验在公开数据集

上可达到 98.3%的准确率。上海交通大学的仇峰[19]使用深度滤波网络对脑电信号进行建
模学习，达到脑电疲劳检测的效果。Rao Songhui[20]等人利用集成学习的思想建立分类模

型，以疲劳驾驶实验数据为对象，将疲劳驾驶对象分为正常状态和疲劳状态，利用Pearson

相关系数法构建了一个功能脑网络。张学军[21]等人针对提取脑电信号时参数调整困难的

情况，提出了一种基于模糊熵融合的脑电信号提取方法。 Tuncer Turker[22]等人使用脑电

信号检测驾驶疲劳的精度，在深度网络的低层，中层，高层中提取特征，提出了一种将

一维二值模式（BP）和统计特征结合起来使用的多级特征发生器。使用脑电信号进行疲
劳检测不会对人体造成损伤，但是使用低精度仪器提取的脑电信号含噪音多。Ren Ziwu[23]

等人使用RBF神经网络优化网络参数，提高信号泛化能力，并且开发了一种两级学习层

次的RBF网络用于疲劳驾驶监测，实验证明该模型平均准确率为 92.71%，分类性能良好。
Liu Yisi[24]等人使用主体间的转移学习对脑电信号进行精神疲劳识别，并且还探讨了脑电

信号通道数对算法精度的影响，利用随机森林选择明显通道，实验表明该方法具有较高

的准确率。

除了脑电信号和肌肉组织的电信号之外，心电信号也可以作为疲劳的判定条件。驾

驶员在疲劳状态的条件下行驶 心率和心电特征和清醒状态下行驶相比会有较大差异。

武汉理工大学的李鑫，张晖[25]等人采集脉搏波数据，从中提取表征疲劳的有效指标，实

验结果表明疲劳检测率可达 91.8%。朱龙飞，王鹏程[26]使用数字信号处理器对两个端口
的信号进行合成编码，最后通过脑电信号的变化区分是否处于疲劳状态。Salvati Luca[27]

等人研究了一种通过心跳产生的脉率变异性分析相关疲劳指数，并与PERCLOS对比验
证了方法的有效性。Chen Long[28]等利用多普勒雷达和智能手镯获取驾驶员呼吸和心跳

3

基于多特征的驾驶员疲劳驾驶识别

信号，并且提出了使用极限学习机进行疲劳驾驶检测。但是通过驾驶员生理信号判断疲

劳情况具有侵入性，驾驶员需要佩戴较为精密且繁重的仪器，会对司机进行驾驶干扰而

且仪器价格昂贵无法普及。

（3）基于驾驶员面部特征进行检测

行驶员在疲劳状态下，除了生理特征会和精神充足的情况下有差异之外，他们的面

部特征也有所不同[29]。当驾驶员疲劳时，会存在眼睛睁开角度过低、眨眼的频率增加、

打哈欠次数增加等现象，重度疲劳时会出现长时间的眼睛闭合情况。因此驾驶员面部特

征信息可以极大程度地反映驾驶员的疲劳状况。近年来随着计算机视觉的发展，基于面

部特征的检测成为疲劳检测的主要方法。

陈瑜等[30]采集了 7 名受试者不同状态下的眼动数据，发现眨眼时间可以很好地反映
疲劳情况。旷文腾[31]等人，根据眼白在某种色彩空间中的聚类特性建立高斯眼白分割模

型，将眼白面积和PERCLOS结合作为疲劳检测指标，从而完成对驾驶员疲劳情况的判
别，实验准确率为 96.77%，验证了该方法的可行性。清华大学张波[32]等人，基于主动

形状模型进行人眼定位，引入平均合成精确滤波器(ASEF)对主动形状模型进行改进，并

且使用单双眼相结合的算法精确定位眼睛虹膜中心。实验证明该算法可以实现眼部的精

准检测。Li Xingxing[33]等人使用dlib检测人脸关键点，通过OpenCV对视频流信息进行处
理和检测，最后通过计算机图像处理技术对驾驶员疲劳状态进行检测。杜勇[34]针对疲劳

现象提出了一种疲劳检测方法。通过分析清醒状态和疲劳过程中的频率不同，找到可区

分两种状态下眨眼过程的特定信息，从而推测驾驶员疲劳状态。王震[35]等人修正唇厚度

误差，提取嘴内轮廓开合度，判断打哈欠频率从而实现疲劳检测。潘剑凯，柳政卿[36]

等使用残差网络获取人脸信息，分割眼部区域图像，构建梯度与自商共生矩阵模型进行

眼部疲劳检测。ZHAO[37]等人通过构建深度集成神经网络表示眼部区域信息，使用迁移
学习提取眼部特征构建驾驶员睡意识别数据集。潘志庚、刘志飞[38]等人通过构建深度集

成神经网络表示眼部区域信息，使用迁移学习提取眼部特征构建驾驶员睡意识别数据集。

Ngxande M[39]等使用生成对抗网络增加基于群体偏见的可视化策略的有针对性的数据，
提高了疲劳检测性能Ed-Doughmi[40]等使用生成对抗网络增加基于群体偏见的可视化策

略的有针对性的数据，提高了疲劳检测性能。并使用优化的目标检测算法进行人脸区域

的检测，减少光线变化对疲劳特征提取的影响，实验准确率高达 92%，更有效地反映驾

驶员疲劳情况。胡习之和西北民族大学的撒灵，于顺全[41-42]等以面部特征为核心构建了

疲劳检测系统。Shijun Wang[43]等分析了深度学习背景下的驾驶员疲劳状态识别，构建专
业的疲劳驾驶识别系统。程文冬，魏庆媛[45]在非约束条件下使用CanShift算法计算眼睛
4

位置，为疲劳检测打好基础。哈尔滨工程大学的闫保中，王晨宇等[46]通过人眼特征进行

第一章 绪论

疲劳驾驶的研究。

1.3 本文研究内容

综合上述的国内外研究现状，本文对比分析了已有的疲劳驾驶检测算法。其中，通

过对驾驶员面部的疲劳信息研究驾驶员疲劳状态的方法不需要对驾驶员进行直接上的

身体接触和精密仪器的配备，检测成本较低，而且检测率也很高。因此本文对基于驾驶

员面部特征的检测方法展开深入探讨研究。然而，已有的基于驾驶员面部特征的检测方

法对疲劳特征考虑过于单一，很容易造成检测器的检测性能可信度降低。鉴于传统的疲

劳检测模型通过驾驶员单一疲劳特征检测具有局限性的问题，本文提出了一种新的驾驶

员疲劳检测模型。首先对人脸区域进行预处理，解决复杂光源和背景的影响，再将

AdaBoost算法的弱分类器权重动态更新，进行人脸检测，然后用LBF算法进行人眼检测，

用三庭五眼法进行嘴部检测，通过人眼高宽比和像素比检测人眼闭合程度，通过嘴部高

宽比和圆形度检测嘴部打哈欠状态，再综合眼部疲劳特征计算闭眼时间，利用打哈欠频

率计算嘴部疲劳。最后综合上述疲劳特征检测驾驶员疲劳状态。并且使用模糊推理系统

进行驾驶员疲劳状态的详细判定。主要内容包括如下：

1. 人脸输入图像的预处理。当待检测图像存在背景复杂、人脸姿态有角度变化等问

题时，误检率就会大大提升，最终导致检测结果的性能大打折扣。本文描述了一种可行

的解决方案。

2. 研究基于AdaBoost的人脸检测，对数据预处理后缩小人脸检测范围，更新权重规

则，避免梯度爆炸，从而提高人脸检测的准确率以及缩短检测时间。

3. 面部特征提取，在不同的实际环境中，由于人们的必须性活动，人的头部往往会

出现不同程度的转动，从而导致人脸眼部和嘴部信息的提取出现失误，最终导致疲劳驾

驶的特征检测的准确度受到影响，本文详细介绍了一种可行的解决办法。

4. 驾驶员疲劳检测，由于在实际驾驶过程中，驾驶员会出现不同程度的身体变换，

从而导致使用面部单特征，例如眼部或者嘴部等单特征要素进行疲劳检测时会大大影响

检测的效果。本文详细介绍了一种解决办法。

5. 疲劳状态判定，本文开发了一个疲劳驾驶原型系统用以对驾驶过程中的疲劳现象

进行提醒。

1.4 论文章节安排

本文将主要内容分为七章，详情如下：

5

基于多特征的驾驶员疲劳驾驶识别

第一章 绪论。对本文的研究背景、研究意义进行详细介绍，并且详述了当前国内

外对于疲劳驾驶的研究状况，并对现状进行分析提出了存在的问题，最后对本文的研究

内容以及章节安排进行介绍。

第二章 相关技术。主要介绍了本文所涉及或者使用到的相关方法。首先介绍了常

用的人脸定位算法，其次对人眼定位的常用方法和常用的机器学习模型进行了阐述。关

于机器学习还介绍了其学习过程，最后对模糊融合进行了详细讲述。

第三章 人脸定位。针对驾驶员的疲劳多发生于背景复杂和弱光环境下，提出一种

改进的人脸检测算法。首先使用肤色分割算法，将待检测图像分割为皮肤区和非皮肤区。

然后，使用光照补偿算法解决复杂光源的影响，同时引入改进了权重更新规则的

AdaBoost算法构建分类性能强大的级联分类器实现对驾驶员人脸的有效监测。

第四章 面部特征提取及疲劳量化。基于上一章获取到的人脸信息，首先用改进后

的LBF算法进行人脸眼部的检测，用三庭五眼的方法进行人脸嘴部的检测。然后在检测

眼部疲劳特征的时候，在眼部宽高比的基础上加入了眼部像素比进行眼部疲劳特征的多

因子提取，在检测嘴部疲劳特征的时候，在嘴部宽高比的基础上加入了嘴部圆形度来进

行嘴部疲劳特征的提取。最后提出眼部和嘴部的四个疲劳特征，便于下一步的疲劳状态

判别。

第五章 基于逻辑回归的多特征疲劳检测算法。首先对不同的检测模型进行对比分

析，筛选最适合的模型。再并将眼部和嘴部的疲劳特征进行融合检测，得到疲劳状况，

最后通过仿真实验与单特征的检测算法进行了比较。

第六章 基于模糊推理的疲劳识别原型系统。首先依据前两章疲劳特征量化后的疲

劳阈值制定基于眼部和嘴部的模糊规则，综合眼部和嘴部的模糊规则，制定疲劳状态判

定的模糊规则，从而提出了三种疲劳状态。并搭建了实时的疲劳检测平台。并且可以根

据用户输入的疲劳片段，分析出用户的具体疲劳状态。最后通过模拟仿真实验与其他算

法进行比较。

第七章 总结与展望，对本文的内容进行了总结，并对实验结果进行了介绍，针对

本文不足提出下一步需要进行的改进之处。

6

第二章 相关技术

第二章 相关技术

2.1 常用的人脸定位技术

常用的疲劳检测系统采集到的图像，包括人脸区域和非人脸区域。本节检测人脸区

域，便于下一步基于人脸图像提取眼部和嘴部的疲劳信息从而完成疲劳驾驶的检测。通

过减少非人脸区域对疲劳信息的提取，完成最终的高精度疲劳检测。近年来，随着计算

机视觉的发展，人脸检测的方法不断创新，主要包括：

1.基于先验知识的方法

该方法通过人脸区域的信息进行检测[46]。一般情况下，人脸面部器官的分布都有一

定特点。例如双眼的对称性，人眼和鼻子的位置，眼睛和嘴巴的距离都具备一些特性。

使用先验知识对人脸进行检测，就是对这些特定信息进行分析，找出联系完成检测。

2.基于特征提取的方法

该方法通常是利用人脸整体轮廓的特殊性、人体肤色良好的聚类性和人脸器官的分

布区域来进行人脸区域的检测。

3.基于机器学习的方法

该方法利用统计学和大数据分析原理，将数字图像信息作为样本，对大量的样本数

据进行计算分析，获取样本间的普遍联系和规律，总结规律，并应用这些规律完成检测

任务[47]。常用的是支持向量机、决策树、AdaBoost[48]等。

2.2 常用的人眼定位方法

高精度的人眼检测，会便于对眼部疲劳特征的提取。因此精确获取人眼区域图像，

可以降低冗余信息对眼部疲劳判定的干扰。常见的人眼检测算法如下：

1.基于模板匹配的方法。对目标图像的特征提取，创建图像模板，分析输入图像与

模板的匹配度，进而从图像中确定目标所在的区域，实现定位，但在遍历图像过程中不

断计算匹配度，从而使得计算量加大。

2.基于先验知识的人眼定位。人的面部器官分布相对规律，眉部、眼部、鼻部、嘴

部从上到下依次分布。因此，可以将人脸图像的上半部分视作人眼所在区域进行分析。

3.基于统计学习的方法。将人眼图片、非人眼图片分别作为训练所需的正样本、负

样本，送入所设计的训练模型中，提取出最能分辨出两者的特征，在训练过程中根据输

出，不断优化模型，得到权重信息，对输入图像信息进行分析，从而得到最优的目标区

域。

4.基于局部二值特征(LBF)的方法[49]。人的眼部区域的外形有特有的特征，比如人的

7

虹膜、瞳孔区域是圆形的。可利用 LBF 相关方法，经过相关预处理即可完成对人眼的

基于多特征的驾驶员疲劳驾驶识别

定位。

2.3 常用的机器学习模型及指标

机器学习一般通过有无标签分为有监督学习和无监督学习。驾驶员的疲劳检测需要

人为参与所以隶属有监督学习的范畴。因此本文研究的是有监督学习，过程如下：

Step1.准备数据，提取特征信息多的数据。

Step2.对数据进行预处理，筛除重复的数据，消除数据量纲对模型训练的影响。

Step3.提取并选择特征。在原有的数据特征上进行组合产生新特征。

Step4.选择合适模型进行训练。设立评价标准，例如准确率、召回率等。不断训练

模型，优选效果最好的那个模型。

Step5.求解模型参数，得到所要使用的模型。

Step6.对模型进行封装接口，供外部程序调用。

由于疲劳检测属于有监督学习，典型的二分类问题。因此，选择了以下几种经典的

分类模型做分析。下面为常用的几种机器学习模型的概要介绍。

1.决策树模型

决策树是一种类似于二叉树的树形结构。它通过递归的方式进行特征选择。大型数

据库中经常使用决策树进行对庞大数据源的操作。但是使用决策树进行数据处理容易发

生过拟合。

2.随机森林模型

随机森林是一种分类器。首先创建决策树，在此基础上引入数据的随机性，然后对

数据进行分割，构建各自独立的样本数据，随机森林构建的学习模型能保持较为理想的

准确率。但是样本数据如果出现较大噪音会造成检测性能下降。

3.朴素贝叶斯模型

朴素贝叶斯分类是一种较为常见的分类方法，同时也可以用来预测建模。以贝叶斯

定理为基础，假定特征条件独立，对检测数据进行分类。但是现实情况中特征条件之间

会产生联系无法各自独立，这很大程度上影响了朴素贝叶斯模型的正确分类。

4.支持向量机模型

支持向量机(SVM)是一个典型的二分类模型。SVM 按照间隔最大的原则分割样本数

据。选出一个输入变量空间中的点按类进行最佳分割。但是 SVM 对数据的缺失很敏感，

无法直接解决非线性问题。

8

5.逻辑回归模型

第二章 相关技术

逻辑回归 LR（Logistic Regression）作为一种广义的线性回归模型，常用来进行数据

预测。逻辑回归将线性回归的因变量通过函数对应为一个隐状态，根据隐状态大小决定

因变量的值。逻辑回归的因变量可以用来解决二分类和多分类问题，并进行回归分析。

2.4 模糊推理

模糊推理是通过模糊集合论，对存在联系的一般数据集合进行数理逻辑的扩展。在

人们的日常生活中，不精确地推理无法用多值逻辑完成，所以需要使用近似推理从不精

确的前提中得到不精确的结论。模糊推理在很多场合与人类的思维逻辑决策相似。常用

的方法有：基于模糊关系的合成推理，基于 Zadeh 的模糊推理，基于 Mamdani 的模糊

推理，基于 Mizumoto 的模糊推理等。

使用模糊推理进行特征融合主要包括以下几个步骤：

Step1.建立关于模糊规则的规则库；

Step2.定义使用模糊规则隶属度函数的数据库；

Step3.构建执行推理的决策单元；

Step4.将输入转化为与想要输出结果相关的模糊界面；

Step5.模糊清晰化，将得到的模糊结果转化为明确的模糊界面。

9

基于多特征的驾驶员疲劳驾驶识别

10

第三章 人脸定位

第三章 人脸定位

3.1 引言

当对驾驶员进行疲劳驾驶识别时，一般使用车载摄像头进行捕捉驾驶员画面，因此

精准确定驾驶员人脸区域对驾驶员疲劳状况的判定具有重要意义。当前检测驾驶员人脸

信息通常有基于先验知识的方法，基于模板匹配的方法和基于特征提取的方法。这几种

方法中，使用先验知识对驾驶员人脸进行检测与其他的方法相比，操作较为容易，但是

缺乏常规的衡量标准，导致最终检测率下降；使用模板匹配的方法进行人脸区域的检测

衡量人脸较为标准，但是这种方法受外界条件影响较大，鲁棒性弱；通过提取人脸特征

进行面部检测，通用性强，检测性能相对较高，检测算法的鲁棒性强。当前常用AdaBoost

算法进行特征提取，该算法性能相对其他检测方法检测性能更为优越。但是传统的

AdaBoost算法由于弱分类器权重问题，会因为困难样本的分类问题而造成梯度爆炸现象，

而且对于复杂背景和弱光环境检测效率低。本文从解决困难样本分类问题出发，对检测

图像进行预处理，考虑弱分类器权重更新方式，有效提高驾驶员脸部信息定位精准率。

因此为了解决传统AdaBoost算法的样本分类问题和复杂背景和光照强度检测低的

弊端，本章提出一种改进的AdaBoost算法。首先使用肤色分割算法，利用肤色拥有良好

聚类性的特点，将待检测图像分割为皮肤区和非皮肤区。然后，使用光照补偿算法解决

复杂光源的影响，同时引入改进了权重更新规则的AdaBoost算法构建分类性能强大的级

联分类器实现对驾驶员人脸的有效监测。

3.2 驾驶员人脸图像预处理

3.2.1 肤色分割算法

虽然使用传统的AdaBoost算法生成的人脸检测器比其他方法生成的性能好很多，但

仍然存在着检测率差和误检率高的问题。当待检测图像存在背景复杂、人脸姿态有角度

变化等问题时，误检率就会大大提升，最终导致检测结果的性能大打折扣。

为此，本文在驾驶员人脸检测之前引入肤色区域分割算法缩小检测区域，从而达到

缩短检测时间的效果[50]，有效避免了复杂背景对驾驶员人脸检测的影响，使得人脸检测

在速度上和正确检测上拥有很大优势。肤色区域分割过程可表示如下：

Step1. 转换待检测图像的颜色空间，减少频宽占用率。转换公式如式 3.1-3.3：

Y



 0.257 *

R



0.564 *

G



0.098*

B



16

Cb

 

  0.148*

R



0.291*

G



0.439 *

B



128

Cr



 0.439 *

R



0.368*

G



0.071*

B



128

11

（式 3.1）

（式 3.2）

（式 3.3）

 
 
基于多特征的驾驶员疲劳驾驶识别

Step2.使用高斯模型进行肤色建模。用数学方法通过建模得到一个函数，输入像素

的Cb和Cr的值，输出该像素的阈值。

Step3.通过自适应阈值分割[51]，将图像中的像素点全部搜索一遍，通过Cb、Cr分割

阈值的方法分割肤色区域，根据每个像素点的肤色模型计算它基于肤色的可能性，将

Cb,Cr值不在阈值内的像素点分离。

Step4.对肤色二值化图像进行优化处理，得到平滑图像。

肤色分割的效果如图 3.1 所示。从图中可以看到待检测图像通过肤色分割之后，肤

色区域明显地展露出来，与背景区域很容易区分开。减小了待检测区域，有助于之后的

驾驶员人脸检测时间效率的提升。

（a）原图

（b） 肤色分割效果图

图 3.1 肤色分割
Figure 3.1 skin color segmentation

3.2.2 光照补偿算法

据国家安全部和天津交警总队的数据表明，疲劳驾驶易发时段为深夜的 24 时至 2

时和凌晨的 4 时至 6 时。这两个时段中采集到的驾驶员人脸图像由于光照强度过低，导

致人脸检测效率和检测率大大降低。因此，本文引入光照补偿算法，对待检测的夜间驾

驶员人脸进行光照增强，提高夜间驾驶员人脸检测效率。

光照补偿效果如图 3.2 所示。在光照强度差的环境下，提升驾驶员人脸待检测图像

的光照强度，为下一步的驾驶员人脸检测打好基础。

（a）原图

（b）光照补偿效果图

图 3.2 光照补偿
Figure 3.2 light compensation

12

3.3 AdaBoost 算法介绍

第三章 人脸定位

AdaBoost算法是一种自适应增强的分类算法，作为Boosting算法的升级版，它的自

适应体现在会不断加强上一个分类器分错的样本权值，然后下一个分类器训练加强权值

后的错误样本，每训练一次得到一个弱分类器，最后将所有的弱分类器叠加融合，作为

最终的强分类器进行决策。其算法原理如下：

Step1.初始化训练样本权值

Step2.使用样本训练弱分类器，对准确分类的样本，降低其权重存放到下一个训练

集中，而错误分类的样本，升高其权重存放到下一个训练集中，将权重更改后的样本组

成新的训练集训练下一个弱分类器，然后一直迭代下去直至达到预定错误率为止。

Step3.将每次训练得到的弱分类器进行级联，构建最新的强分类器。

3.4 基于改进的AdaBoost算法的驾驶员人脸定位

传统的AdaBoost算法在分类标准上更注重被错分的样本。因此很难对训练样本中包

含的噪声样本或一些罕见困难样本进行正确分类，每次迭代之后，算法都会将训练重点

转移到分类困难的样本上，成倍增加分类错误样本的权重，这样就可能造成梯度爆炸的

现象。而且过分重视困难样本，随着迭代次数的增加，正确的分类规则会慢慢丢失，从

而大大影响算法性能。

为了解决上述问题，本文将弱分类器的权重系数进行动态调整，得到训练样本在传

统AdaBoost算法中弱分类器和其相对应的权重系数

，计算每一个弱分类器对待检测样

本周围多个训练样本的分类准确率

，将各个弱分类器的权重系数改为

mt

，利用局

部敏感哈希方法的余弦相似性寻找待检测样本的近邻点。再将待检测样本通过局部敏感

mt ∗ nt

nt

哈希方式哈希到一起，则该区域的其他数据是待检测样本的近邻样本数据，这些数据构

建成新的测试集D，然后各个弱分类器对D进行分类测试，从而判断各个弱分类器与M的

匹配程度，最后，将其分类的准确率作为M的动态权重系数β。

具体算法步骤如下：

Step1.输入训练数据集M，正样本为 1，负样本为－1

M


 =  x ,
1

y
1

 
, x ,
2

y

2



,


y
x ,n

n



（式 3.4）

Step2.将训练集样本权重，每一个训练样本赋予同样的权重，n为样本总数。

表

示第一次迭代时每个样本的权值。

表示，首次迭代时的第一个样本的权值。

 1

M

1





w w
,
11
11

,

 11

w
,
1

n



,

w
1

i




i

1
n



1, 2,3,



,

n



（式 3.5）

13

基于多特征的驾驶员疲劳驾驶识别

Step3. For t=1,

，选择拥有最小错误率的训练样本作为进行循环的弱分类器

Step4.计算弱分类器在训练集上的错误率a:

⋯T

a

n

 

i



1

w

i n
,

Step5.计算弱分类器的加权系数k:

k



1
2

ln

1



a

a

ℎ 

（式 3.6）

（式 3.7）

Step6.利用局部敏感哈希方式来从训练集中找到相似的样本数据，并将它们组合成

一个新的测试集D；

Step7.使用弱分类器

对新的测试集合进行分类测试，利用上式计算动态权重系数；

Step8.得到最终的强分类器:

hi

Step9. 将每个训练过程得到的弱分类器组合，形成一个强分类器。即：


F x



3.5 实验结果分析

3.5.1 视觉效果对比

T

 

i


1


a h x 
i
i



i

（式 3.8）

为了验证改进算法的有效性，对检测的视觉效果与传统算法进行比较。性能比较的

结果如图 3.3 和图 3.4 所示：

（a）传统AdaBoost算法

（b）改进后的AdaBoost算法

图 3.3 两种算法在白天驾驶员人脸检测的性能比较

Figure 3.3 comparison of performance of two algorithms in face detection of drivers in

daytime

14

第三章 人脸定位

（a）传统AdaBoost算法

（b）改进后的AdaBoost算法

图 3.4 两种算法在夜间驾驶员人脸检测的性能比较

Figure 2.4 performance comparison of two algorithms in driver face detection at night

从图 3.3 和图 3.4 的视觉效果可以明显看出：对于白天的驾驶员图像，当有遮挡物

对人脸信息进行遮盖时，传统算法未能检测到全部的人脸信息，只能检测到明显的、无

遮挡物的人脸而本文算法可以良好的检测到包括有遮挡信息的全部人脸图像。对于夜间

的驾驶员图像，当图像光照强度过低时，传统算法会产生误检情况,而本文算法不仅能

减少误检情况，而且能对光照强度较低的驾驶员人脸图像进行有效的检测。

3.5.2 检测指标对比

本文从检测率和误检率对改进算法进行性能验证。因为实验数据集分为白天和夜间

两种。所以本次实验将两种人脸检测算法性能在白天和夜间分别做了比较。比较结果记

录在表 3.1-3.3。

检测率对比

表 3.1
Table 3.1 comparison of
detection rate
[48]算法 本文算法

图像

表 3.2 误检率对比
Table 3.2 comparison of false
detection rate
图像 [48]算法 本文算法

白天

夜间

84.3

80.6

94

87.3

白天

夜间

17.9

25.4

9.3

11

表 3.3 检测时间对比
Table 3.3 test time comparison

图像 [48]算法 本文算法

白天

夜间

180

83

102

57

从表 3.1-3.3 的数据结果来看，本文提出的算法对于白天即光照强度良好的图像检

测率达到了 94%，误检率为 9.3%，对夜间图像即光照强度较弱的图像检测率为 87.3%，

误检率为 11%，检测效果略低于白天，符合实际效果。而传统算法在白天图像检测率只

有 84.3%，误检率为 17.9%，对于夜间图像的检测率是 80.6%，误检率高达 25.4%。因

此可以证明无论在检测率、误检率还是在检测时间上对不同光照强度的人脸图像的检测

本文的人脸检测算法都明显优于传统算法，这充分说明本文的算法对驾驶员人脸图像的

检测效果更好。

15

基于多特征的驾驶员疲劳驾驶识别

综上，本文算法在检测复杂背景和光照强度不佳的的图像时，相对于传统算法的检

测结果在主观和客观上都具有明显的优势。

3.6 本章小结

本章所描述的人脸检测算法，首先对驾驶员人脸信息进行预处理，减少非人脸检测

区域以及因为复杂光源对人脸信息的干扰，在传统检测算法上引入新的权重更新规则，

对权重进行动态更新，最后将弱分类器进行组合，形成最红的强分类器对驾驶员人脸进

行有效检测。通过实验证明无论是主观指标还是客观指标，与传统的人脸检测算法相比，

本文的人脸检测算法处理速度更快，检测效率更高，且鲁棒性更强，当人脸处于夜间环

境或者是脸部区域有障碍物遮盖的情况下，人脸图像仍然被准确检测到。

16

第四章 面部特征提取及疲劳量化

第四章 面部特征提取及疲劳量化

驾驶员面部特征分析，是本文疲劳驾驶检测中的重要部分。检测到驾驶员人脸信息

之后，通过人眼定位和嘴部定位的方式确定相关区域，对该区域进行研究分析，从而有

利于判断驾驶员当前状态.本章对所获取的人脸图像进行处理，定位眼部、嘴部，并分

析眼部、嘴部状态，便于下一步对多特征进行分析，从而完成疲劳驾驶状态的判定。

4.1 引言

在驾驶员面部疲劳特征检测方面，常用的方法是对驾驶员眼部进行分析，提取疲劳

特征。但是驾驶员在驾驶过程中，除了眼部会反映疲劳现象之外，还有其它部位也可以

体现驾驶员的疲劳情况。并且在面部特征疲劳量化方面，传统的量化方法只对眼部或者

嘴部的宽高比进行疲劳量化，当驾驶过程中出现身体转动或者汽车摇晃、路面不平等情

况时，这种量化方法不稳定。

因此本文在驾驶员面部疲劳特征检测方面，使用 LBF 算法进行人脸区域的眼部定位，

并引入局部约束模型对 LBF 算法进行改进，精确检测人眼。使用三庭五眼进行嘴部定

位时，根据多次试验数据改进定位参数。在面部特征的疲劳量化方面，针对眼部疲劳引

入眼部位置的黑白像素比进行多因子量化，针对嘴部疲劳引入嘴部圆形度进行多因子量

化。从而为下一步的疲劳驾驶判定打好基础。

4.2 人眼定位

驾驶员在长期驾驶的过程中，会因为长时间未得到有效的休息时间，从而导致自身

的生理状态和心理状态发生明显的变化，驾驶员会出现反应迟钝，思绪混乱，注意力不

集中，周身不适，全身疲惫等现象，甚至会出现眼睛睁闭速度缓慢或者睁不开，更有甚

者直接进入睡眠状态，严重影响了驾驶的安全性，大概率会引发交通事故。通过对驾驶

员疲劳状态下的生理行为和心理行为的分析与研究，眼部的状态会极大程度地反映驾驶

员的疲劳程度，并且在驾驶过程中，与驾驶员的安全行为有直接联系。本节使用 LBF

算法进行人脸区域的人眼检测，对得到的人眼图像特征进行分析，判别此时的人眼状态，

从而完成疲劳驾驶检测的疲劳状态判定。

4.2.1 基于 LBF 算法的人眼定位

在驾驶员人眼的检测中，人眼图像往往会因为光照、遮挡等复杂场景而难以定位，

从而影响传统的人眼算法的检测精度。因此本节提出了一种改进的人眼检测算法。

本文首先通过样本训练好局部约束模型，然后利用基于回归的局部二值特征法去

检测人眼图像，并且将人眼和图像信息进行局部拟合，最后将策略模型进行参数优化，

17

精确检测到人眼特征点。步骤如下：

基于多特征的驾驶员疲劳驾驶识别

Step1.构建人眼形状模型。首先手工标定训练样本，通过标定特征点表示人眼形状，

将样本的特征点用向量表示，将所有的向量构建成的向量组所求均值表示人眼。

Step2.构建局部补丁模型。让每个特征点在邻域内寻找最佳匹配点。

Step3.使用 OPENCV 自带的 LBF 算法进行人眼检测。

Step4.CLM 拟合。对新图像中的目标建立新模型，用训练好的模型与新模型进行拟

合定位特征点。

Step5.利用优化策略模型参数精确定位人眼。

4.3 嘴部定位

驾驶员在疲劳状态下行驶，会出现注意力不集中，行动迟缓，对当前事件做出的反

应变慢，时间变长，出现困倦现象，除了眼睛睁闭速度缓慢或者睁不开，同时会做出打

哈欠的动作。驾驶员在驾驶车辆的行驶过程中，嘴部一般处于闭合状态，当在行驶过程

中讲话时，嘴部会微微张开，但是幅度变化不均匀且角度较小，当驾驶员处于疲劳驾驶

时，驾驶员嘴部在打哈欠的过程中，嘴部张开幅度变大，幅度变化均匀且保持同样状态

的时间较长。因此，驾驶员的嘴部特征信息也可以反映驾驶员的疲劳状态。

4.3.1 基于三庭五眼的嘴部定位

本文基于三庭五眼的方法对嘴部进行定位。三庭五眼是按照人面部器官的位置和分

布得出的规律。三庭分为上中下三庭。其中从发际线到眉心，眉心到鼻翼下缘，边缘处

到下巴依次分为上庭、中庭和下庭。而五眼是将脸的宽度进行五等分。从左到右依次为

左眼到左侧发际线、左眼、左眼到右眼、右眼、右眼到右侧发际线[52-55]。因此本文以人

脸面部的 1/3 处以下，宽度为 1/5-4/5 脸宽之间为嘴部检测区域。

通过实际测试发现，此方法在驾驶员打哈欠等状态下的嘴部定位过程中，不一定于

每帧所划分的区域中获取到完整的嘴部区域。这里，对“三庭五眼”进行相关调整，使

得嘴部区域信息更完整，保证了减少冗余信息的同时，不丢失必要的嘴部区域信息。通

过相关实验分析，设定嘴部粗定位区域尺寸如公式如下：

W
m

W
0.5

H

m



0.4

H

f

f

（式 4.1）

（式 4.2）

其中 fH 指人脸上额到下巴之间的距离， fW 为人脸两颊之间的距离， mH 为嘴部区域
的高度， mW 为嘴部区域的宽度。依据“三庭五眼”所描述的分布信息和调整的区域提
取规则，对人脸检测获取到的脸部图像进行定位.

18

第四章 面部特征提取及疲劳量化

4.4 疲劳视觉特征分析

本节对疲劳特征进行量化分析，具体如表 4.1。

表 4.1 疲劳表现和疲劳特征的关系

Table 4.1 relationship between fatigue performance and fatigue characteristics

疲劳表现

面部位置

对应的量化关系

闭眼

眨眼

打哈欠

眼部

眼部

嘴部

PERCLOS（闭眼时间所占比例）

单位时间内的闭眼次数

一段时间内的打哈欠时间和次数

通过实验和文献表明，当司机处于疲劳驾驶时，他的眼睛和嘴巴的睁开角度会发生

明显变化，严重时会出现长时间闭眼或打哈欠的情况。因此使用一段时间内的闭眼比例、

单位时间内的眨眼次数和一段时间内的打哈欠次数和时长作为疲劳检测的研究指标具

有可行性。

4.5 疲劳特征量化

通过统计调查，我们每个人每天都在不停的眨眼，不同的人因为生理特性不同从而

导致数据可能会出现偏颇。正常人在清醒状态下，平均 3-5 秒钟就会进行一次眨眼，每

一次眨眼的时间大约是 0.2-0.4 秒。而当处于疲劳状态下时，会产生眼睛干涩的现象，

出于生理本能为了让干涩的眼球得以润滑，眨眼频率会发生改变，会出现眼角微张，甚

至闭眼的情况。因此一段时间内的闭眼时间和眨眼频率是两个极为重要的视觉疲劳指标

因子。因为前面已经叙述了疲劳特征的提取过程，所以本节详细介绍疲劳特征的量化过

程。本文提出并分析了眼部和嘴部的 4 个疲劳特征。其中眼部的疲劳特征的量化指标为

眨眼频率和PERCLOS，而嘴部疲劳特征的量化指标为打哈欠的时长和频率。

4.5.1 基于多因子的眨眼频率检测

（1） 闭眼行为统计

当驾驶员在疲劳驾驶时，眼部状态会反映出大量信息。在精所以确定位到人眼之后，

将人眼图像二值化，通过计算人眼的高宽比来判断眼睛的闭合状态。

眼部的宽高比为眼睛的上眼与下眼的距离与眼睛的左右眼角的距离之间的比值。

计算公式为式 4.3。

S
1



H
1
W
1

（式 4.3）

其中 1H 为二值图像中的上眼和下眼之间的距离， 1W 是指二值图像中的左眼角到右

19

基于多特征的驾驶员疲劳驾驶识别

眼角之间的距离。 1S 为眼部的高宽比值。设置ECT（Eye Closure Threshold）为眼部闭合
阈值，当 1S 大于ECT，则判断眼部处于睁开状态，当 1S 小于ECT，则判断眼部处于闭合
状态。E(n)表示第n帧图像中眼部的瞬间闭合状态。表示如式 4.4。

 
E n


 


1,   
0,   

 
S n
1
 
S n
1




Ect
Ect

（式 4.4）

通过大量的实验统计可知人眼睁开时，眼部的高宽比 1S 的范围是 0.21-0.75，而人眼
闭合时，眼部高宽比 1S 的范围是 0.13-0.24。可以发现，当眼部高宽比大于 0.24 的时候，
人眼是处于睁开状态，当眼部高宽比小于 0.13 的时候，人眼是闭合的。但是当人眼的宽

高比值在 0.21-0.24 的范围内时，使用宽高比作为眼睛闭合状态的判断依据会出现错误

检测。所以本文引进一个新的判断依据，眼部区域的黑白像素比n，当人的眼睛在睁开

的时候，n的范围是 0.13-4.80，在闭合的时候，n的范围是 0.06-0.15。而且当人的眼部区

域的黑白像素比值低于 0.15 时，人眼的宽高比值也会变得非常小。所以当 0.21< 1S <0.24，
n<0.15 时，人眼处于闭合状态。

其中眼部像素比EPR（Eyes Pixel Ratio）为眼部的黑像素和白像素的比值，如式 4.5。

其中Bp表示眼部的黑像素值，Wp表示眼部的白像素值。

EPR

 = 

p
B
Wp

（式 4.5）

（2）眨眼频率

确定了眨眼频率计算方式外，本节对眨眼频率进行统计，流程图如图 4.1 所示，具

体步骤如下：

Step1.首先设定眼部的初始状态为睁开，即睁眼=True，眨眼次数为 0;

Step2.随着宽高比的减小，眼睛张开角度在变小，趋于闭合。宽高比增大，眼睛张

1ECT 的连续帧数大于阈值时，则判断眼睛处于闭合状态，

开角度变大，趋于睁开。当 1S <
2ECT 的连续帧数大于阈值的时候，则判定眼睛处于睁开状态，即
眨眼次数加 1；当 1S >
2ECT 时，计算眼部区域的黑白像素比。当像素比EPR的连续帧
闭眼=False；当 1ECT < 1S <
数大于阈值时，眼睛处于睁开状态，当像素比EPR的连续帧数小于阈值时，眼睛处于闭

合状态，眨眼次数加 1；

Step3.通过大量实验得知， 1ECT 的阈值设置为 0.21， 2ECT 的阈值设置为 0.24，黑白

像素比阈值设置为 0.15 是合理的

Step4.最后统计在一段视频内的眨眼频率（次数）。

20

第四章 面部特征提取及疲劳量化

图 4.1 眨眼频率计算

Figure 4.1 Calculation of blink frequency

4.5.2 基于眼部疲劳的PERCLOS计算

据调查研究显示，一段时间内眼睛的闭合时间可以反映疲劳程度。对此相关研究

人员多次实验后，提出了PERCLOS(Percentage of EyeIid Closure over the PupiI over Time，

简称PERCLOS）作为疲劳参数。美国公路安全局通过模拟驾驶实验，对九种疲劳检测

指标进行比较。结果表明PERCLOS最能反映驾驶员的疲劳情况。其定义为单位时间内
眼睛闭合一定比例所占的时间[56]， 表示如式 4.4，常用的标准为P70 和P80。

21

基于多特征的驾驶员疲劳驾驶识别

PERCLOS

 = 

m

t





1
T
total

i

i



100%

（式 4.6）

其中 it 是指眼睛闭合程度超过阈值的时间， totalT 是指检测总时长。
图 4.2 为 P80 的示意图，横纵坐标分别表示时间和眼睛开度。

图 4.2 P80 示意图
Figure 4.2 P80 diagram

计算公式如式 4.7 所示。



f
1

t
3
t

4




t
2
t
1



100%

（式 4.7）

图 4.2 为 P80 的示意图，横纵坐标分别表示时间和眼睛开度。t1-t2 为眼睛闭合的时

间段，t3-t4 为眼睛睁开的时间段，其中 t1,t4 两个节点是眼部区域被遮挡的程度达到了

20%，而 t2,t3 两个时间节点是指眼部区域被遮挡的程度达到了 80%。

4.6 嘴部疲劳特征的提取量化

人在疲劳状态时，嘴部呼吸频率会产生变化，并且会伴随打哈欠的现象。因此在一

段时间内打哈欠发生的次数和时间会反应一个人的疲劳状况，可以将其看做嘴部的疲劳

特征。将前面获取到嘴部区域的图像进行二值化，计算嘴部的疲劳状况。

4.6.1 基于多因子的打哈欠检测频率

本节采用宽高比来描述嘴巴的张开程度。计算公式如下：

S

2



2

H
W
2

（式 4.8）

其中 2H 表示嘴巴上沿与嘴部下侧的边界高度的差值， 2W 表示嘴部左右两侧距离差

22

 
第四章 面部特征提取及疲劳量化

值， 2S 表示嘴部的宽高比。设置 MCT（Mouth Closure Threshold）为嘴部闭合阈值，当
2S 小于 MCT，则判断眼部处于闭合状态，当 2S 大于 MCT，则判断嘴部处于张开状态。
但是经过大量实验验证嘴部高宽比在 0.15-0.65 的时候处于微张状态，超过 0.65 为彻底

张开状态，小于 0.15 为闭合状态。因为图像在采集过程中，驾驶员会存在身体倾斜或者

移动的情况，单纯使用嘴部的宽高比来判断嘴部状态不够精确。所以引入圆形度来判断

嘴部状态。当嘴部二值化区域的圆形度小于 0.45 时嘴部为闭合或者是微张，当圆形度在

0.45-0.75 时处于正常张嘴状态，当圆形度大于 0.75 时处于打哈欠状态。具体流程图如

图 4.3 所示。

图 4.3 打哈欠次数计算

Figure 4.3 calculation of yawning times

步骤如下：

Step1.首先设定嘴部的初始状态为闭合；

Step2.随着宽高比的增大，嘴部区域的张开程度在变大，区域彻底张开。宽高比减

23

基于多特征的驾驶员疲劳驾驶识别

小，嘴部的张开角度变小，区域闭合。当 2S >
1MCT 的连续帧数大于阈值时，则判定嘴部
处于彻底张开状态，即打哈欠=True，打哈欠次数Yawn_count+1，当 2S <
2MCT 的连续帧
2MCT 时，计算
数小于阈值时，则判定嘴部处于闭合状态，及打哈欠=False，当 1MCT < 2S <
嘴部区域的圆形度。当圆形度的连续帧数大于阈值时，嘴部处于彻底张开状态，即打哈

欠=True，打哈欠次数Yawn_count+1，当圆形度的连续帧数小于等于阈值时，嘴部处于

闭合状态。

Step3.通过大量实验以及文献查询可知， 1MCT 的阈值设置为 0.15， 2MCT 的阈值设置

为 0.65，圆形度阈值设定为 0.75 是合理的

Step4.最后统计在一段时间内的打哈欠次数。

4.6.2 打哈欠的总时长

打哈欠的总时长，表示为所有检测为打哈欠现象的图像帧数总和，即记录所有的宽

高比大于阈值和圆形度大于阈值的总时长。

ya

wning time
_

 


s mct
2

T s
(

)

2

4.7 模拟实验及分析

（式 4.9）

为了验证本文所提出的多因子疲劳特征提取检测的效果，本文在软件平台下

对模拟疲劳的 4 个不同场景下的视频段进行测试，并与基于传统宽高比检测的疲

劳特征提取算法进行对比。实验结果如表 4.2 所示

表 4.2 模拟实验结果对比

Table 4.2 comparison of simulation experiment results

算法对比

片段 1 片段 2 片段 3 片段 4 平均检测率

眨眼检测成功率

93.7%

92.6%

93.5% 94.1%

基于宽高比眨眼检测成功率

88.1%

89.5%

87.0% 91.3%

打哈欠检测成功率

89.7%

88.6%

91.5% 90.2%

基于宽高比打哈欠检测成功率

84.5%

83.1%

83.3% 80.2%

93.5%

89.1%

90.0%

82.8%

从上表中数据可分析到，本文多因子的眨眼状态检测的平均成功率为 93.5%，而基

于宽高比的眨眼检测算法的检测成功率为 89.1%，多因子的打哈欠次数检测的平均成功

率为 90.0%，基于宽高比的打哈欠检测算法的检测成功率为 82.8%。因此本文的多因子

眼部和嘴部的疲劳特征检测成功率均高于基于传统宽高比的检测算法。进一步验证了本

文算法的可行性。

24

4.8 本章小结

第四章 面部特征提取及疲劳量化

本章在对驾驶员疲劳状况检测之前做了两方面的准备，一是面部疲劳特征的定位提

取，二是面部特征的疲劳量化。

在面部疲劳特征的定位提取方面。本章在第二章面部轮廓区域精确定位到的情况下，

分别对驾驶员眼部和嘴部进行精确检测。首先，介绍了常用的眼部区域定位方法。针对

目前方法存在的问题，在传统LBF算法中引入局部约束模型，提升眼部检测的准确率，

然后使用三庭五眼的方法稍加改进，完成对嘴部区域进行检测。

在面部特征的疲劳量化方面，本章在精确检测到眼部和嘴部区域后，对眼部区域的

疲劳特征进行提取量化时，在眼部宽高比的基础上加入眼部像素比进行量化，在嘴部区

域疲劳特征的提取量化中，在嘴部宽高比的基础上加入嘴部圆形度进行量化。

25

基于多特征的驾驶员疲劳驾驶识别

26

第五章 基于逻辑回归的多特征疲劳检测算法

第五章 基于逻辑回归的多特征疲劳检测算法

本章基于逻辑回归算法对已经量化的疲劳特征进建立起与疲劳之间的关系。目前常

用的疲劳检测算法对疲劳检测的特征研究较少，对于不同的背景和行驶员来说缺乏统一

性，因此本章提出了基于逻辑回归的面部多特征融合检测算法，借此解决不同行驶情况

下的疲劳检测问题，从而提升疲劳检测性能。

5.1 引言

现有算法多是对人眼状态进行 PERCLOS 分析从而检测疲劳状态[57-58]，但是驾驶员

在驾驶过程中会因为道路情况、天气状况等不定性因素存在较多的起伏变化，因此使用

单个的疲劳特征对驾驶员疲劳状态进行分析，考虑因子较少，而且过于依赖单一变量，

检测的准确率较低，缺乏鲁棒性，疲劳算法检测性能不佳。本文从多个疲劳特征入手，

考虑单一特征检测疲劳状态准确率低的情况，提高驾驶员疲劳检测性能。

因此为了解决上述问题，本文综合考量多种疲劳特征，针对驾驶员面部的多个疲劳

位置进行检测，并使用机器学习模型将多种疲劳特征融合检测，并且分析了驾驶员的疲

劳特征，通过对数据进行训练，选择最优的检测模型。在前几章数据处理和疲劳特征量

化的基础上，使用该模型进行特征融合，最终得到疲劳结果。具体流程图如图 5.1 所示。

图 5.1 基于逻辑回归的多特征融合检测算法

Figure 5.1 multi feature fusion detection algorithm based on logistic regression
27

5.2 模型筛选

基于多特征的驾驶员疲劳驾驶识别

本节对常用的机器学习进行训练，从多角度比较筛选出最优的模型，作为本节的检

测模型。图 5.2 为数据结果。

图 5.2 机器学习模型比较图
Figure 5.2 Comparison of machine learning models

详细数据值如表 5.1 所示。

表 5.1 检测模型性能比较

Table 5.1 performance comparison of detection models

模型

决策树模型

随机森林模型

SVM

朴素贝叶斯模型

逻辑回归模型

准确率

0.916

0.92

0.92

0.907

0.942

精确率

召回率

0.899

0.912

0.932

0.873

0.962

0.910

0.925

0.940

0.932

0.970

从表 5.1 的数据中可以看到，逻辑回归模型在准确率方面达到了 94.2%，是常用的

这几种模型中准确率最高的，而朴素贝叶斯模型相对较差只有 90.7%，在精确率方面逻

辑回归模型最高为 96.2%，同样是朴素贝叶斯模型性能最差，精确率为 87.3%。从召回

率这个角度来看，逻辑回归模型召回率最高达到了 97.0%，但是决策树模型的召回率只

有 91.0%。因此逻辑回归模型无论是在准确率，精确率还是召回率方面都高于其他模型，

28

第五章 基于逻辑回归的多特征疲劳检测算法

所以本文使用逻辑回归模型进行驾驶员的疲劳检测。

5.3 基于逻辑回归模型的疲劳检测

5.3.1 核函数选择

由于本文是从多维度对疲劳进行检测，所以不是一个线性问题。需要进行从低维空

间到高维空间进行维度变换，一般使用核函数完成此任务。本节通过性能对比筛选合适

的核函数。当前以下四种核函数使用频率较高，分别是：

线性核函数（Linear Kernel）

k( ,

x y

) =  T

x y

c

高斯核函数（Radial Basis Function）

k( ,

x y

) = exp(-

 
x

y

2

)

多项式核函数（Polynomial Kernel）

k( ,

x y

T
) = (ax y+c)

d

Sigmoid 核函数

x
k( )



1
e


x

1

（式 5.1）

（式 5.2）

（式 5.3）

（式 5.4）

本文对常用的四种核函数进行性能对比，首先利用这四种核函数构建左眼和右眼的

疲劳检测模型，利用 4 折交叉验证法将数据集中的 40%的样本用作训练，剩下的 60%用

作模型测试，用准确率为衡量指标，优先检测率最高的核函数作为疲劳检测模型的基础

核函数。

表 5.2 核函数对比

Table 5.2 comparison of kernel functions

核函数

左眼检测率

右眼检测率

线性核函数

多项式核函数

高斯核函数

Sigmoid 核函数

0.935

0.954

0.674

0.813

0.917

0.958

0.655

0.821

从表中数据可以看出在左眼的检测率方面线性核函数和多项式核函数都超过了

90%，相比高斯核函数和 sigmoid 核函数高出很多，更适合作为基础核函数进行检测模

29

基于多特征的驾驶员疲劳驾驶识别

型的构造，其中多项式核函数比线性核函数略高一些，达到了 95.4%。而在右眼检测率

方面，多项式核函数的检测率达到了 95.8%，而线性核函数只有 91.7%，多项式核函数

高出 4.1%，综合来看，多项式核函数相对线性核函数的检测率更加符合模型需求。因

此本文选取多项式核函数作为基础核函数进行模型学习和训练。

5.3.2 基于逻辑回归的疲劳检测模型

逻辑回归模型和线性回归相似，线性回归无法解决多维度问题，逻辑回归在其基础

上引入函数映射，首先将特征数据线性求和，使用映射函数进行预测。

本文使用逻辑回归模型进行疲劳检测，输入四个特征分别是眨眼频率和时间，打哈

欠次数和时长，输出结果是疲劳和不疲劳。具体步骤如下：

Step1.准备数据样本，采集疲劳和不疲劳的特征向量。

Step2.构建映射函数 h，进行逻辑回归。

x
h ( )




g

T

(

x

)



1
T



e

x

1



（式 5.5）

Step3.进行最大似然估计，求导得到逻辑回归参数的迭代公式，如式 5.6，构建逻辑

回归模型。

  
(
j



:

j

i
( )

y



h x
(


i
( )

))

x

j

i
( )

（式 5.6）

Step4.将数据样本制作成训练集，训练模型。

Step5. 输 入 待 检 测 数 据， 提 取 所 求 的 疲 劳 特 征 图 像帧 数 ， 计 算 本 文 所 设 置 的

PERCLOS、眨眼频率、打哈欠次数和打哈欠时长四个特征的疲劳参数。

Step6.将疲劳参数代入到检测模型中计算，输出检测结果，检测结果为 1 表示疲劳，

反之，检测结果为 0 表示不疲劳。

5.4 眼部和嘴部疲劳判定

本文综合眨眼频率，眨眼总时长占比，打哈欠频率，打哈欠总时长四个特征进行疲

劳判定。根据 P80 标准，人的眼部的睁开度大于 20%处于睁眼，小于 20%为闭眼，然后

统计人眼闭合时间占规定时间的比值[50]。本文通过用连续时间内闭合帧数与总帧数的比

值来计算眨眼总时长占比的值，使用眨眼总次数和总时长的比值计算眨眼频率，最后综

合考虑两种疲劳特征的影响因素计算眼部疲劳 P。表示如下列式 5.7-5.9：
时间内眼睛的闭合时间

T

P
1 =

T

*100%

P
2 =

时间内眨眼次数

T

T

*100%

30

（式 5.7）

（式 5.8）

第五章 基于逻辑回归的多特征疲劳检测算法

P P
1

= *0.65+ *0.35

P
2

（式 5.9）

其中 T 为时间长度，设置 T 为 50s,实验中采用 10 帧/s.当 P 大于 20%视为疲劳。

同时，当人处于疲劳时，打哈欠次数会增加，所以本文用连续时间内打哈欠次数与

总时长的比值来计算打哈欠频率，打哈欠时长已给出计算公式，综合考虑考虑两种疲劳

特征的影响因素计算嘴部疲劳 Y。表示如式 5.10-5.12：
T

时间内打哈欠次数

Y
1



T

*100%

Y
2



awning time
y

_


Y Y
1

*0.55



Y
2

*0.45

（式 5.10）

（式 5.11）

（式 5.12）

其中 T 为时间长度，设置 T 为 50s,实验中采用 10 帧/s.当 Y 大于 15%视为疲劳。

5.5 仿真结果分析

5.5.1 实验环境与数据来源

实验环境：本文实验基于Windows操作系统。采用Intel(R)Core(TM)i5 7200CPU双核

处理器，16GB内存，在Microsoft Visual Studio 2019 平台下构建了提出的改进的疲劳检

测模型，在MATLAB R2017a平台进行模拟测试。

数据来源：实验数据来源于网络上爬虫和数位驾驶员志愿者的实地拍摄。视频集来

源于 6 名实验者模拟驾驶时过程所拍摄的。其中甲、丙、丁背景均为正常光源且脸部无

遮挡物，而戊、己所处背景为低光源且脸部有小型遮挡物。

5.5.2 实验结果分析

实验对 6 名实验者模拟实际驾驶中出现的疲劳活动进行疲劳状态检测，并与常用的

两种单特征疲劳检测算法进行比较，实验结果如表 5.3 所示：

从表中数据可以看出，当测试人员甲的眼部疲劳和嘴部疲劳均超过阈值，或者是当

测试人员丁的眼部疲劳和嘴部疲劳均为超过阈时，值本文检测算法和基于单特征的眼部

或者嘴部的检测算法都可以正确检测出来此时的疲劳状况。而测试人员丙的眼部疲劳没

有超过阈值，嘴部疲劳超过阈值时，基于眼部疲劳的单特征检测方法未能正确检测出此

时的疲劳状况，同理当测试人员乙嘴部疲劳没有超过阈值，但是眼部部疲劳超过阈值时，

基于嘴部疲劳的单特征检测方法未能正确检测出此时的疲劳状况。并且当实验背景出现

遮挡物或者是复杂光源时，对比算法由于人脸检测时未能精确检测到人脸导致最终的疲

劳状态不能识别出来。但本文的检测算法无论在何种情况都可以正确检测出驾驶员真实

的疲劳状态，进一步验证了本文算法的有效性。

31

基于多特征的驾驶员疲劳驾驶识别

表 5.3：疲劳检测试验结果

Table 5.3: Fatigue test results

测试人员

P/%

Y/%

本文算法

基于眼部的

基于嘴部的

检测状态

疲劳检测

疲劳检测

实际状态

甲

乙

丙

丁

戊

己

30.4

35.0

12.7

7.1

30.3

8.5

34.6

14.7

30.8

3.2

28.0

5.6

疲劳

疲劳

疲劳

正常

疲劳

正常

疲劳

疲劳

正常

正常

疲劳

正常

疲劳

正常

未识别

未识别

未识别

未识别

疲劳

疲劳

疲劳

正常

疲劳

正常

5.6 本章小结

本章通过对单特征疲劳检测方法进行分析，针对其存在问题进行改进，即使用多个

面部特征进行驾驶员的疲劳检测。综合考虑眼部和嘴部的疲劳特征。并且根据对不同机

器学习的性能对比，选出了最合适的检测模型LR模型。而且依据PERCLOS和打哈欠次

数规定了疲劳阈值。最后通过模拟仿真实验对本章算法和基于眼部的疲劳检测算法和基

于嘴部的疲劳检测算法在不同背景下进行比较，结果表明，无论驾驶员身处哪种环境下，

本章算法都可以准确判断出驾驶员是否处于疲劳状态。

32

第六章 基于模糊推理的疲劳识别原型系统

第六章 基于模糊推理的疲劳识别原型系统

本章融合逻辑回归模型和模糊推理规则，构建实时的疲劳识别系统，并根据被测者

的实时监测情况来判断是否处于疲劳状态。根据驾驶员的实时面部特征变化判断其有没

有疲劳情况的产生，并根据设定的模糊规则判断驾驶员实时的疲劳状态。具体的模糊规

则制定、平台搭建和仿真实验将在这章给出。

6.1 基于眼部和嘴部的模糊规则制定

6.1.1 基于眼部的疲劳规则

首先考虑眼部疲劳的情况，眼部疲劳的规则制定需要眨眼时间和眨眼频率两个参数

进行判断，将嘴部疲劳的程度分为三个等级 T1,T2,T3。通过两个参考因素判断三种程度

一共 9 条规则，疲劳规则如表 6.1 所示：

表 6.1 基于模糊推理的眼部疲劳规则

Table 6.1 rules of eye fatigue based on fuzzy reasoning

眨眼时间

眨眼频率

疲劳程度

短

中

长

短

中

长

短

中

长

快

中

慢

中

慢

快

慢

快

中

T1

T2

T3

T1

T2

T3

T1

T2

T3

6.1.2 基于嘴部的疲劳规则

其次考虑嘴部疲劳，嘴部疲劳的规则制定需要参考打哈欠时间和打哈欠次数两个因

素，将嘴部疲劳的程度分为三个等级 T1,T2,T3。通过两个参考因素判断三种程度一共 9

条规则，疲劳规则如表 6.2 所示。

33

基于多特征的驾驶员疲劳驾驶识别

表 6.2 基于模糊推理的嘴部疲劳规则

Table 6.2 mouth fatigue rules based on fuzzy reasoning

打哈欠时间

打哈欠次数

疲劳程度

短

中

长

短

中

长

短

中

长

多

中

少

中

少

多

少

多

中

T3

T2

T3

T2

T2

T3

T1

T2

T3

6.1.3 疲劳阈值判定

驾驶员在行驶过程中会存在不同情况程度的疲劳，而他们的眼部疲劳和嘴部疲

劳的程度反映了驾驶员的疲劳状况，本文采集了志愿者在不同疲劳情况下的模拟数

据，通过在不同场景下对所有测试人员进行疲劳特征的测试，最终得到眼睛(Pe)和

嘴巴(Pm)的三种状态阈值如表 6.3 所示。

表 6.3 眨眼和打哈欠的 P 值

Table 6.3 P value of blinking and yawning

疲劳行为

眼部疲劳

嘴部疲劳

低频

15%以内

13%以内

中频

15%-21%

13%-20%

高频

21%以上

20%以上

6.1.4 基于面部的模糊规则

通过表 6.3 中的数据可得到驾驶员眼睛和嘴部在不同程度的疲劳状况的阈值范围，

将疲劳情况分为三种状态：正常情况，轻微疲劳，严重疲劳。两种推测因素与三种疲劳

结果一共组成 9 条疲劳规则，如表 6.4 所示：

34

第六章 基于模糊推理的疲劳识别原型系统

表 6.4 疲劳检测模糊推理系统规则

Table 6.4 Rules of fuzzy inference system for fatigue testing

情况

1

2

3

4

5

6

7

8

9

眨眼

低频

中频

高频

低频

中频

高频

低频

中频

高频

打哈欠

推理结果

低频

低频

低频

中频

中频

中频

高频

高频

高频

正常

轻微

严重

正常

严重

严重

轻微

严重

严重

6.2 系统的软硬件平台

本文搭建了实时的疲劳检测系统，实验基于 64 位 Windows10 操作系统。采用

Intel(R)Core(TM)i5-7200 CPU 双核处理器， 16GB 内存， 在 Microsoft Visual Studio 2019

平台下构建了提出的改进的疲劳检测模型，在 MATLAB R2017a 平台进行模拟测试。

6.3 系统分析

疲劳检测系统主要是通过采集到的驾驶员面部特征，进行分析判定疲劳状态，最后

实时输出疲劳程度实现疲劳预警。通过大量资料的调查研究，结合本文工作，本系统实

现以下功能：数据预处理功能，人脸检测功能，疲劳检测功能，疲劳程度判定功能。以

下对这些功能模块进行分析：

（1）数据预处理模块：实现对驾驶员图像的肤色分割以及对弱光环境下光照的补

强。

（2）人脸检测模块：使用本文改进的人脸检测算法实时监测行驶员人脸信息。

（3）疲劳检测模块：根据用户需求，使用本文算法实现对驾驶员疲劳信息的实时

检测。

（4）疲劳程度判定模块：检测到用户疲劳信息后，对用户具体的疲劳状态进行不

同程度的划分。

6.4 系统设计

35

基于多特征的驾驶员疲劳驾驶识别

本系统为驾驶员疲劳检测系统，目的在于实时检测驾驶员的疲劳状况，加快检测效

率，减少因疲劳驾驶导致的交通事故的发生，而且本系统数据预处理模块，人脸检测模

块，疲劳检测模块，疲劳程度判定模块四个模块之间相互独立，操作方便。图 6.1 为系

统总体流程图。

图 6.1 疲劳检测系统流程图

Fig. 6.1 Flow chart of fatigue detection system

6.5 系统展示

6.5.1 系统界面

36

第六章 基于模糊推理的疲劳识别原型系统

本系统主要包含数据选择，数据预处理，人脸检测，疲劳检测，疲劳程度判定，退

出 5 个功能。点击打开数据的下拉框，选择文件中的所需检测的数据。点击数据预处理，

人脸检测，疲劳检测，疲劳程度判定按钮可分别实现各自功能。界面展示如图 6.2：

图 6.2 主界面图

Figure 6.2 Main interface

6.5.2 数据预处理模块

数据预处理模块是本系统重要的一个模块，对驾驶员图像进行预处理，便于更高效

的检测驾驶员人脸信息，从而实现后续的疲劳检测和疲劳状态识别。模块界面如图 6.3

所示。

图 6.3 图像预处理界面

37

基于多特征的驾驶员疲劳驾驶识别

Figure 6.3 Image preprocessing interface

6.5.3 人脸检测模块

人脸检测模块是本系统的中心环节，只有对驾驶员有效的检测到人脸信息，才可以

高效的进行后续功能。本文使用改进的 AdaBoost 算法导入人脸检测模块，大大提升了

人脸检测的效率。而且本模块除了可以实时检测人脸信息外，也可以额外选取相册图像

进行人脸区域检测。模块界面如图 6.4 所示。

图 6.4 人脸检测模块界面

Figure 6.4 Face detection module

6.5.4 疲劳检测模块

疲劳检测模块是对驾驶员进行实时的疲劳信息检测，使用本文的算法导入到疲劳检

测模块，输出驾驶员的眼部疲劳程度和嘴部疲劳程度，通过与阈值对比，从而对驾驶员

疲劳信息进行初步判定，并将检测结果输出。模块界面如图 6.5 所示。

图 6.5 疲劳检测模块界面
Figure 6.5 Fatigue detection module

38

第六章 基于模糊推理的疲劳识别原型系统

6.5.5 疲劳程度判定模块

疲劳程度判定模块是根据驾驶员的眼部疲劳程度和嘴部疲劳程度所处阈值区间，根

据模糊推理规则，对驾驶员具体疲劳状态进行程度划分，最终输出眼部、嘴部的疲劳程

度和检测结果。模块界面如图 6.6 所示。

图 6.6 疲劳状态判定模块界面
Figure 6.6 Interface of fatigue state determination module

6.6 实验仿真及结果评价

6.6.1 实验数据

本文构建了一个疲劳状态判定的数据集。数据集共有三个类别：正常情况、轻度疲

劳情况、重度疲劳情况。视频数量分别为 27 个、54 个、19 个。

6.6.2 实验分析

表 6.5 驾驶员疲劳状态检测率对比

Table 6.5 comparison of driver fatigue detection rate

疲劳状况

视频数量

本文算法

对比算法 1

对比算法 2

正常

轻度疲劳

重度疲劳

27

54

19

96.5%

95.7%

99.6%

95.8%

93.1%

98.4%

92.2%

90.8%

98.2%

本文利用构建的基于模糊推理的疲劳检测系统进行检测，使用 100 个不同疲劳状况

的视频数据检测本系统对驾驶员精神状况的检测率，并与其它算法进行对比，测试结果

如下表所示，其中对比算法 1 为基于眼部特征的疲劳检测[34]，对比算法 2 为基于嘴部特
39

征的疲劳检测[35]。

基于多特征的驾驶员疲劳驾驶识别

从表 6.5 中可看出驾驶员在正常状态下的检测率为 96.5%，轻度疲劳状态下的检测

率为 95.7%，当发生重度疲劳状态时的检测率为 99.6%。三种精神状态下的疲劳检测率

均超过了 95%，验证了本文所提出算法的可行性。而且本文所提出的基于逻辑回归的多

特征检测算法准确率无论是在哪种精神状态下都高于传统的基于单疲劳特征的驾驶员

疲劳检测算法，验证了本文算法的高效性。

6.7 本章小结

本章主要给出了驾驶员疲劳检测系统的软件架构思路。实验中将整个系统分为数据

预处理模块，人脸检测模块，疲劳检测模块，疲劳程度判定模块四大部分。本章首先介

绍了系统整个模糊规则的制定，然后介绍了搭建平台和总体功能，并进行了功能的分析。

接下来展示了系统各模块的界面，并给出了整个系统的关键流程图。最后对系统进行仿

真实验，验证了系统的可行性。

40

第七章 总结与展望

第七章 总结与展望

7.1 本文主要工作总结

人体会在工作时间过长、劳动强度过大时，进入疲劳状态。处于疲劳下进行驾驶不

仅会损害身心健康，还会增加交通事故发生的概率，对社会和人民造成财产损失和生命

危险。因此疲劳驾驶检测有着极为重要的研究价值。本文通过首先将采集到的驾驶员图

像进行预处理解决复杂背景和光源问题，然后将动态更新后的权重规则引入 AdaBoost

算法进行驾驶员人脸区域的检测，在精确检测到人脸的基础上使用 LBF 算法和三庭五眼

进行眼部和嘴部的检测，引入多种疲劳因子检测眼部和嘴部的疲劳特征，并将其量化分

析。最后将眼部和嘴部的疲劳状态融合代入到疲劳检测模型输出疲劳状态，并使用模糊

理论判定具体疲劳状况，构建疲劳检测系统完成驾驶员疲劳的实时检测。主要内容如下：

1.查阅关于疲劳驾驶方面的相关著作和专利，对目前常用的疲劳检测方法和国内外

关于此方法的现存问题进行总结和分析，确定了本文的整体方案，对采集到的图像和视

频信息进行系统性的处理。

2.对待检测的图像进行预处理，使用肤色分割的方法去除复杂背景，并对光源条件

较弱的图像进行光照补偿，提高人脸图像的检测效率。提出了一种改良的 AdaBoost 算

法。通过分析目前常用的人脸检测方法，提出使用 AdaBoost 算法来检测人脸区域信息，

针对传统 AdaBoost 算法弱分类器因处理困难样本导致最终检测率下降的问题，使用局

部哈希对权重进行动态调整，解决困难样本造成梯度爆炸的问题，从而使得检测算法可

以对不同样本都可以进行正常处理，从而提升分类器性能，大大提升了算法的检测率，

最后通过实验验证该方法的可行性。

3.对面部疲劳特征进行提取量化。在疲劳特征提取方面，首先对传统的人眼检测算

法引入局部约束模型进行性能改进，提升人眼检测正确率，使用三庭五眼的方法对嘴部

进行检测。在面部特征疲劳量化方面，创新性的提出使用多种疲劳因子进行眼部和嘴部

疲劳特征的量化，并且介绍了疲劳特征量化的详细过程，最后通过实验表明提出的多因

子进行面部疲劳特征的提取量化的方法是有效地。

4.使用最优模型进行疲劳特征的融合检测。使用最优模型进行疲劳特征的融合检测。

首先通过对常用的机器学习算法进行性能对比，从各个性能指标中筛选出最合适的模型。

综合考虑 4 个可以反映驾驶员疲劳情况的面部特征，使用逻辑回归模型将其进行融合检

测。最后通过实验与其他常用算法进行对比，验证了本文提出的多特征检测模型的高效

性和可行性。

41

基于多特征的驾驶员疲劳驾驶识别

5.使用模糊推理的方法，引用前面的检测模型二者结合构建疲劳驾驶识别原型系统。

建立模糊规则，依据眼部和嘴部疲劳阈值的区间，判定驾驶员具体的疲劳状态。

7.2 下一步工作展望

本文实现了基于面部多特征的疲劳驾驶检测，所实现的算法能够对驾驶员的疲劳状

态进行有效的识别，但是由于硬件设施的不完善，本文还存在着一些缺点和值得改进的

地方，对接下来的工作的展望还有以下几点：

1.因为实验条件有限，相关硬件设施不全，摄像头采集像素过低等原因，本文所采

用的疲劳数据集均来自于自己构造的疲劳数据库，其中数据来源除了在互联网上进行爬

取，剩余皆为志愿者在不同背景下模拟实验所拍摄的，视频数量较少，并且没有真实驾

驶情况下的数据。因此接下来的工作要采集到真实的行驶数据，扩充识别的疲劳数据库，

从而使对疲劳驾驶的研究更为可靠。

2.人体面部还有很多表情特征可以适时地反映驾驶员的疲劳信息，比如疲劳状态下

面部轮廓的变化。但本文仅通过的眼部的疲劳特征和嘴部的疲劳特征进行疲劳驾驶的分

析。如何从其他的面部表情特征或者是对其他疲劳驾驶研究方法例如车辆方向盘转角、

车道线偏移位置与面部表情特征进行融合考量，构建更加准确、鲁棒性更高的疲劳识别

模型还需要进一步进行研究。

42

参考文献

参 考 文 献

[1] 郑翔,彭媛. 自动驾驶汽车交通事故侵权责任主体认定的困境和可能[C]//世界人工

智能大会组委会、上海市法学会,2020:265-274.

[2] 王海洋. 基于人眼图像信息的疲劳检测方法的研究[D].沈阳工业大学,2007.

[3] 柴适.欧洲公共交通的战略研究[J].交通与港航,2018,5(01):72-75.

[4] 王祥,金正烽.我国道路交通事故发展趋势研究[J].交通科技与经济，2019,21（03）：

29-32+37.

[5] Forsman P M , Vila B J , Short R A , et al. Efficient driver drowsiness detection at

moderate level of drowsiness[J]. Accident Analysis & Prevention, 2013, 50:341-350.

[6] Zuojin L , Shengbo L , Renjie L , et al. Online Detection of Driver Fatigue Using Steering

Wheel Angles for Real Driving Conditions[J].Sensors, 2017, 17(3):495.

[7] 沙春发,李瑞,张明明.基于方向盘握力的疲劳驾驶检测研究[J].科学技术与工

程,2016,16(30):299-304.

[8] D. Sandberg, T. Akerstedt, A. Anund, G. Kecklund and M. Wahde, Detecting Driver

Sleepiness Using Optimized Nonlinear Combinations of Sleepiness Indicators [J]. IEEE

Transactions on Intelligent Transportation Systems, vol. 12, no. 1, pp. 97-108, March 2011.

[9] Xu Yuhong et al. Real-Time Monitoring System of Automobile Driver Status and

Intelligent Fatigue Warning Based on Triboelectric Nanogenerator.[J]. ACS nano, 2021.

[10] 郭思强,滕靖,郭旭健,印天梦,陈华庆,侯健. 基于车辆行驶数据的营运车驾驶员疲

劳驾驶监控研究[A]. 中国智能交通协会.2014 第九届中国智能交通年会优秀论文集[C].

中国智能交通协会:中国智能交通协会,2014:12.

[11] 屈肖蕾. 基于转向操作和车辆状态的疲劳驾驶检测方法研究[D].清华大学,2012.

[12] S. Edward Jero et al. Muscle fatigue analysis in isometric contractions using geometric

features of surface electromyography signals[J]. Biomedical Signal Processing and Control,

2021, 68.

[13] 祝荣欣. 基于生理信号的联合收获机驾驶疲劳检测与评价[D].东北农业大学,2016.

[14] 叶成文. 基于心电肌电信号的汽车驾驶疲劳研究[D].合肥工业大学,2018.

[15] Sibsambhu Kar,Mayank Bhagat,Aurobinda Routray. EEG signal analysis for the

assessment and quantification of driver’s fatigue[J]. Transportation Research Part F:

Psychology and Behaviour,2010,13(5).

43

基于多特征的驾驶员疲劳驾驶识别

[16] Schneider Lisa et al. Effects of a seat-integrated mobilization system during passive

driver fatigue[J]. Accident Analysis & Prevention, 2021, 150 : 105883-105885.

[17] 成怡波,肖超,龙思宇,黄彬芯,姚文坡,王君策,卢竞. 一种基于脑波音乐的疲劳检

测方法及系统[P]. 四川省：CN112545518A,2021-03-26.

[18] 邱达锋.一种基于多模态融合神经网络对疲劳度检测的方法[J].现代计算

机,2020(35):32-36+42.

[19] 仇峰. 基于深度滤波网络的疲劳脑电信号多层次建模与学习[A]. 中国自动化学

会.2020 中国自动化大会(CAC2020）论文集[C].中国自动化学会:中国自动化学

会,2020:6.

[20] Rao Songhui et al. Application of Ensemble Learning in EEG Signal Analysis of Fatigue

Driving[J]. Journal of Physics: Conference Series, 2021, 1744(4) : 042193-042196.

[21] 张学军,万东胜,孙知信.基于 LMD 和模糊熵融合 CSP 的脑电信号特征提取方法[J].

仪器仪表学报,2020,41(08):226-234.

[22] Tuncer Turker and Dogan Sengul and Subasi Abdulhamit. EEG-based driving fatigue

detECTion using multilevel feature extraction and iterative hybrid feature selection[J].

Biomedical Signal Processing and Control, 2021, 68.

[23] Ren Ziwu et al. EEG-Based Driving Fatigue Detection Using a Two-Level Learning

Hierarchy Radial Basis Function&13;[J]. Frontiers in Neurorobotics, 2021.

[24]Liu Yisi et al. Inter-subject transfer learning for EEG-based mental fatigue recognition[J].

Advanced Engineering Informatics, 2020, 46 : 101157-101160.

[25] 李鑫,张晖,吴超仲,张琦,孙一帆.基于脉搏波特征融合的驾驶疲劳检测方法[J].中

国公路学报,2020,33(06):168-181.

[26] 朱龙飞,王鹏程.基于深度信念网络的脑电信号疲劳检测系统[J].计算机测量与控

制,2019,27(05):26-29+34.

[27] Salvati Luca et al. On-Road Detection of Driver Fatigue and Drowsiness during

Medium-Distance Journeys[J]. Entropy, 2021, 23(2) : 135-135.

[28] Chen Long et al. Driver Fatigue Detection via Differential Evolution Extreme Learning

Machine Technique[J]. Electronics, 2020, 9(11) : 1850-1850.

[29] 焦昆,李增勇,陈铭,王成焘.驾驶精神疲劳的心率变异性和血压变异性综合效应分

析[J].生物医学工程学杂志,2005(02):343-346.

[30] 陈瑜,徐军莉.疲劳检测中眼动指标参数的分析研究[J].科技风，2020（24）:190-191.
44

参考文献

[31] 旷文腾,毛宽诚,黄家才,李海彬.基于高斯眼白模型的疲劳驾驶检测[J].中国图象图

形学报,2016,21(11):1515-1522.

[32] 张波,王文军,张伟,李升波,成波.驾驶人眼睛局部区域定位算法[J].清华大学学报

(自然科学版）,2014,54(06):756-762.

[33] Li Xingxing et al. Real-Time Detection of Fatigue Driving Based on Face Recognition[J].

Journal of Physics: Conference Series, 2021, 1802(2): 022044-022045.

[34] 杜勇. 基于面部信息的驾驶者疲劳状态分类方法研究[D].哈尔滨工业大学,2012.

[35] 王霞,仝美娇,王蒙军.基于嘴部内轮廓特征的疲劳检测[J].科学技术与工

程,2016,16(26):240-244.

[36] 潘剑凯,柳政卿,王秋成.基于眼部自商图—梯度图共生矩阵的疲劳驾驶检测[J].中

国图象图形学报,2021,26(01):154-164.

[37] Lei Zhao, Zengcai Wang, Guoxin Zhang, et al. Eye state recognition based on deep

integrated neural network and transfer learning[J].Multimedia Tools and Applications, 2018,

77(15):19415-19438.

[38] 潘志庚,刘荣飞,张明敏.基于模糊综合评价的疲劳驾驶检测算法研究[J].软件学

报,2019,30(10):2954-2963.

[39] Ngxande M , Tapamo J R , Burke M . Bias Remediation in Driver Drowsiness Detection

Systems Using Generative Adversarial Networks[J]. IEEE Access, 2020, PP(99):1-1.

[40]Ed-Doughmi, Younes; Idrissi, Najlae; Hbali, Youssef. Real-Time System for Driver Fatig

ue Detection Based on a Recurrent Neuronal Network.Journal of Imaging.2020,6(3).

[41] 胡习之,黄冰瑜.基于面部特征分析的疲劳驾驶检测方法[J].科学技术与工程，

2021,21(04):1629-1636.

[42] 撒灵,于顺权,梁文豪.基于面部特征的疲劳驾驶检测系统的设计[J].科技风，

2019(01):1.

[43]Shijun Wang and Ge Chen*. Driver Fatigue State Recognition Based on Deep Learning[J].

International Journal of Computational and Engineering, 2020, 5(4)

[44] 程文冬,魏庆媛.非约束条件下驾驶人眼睛检测与跟踪方法研究[J].西安工业大学学

报,2019,39(02):203-210.

[45] 闫保中,王晨宇,王帅帅.基于人眼特征的疲劳驾驶检测技术研究[J].应用科

技,2020,47(01):47-54.

[46] 范林龙,李毅,张笑钦,陈舒. 一种基于无监督学习的人脸轮廓特征风格化生成方法

45

[P]. 浙江省：CN111667400B,2021-03-30.

基于多特征的驾驶员疲劳驾驶识别

[47] 王龙,刘辉,王彬,李鹏举.结合肤色模型和卷积神经网络的手势识别方法[J].计算

机工程与应用,2017,53(06):209-214.

[48] 兰胜坤.基于 Adaboost 算法的人脸检测实现[J].电脑与信息技术,2021,29(02):16-19.

[49] 郭晋秀,张月芳,邓红霞,李海芳.融合分区与 Canny 泛函的水平集对猴脑提取的研

究[J].计算机工程与科学,2020,42(12):2193-2198.

[50]Pirnar Žan and Finžgar Miha and Podržaj Primož. Performance Evaluation of PPG

Approaches with and without the Region-of-Interest Localization Step[J]. Applied Sciences,

2021, 11(8) : 3467-3467

[51]Cao Wenxuan et al. Use of unmanned aerial vehicle imagery and a hybrid algorithm

combining a watershed algorithm and adaptive threshold segmentation to extract wheat

lodging[J]. Physics and Chemistry of the Earth, 2021, 123.

[52] 戴礼青. 人脸的几何特征分析与美丽分数计算[D].南京理工大学,2014.

[53] 钟千里. 图像中人脸自动替换技术的研究与实现[D].电子科技大学,2016.

[54] 田原嫄,姚萌萌,潘敏凯,郭海涛.基于YCbCr肤色检测与AdaBoost联级算法的嘴部

特征定位[J].计算机应用研究,2017,34(03):933-935.

[55] 张 华 坤 , 王 敏 , 罗 开 , 郑 之 峻, 江 嵬 . 三 庭 五 眼 的 最 佳 定 点 探 索 [J]. 医 学 与 哲 学

(B),2017,38(05):64-69.

[56] 周壮壮,陈艳,唐苏,龚桂玉,周丹.基于 PERCLOS 的眼部疲劳检测系统研究[J].集成

电路应用,2021,38(02):48-49.

[57] 马发民,吴红乐,张林,王锦彪.基于 BP 神经网络的疲劳判定[J].计算机与数字工

程,2017,45(06):1187-1193.

[58] 方志刚,叶伟中.多生物特征识别技术综述[J].计算机工程，2003(09):140-142.

46

致谢

致谢

时光荏苒，三年的研究生生活就快要结束，回首三年的研究生生活，百感交集，心

中充盈最多的仍是感激。这三年中，我了解到了很多计算机视觉领域的知识，学会了用

高效的思维方法去做研究，而且光荣地加入了中国共产党，这一切都离不开我的师长和

同学们的帮助。因此在论文完成的最后，想要留一块空白出来，对曾经给予我耐心指导

和帮助的导师同学表示感谢，谢谢你们。

首先感谢我的导师陈立潮教授对我生活和学业上无微不至的关心和帮助，陈老师品

德高尚、待人和善、治学严谨、学识渊博，在我三年多的研究生学习期间，他不仅传授

了我做学问的技巧，还传授了我做人的准则，这些必将让我受益终身。在课题进行过程

中，陈老师组织我们每周开一次组会，这个良好的习惯一直从开学到课题完成。在组会

期间，陈老师耐心听取我们的阶段汇报，及时提出修订方案，保证了课题的顺利进行。

值此课题完结之时，再次向陈老师致以我最真诚的谢意。在研三的上学期，很有幸担任

了陈老师《C语言程序设计》的助教，在与老师共事的日子里，陈老师教会了我很多专

业知识以及和学生们相处的方式。陈老师对我各方面的教导必将激励着我在今后的人生

道路上奋勇向前。在此，我要再次向陈老师表示我最真挚的感谢。

其次，感谢课题组的潘理虎、张睿等老师在相关理论知识的指导，在课题和论文撰

写时的意见，在设备方面给我的帮助。同时感谢实验室的小伙伴们，感谢你们无微不至

的帮助和关心。最感谢的我们陈老师的小组的同学们。他们是朝昕、徐秀芝、张倩茹、

闫耀东，他们使我在研究生期间收获了知识和快乐。同时也感谢我的家人们对我无微不

至的关怀，感谢父母在我的学习生涯中所给予的支持和包容。

最后，我要向百忙之中参与审阅、评议本论文各位老师、向参与本人论文答辩的各

位老师表示由衷地感谢！人生的每个阶段都值得好好珍惜，这段美好岁月，因为有你们

的关心和帮助，我很幸福。我会更加勤奋学习、认真研究，我会努力做得更好，我想这

也是我能给你们的最好的回报吧。把最美好的祝福献给你们，愿永远健康、快乐！

47

基于多特征的驾驶员疲劳驾驶识别

48

攻读学位期间的工作与成果

攻读学位期间的工作与成果

1. 陈立潮，王冠男.基于面部多特征的驾驶员疲劳状态检测[J].计算机与数字工程，

2020 年 12 月录用。（与论文内容三四五章相关）

2. 陈立潮，王冠男，高强.基于 JAVA 的在线考试系统 V1.0,登记号：2020SR0127028.

49

