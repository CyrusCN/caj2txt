专 业 硕 士 学 位 论 文  

Gabor 多尺度融合特征在疲劳驾驶检测中的
应用 

王崴绪 

指   导   教   师 ： 陈 勇     副 教 授  

学   习   形   式 ： 全 日 制  

专业学位类别：工程硕士 

专业学位领域：计算机技术 

二〇二〇年五月 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
重庆师范大学硕士学位论文                                       

Gabor 多尺度融合特征在疲劳驾驶检测中的
应用 

硕士研究生：王崴绪 

指导教师：陈  勇    副教授 

学科专业：计算机技术 

所在学院：计算机与信息科学学院 

重庆师范大学 

二〇二〇年五月 

 
 
 
 
 
 
 
 
 
 
                                                                         
 
 
 
A Thesis Submitted to Chongqing Normal University in 

Partial Fulfillment of the Requirements for the Degree of 

Master 

Application of Gabor multiscale fusion 
feature in fatigue driving detection 

Candidate：Wang Wei Xu 

Supervisor：Associate Professor Chen Yong 

Major：Computer Technology 

College：College of computer and Information Science 

Chongqing Normal University 

May，2020 

 
                                                         
 
 
 
 
 
 
 
 
 
重庆师范大学硕士学位论文                                                                                                  中文摘要 

Gabor 多尺度融合特征在疲劳驾驶检测中的应用 

摘    要 

随着汽车数量的增加和人们生活节奏的加快，因驾驶者疲劳而引发的交通事

故屡屡发生。通过提前预测驾驶员的疲劳状态，从而避免交通事故的发生，己经成

为目前在疲劳驾驶检测技术研究领域中的热点与难点。面部表情识别及其分析是

计算机视觉应用和模式识别领域中的一项有吸引力的研究。面部表情比其他任何

部位的表达都要丰富。当人类表达相应的感情时，面部表情随即产生变化，脸部通

过肌肉做出微观表达，表达情绪最丰富的区域分别在眼部、嘴部、以及脸颊部分，

当人脸处于疲劳时，眼睛呈微闭状态，眼睛无神，眉毛呈向下状态，脸颊肌肉呈放

松状态，嘴部呈微闭状态。通过以上特征可以判断目前驾驶员是否处在疲劳状态。

本文主要工作内容如下： 

(1)提出了通过面部表情 Gabor 特征融合的疲劳识别方法，为了充分捕捉面部

情绪信息，本文对感兴趣区域采用基于 Gabor 多方向特征融合与分块直方图方法

对人脸进行特征提取，Gabor 滤波对人脸空间具有良好的表达效果，融合特征能有

效地降低原始 Gabor 特征数据间的冗余，还可以对感兴趣区域进行多尺度分析，分

块直方图则加强全局特征描述，通过以上方法保证决策性信息不会丢失的同时将

冗余的数据剔除，增加了处理效率以及准确率。 

(2)制定了新的综合疲劳判定策略，驾驶员在驾驶过程中会根据轻度疲劳、中

度疲劳、重度疲劳产生不同的生理机制反应。驾驶员在不同的疲劳程度中，大脑会

产生相应的抵抗力，进入新的亢奋周期，系统根据驾驶员在驾驶过程中产生的其他

基本表情以及疲劳表情的占比率进行疲劳判断。该策略结合疲劳表情识别可以有

效防止疲劳驾驶。 

(3)设计了基于面部表情的疲劳预警软件。设计了图像输入模块，视频图像预

处理模块，图像特征提取模块，图像表情分类模块，疲劳分析模块。通过以上模块

完成驾驶视频模拟仿真的疲劳分析检测功能。本系统通过 PyCharm 平台利用

Python 语言设计实现。 

关键词：人脸表情识别，疲劳驾驶，Gabor 特征融合，疲劳策略

I 

 
 
 
 
 
重庆师范大学硕士学位论文                                                                                                  英文摘要 

Application of Gabor multiscale fusion feature in fatigue 

driving detection   

ABSTRACT     

With the increase of the number of cars and the acceleration of the pace of people's 

life, traffic accidents caused by driver fatigue occur frequently. It has become a hot and 

difficult point in the field of fatigue driving detection technology to predict the driver's 

fatigue state in advance so as to avoid traffic accidents. Facial expression recognition and 

its analysis is an attractive research in the field of computer vision application and pattern 

recognition. Facial expression is more abundant than any other part. When human beings 

express the corresponding feelings, the facial expression changes immediately. The face 

makes micro expression through muscles. The areas that express the most emotion are 

the eyes, mouth, and cheek. When the face is tired, the eyes are slightly closed, the eyes 

are mindless, the eyebrows are downward, the cheek muscles are relaxed, and the mouth 

is slightly closed. The above characteristics can be used to judge whether the driver is in 

fatigue state. 

(1)A fatigue recognition method based on Gabor feature fusion of facial expression 

is proposed. In order to fully capture facial emotion information, this paper uses Gabor 

multi-directional  feature  fusion  and  block  histogram  method  to  extract  facial  features 

from the region of interest. Gabor filtering has a good expression effect on the face space. 

The fusion features  can  effectively reduce the redundancy between the original Gabor 

feature data, and can also the multi-scale analysis of the region of interest is carried out, 

and the block histogram strengthens the description of global features. The above methods 

ensure that the decision-making information will not be lost and the redundant data will 

be eliminated, which increases the processing efficiency and accuracy. 

(2)A new comprehensive fatigue determination strategy has been formulated,  and 

drivers will have different physiological mechanism responses according to mild fatigue, 

moderate  fatigue,  and  severe  fatigue  during  driving.  When  the  driver  is  in  different 

degrees of fatigue, the brain will produce corresponding resistance and enter a new cycle 

of excitement. The system makes fatigue judgments based on the other basic expressions 

of the driver during the driving process and the proportion of fatigue expressions. This 

II 

 
                                                               
                                                                                         
                                                     
重庆师范大学硕士学位论文                                                                                                  英文摘要 

strategy  combined  with  fatigue  expression  recognition  can  effectively  prevent  fatigue 

driving. 

(3)Fatigue warning software based on facial expression is designed. An image input 

module,  a  video  image  preprocessing  module,  an  image  feature  extraction  module,  an 

image  expression  classification  module,  and  a  fatigue  analysis  module  are  designed. 

Complete the fatigue analysis and detection function of driving video simulation through 

the  above  modules.This  system  is  designed  and  implemented  through  the  PyCharm 

platform using Python language. 

Keywords：Facial expression recognition, Fatigue driving, Gabor Feature fusion, Fatigue 

strategy                   

III 

 
 
重庆师范大学硕士学位论文                                                                                                          目录 

目  录 

中文摘要 .......................................................................................................................................... I 
英文摘要 ........................................................................................................................................ II 
1  绪论 ............................................................................................................................................... 1 

1.1  研究背景及意义 ................................................................................................................... 1 

1.2  国内外研究现状 ................................................................................................................... 2 

1.2.1  国外研究现状 ............................................................................................................ 2 

1.2.2  国内研究现状 ............................................................................................................ 2 

1.3  研究的主要工作和安排 ....................................................................................................... 3 

1.4  论文研究框架 ....................................................................................................................... 4 
2  表情识别框架 ......................................................................................................................... 5 

2.1  表情识别基本流程 ............................................................................................................... 5 

2.2  人脸表情数据库 ................................................................................................................... 6 

2.3  特征识别算法 ....................................................................................................................... 6 

2.3.1 LBP 特征提取算法 ..................................................................................................... 6 

2.3.2 Gabor 小波特征提取 .................................................................................................. 7 

2.4  基于 Gabor 特征融合与方块直方图的特征提取算法 ...................................................... 7 

2.5  表情特征降维 ....................................................................................................................... 8 

2.6  表情分类器构建 ................................................................................................................... 9 

2.6.1  随机森林特性 ............................................................................................................ 9 

2.6.2 SVM（支持向量机）特性 ....................................................................................... 10 

2.7  本章小结 ............................................................................................................................. 11 
3  图像预处理及基于 Gabor 尺度方向融合的特征提取方法 ..................... 12 

3.1  人脸检测与预处理 ............................................................................................................. 12 

3.1.1  人脸检测 .................................................................................................................. 12 

3.1.2  图像预处理 .............................................................................................................. 12 

3.1.3  视频图像预处理 ...................................................................................................... 15 

3.2 Gabor 多尺度融合特征提取 .............................................................................................. 16 

3.2.1  人脸多尺度多方向特征 .......................................................................................... 17 

3.2.2  多尺度融合规则 ...................................................................................................... 18 

3.3  特征分块直方图描述 ......................................................................................................... 20 

3.4 PCA 主成分分析降维 ......................................................................................................... 21 

IV 

 
 
 
重庆师范大学硕士学位论文                                                                                                          目录 

3.5  算法可行性分析 ................................................................................................................. 22 

3.6  本章小结 ............................................................................................................................. 22 
4  表情分类与疲劳判定逻辑 ............................................................................................ 23 

4.1  随机森林 ............................................................................................................................. 23 

4.1.1  随机森林基本原理 .................................................................................................. 23 

4.1.2  决策树特征选择 ...................................................................................................... 24 

4.1.3  随机森林分类结果 .................................................................................................. 26 

4.2 SVM(支持向量机) ............................................................................................................... 27 

4.2.1 SVM 基本原理 .......................................................................................................... 27 

4.2.2  核函数 ...................................................................................................................... 29 

4.2.3  松弛变量 .................................................................................................................. 29 

4.2.2 SVM 分类结果 .......................................................................................................... 30 

4.3  随机森林与 SVM 结果对比分析 ...................................................................................... 31 

4.4  疲劳状态检测与判定逻辑 ................................................................................................. 32 

4.4.1  驾驶员驾驶疲劳的产生机理分析 .......................................................................... 32 

4.4.2  驾驶员驾驶疲劳的影响因素 .................................................................................. 33 

4.4.3  疲劳判定准则 .......................................................................................................... 34 

4.5  本章小结 ............................................................................................................................. 35 
5  疲劳分析预警软件 ............................................................................................................ 36 

5.1  软件组成部分 ..................................................................................................................... 36 

5.2  软件流程框架 ..................................................................................................................... 37 

5.3  软件界面设计 ..................................................................................................................... 38 

5.3.1  文件输入模块设计 .................................................................................................. 39 

5.3.2  预处理模块设计 ...................................................................................................... 41 

5.3.3  特征提取模块设计 .................................................................................................. 42 

5.3.4  表情分类模块设计 .................................................................................................. 42 

5.3.5  疲劳分析模块设计 .................................................................................................. 43 

5.4  软件适用性 ......................................................................................................................... 44 

5.5  本章小结 ............................................................................................................................. 45 
6  总结与展望 ............................................................................................................................ 46 

6.1 全文总结 .............................................................................................................................. 46 

6.2 展望 ...................................................................................................................................... 46 
参考文献 ....................................................................................................................................... 48 
附录 A：作者攻读硕士学位期间发表论文及科研情况 .................................. 51 

V 

 
重庆师范大学硕士学位论文                                                                                                          目录 

致 谢 ............................................................................................................................................... 52 

VI 

 
 
重庆师范大学硕士学位论文                                                                                                      1  绪论 

1  绪论 

1.1  研究背景及意义 

随着汽车数量的增加和人们生活节奏的加快，因驾驶者疲劳而引发的交通事

故屡屡发生[1]。我们应该认识到，疲劳驾驶所带来的严重后果并不亚于酒驾，它是

交通安全的巨大隐患，严重威胁着社会财产与生命安全。所以研究可靠且有效的疲

劳驾驶检测技术，能够提前预测和判断出驾驶者的疲劳状态，及时预警，并让车辆

自动减速，做到防患于未然，从而可以避免交通事故的发生[2]。 

研究显示，睡眠不足对驾驶员的影响近似于酒后驾车，存在很大的安全隐患。

根据 2014-2018 年我国道路交通事故统计数据可知。仅 2018 年我国因疲劳驾驶而
导致的交通事故死亡人数就超过 1000 人，造成的经济损失达到近 5000 万元[3]。驾

驶员疲劳与发生交通事故的 Pearson 相关性达到 99%。美国国家公路交通安全管理

局统计，美国每年因瞌睡导致约 10 万起交通事故，造成人身伤害的交通事故占 71%，

其中有 1500 起事故直接导致死亡。据德国保险公司统计，25%左右的交通事故是

因疲劳驾驶引起的。法国警察总署统计  20.6%的交通事故是由瞌睡导致的。一项针

对美国 1.03 亿人的调查结果显示，有超过三分之一的驾驶者在开车过程中出现过
打瞌睡的现象[4]。 

导致驾驶员出现疲劳现象的主要因素有：睡眠质量差、长时间开车、服用了带

有镇痛或安眠的药物、饮用了含有酒精成分的饮料等。这些因素均会引起驾驶员瞌

睡困乏，使身体的感知机能弱化，出现视线模糊、注意范围变小、反应时间明显延

长、动作不协调等现象[5]。驾驶者进入疲劳状态时，动作迟缓、反应不及时，尤其

是在进入重度疲劳时，驾驶员甚至会忘记操控车辆，非常容易发生撞击、追尾等交

通事故，后果不堪设想[6]。疲劳驾驶不仅会造成一定的经济财产损失，威胁社会公

共交通安全，更会导致车内人员伤亡，危害自身与他人的生命安全，造成巨大的精

神伤害。 

当驾驶员感到疲劳时，单纯依靠功能饮料、吹冷气或者大声播放音乐、同伴随

行聊天和监督等方式来克服疲劳的效果并不显著[7]。通过提前预测驾驶员的疲劳状

态，从而避免交通事故的发生，己经成为目前在疲劳驾驶检测技术研究领域中的热

点与难点[8]。由于根据脑电、心电和脉搏等生理信号监测疲劳状态需在驾驶员身上

配备接触装置，这会妨碍驾驶员的操作。而基于车辆行驶轨迹的疲劳检测方法对道

路标线的要求较高。所以考虑非接触式的方法，通过研究数字视频图像处理与识别

技术，利用人脸表情信息检测驾驶员的疲劳状态具有一定的可行性[9]。 

1 

 
 
 
 
重庆师范大学硕士学位论文                                                                                                      1  绪论 

1.2  国内外研究现状 

1.2.1  国外研究现状 

1996 年美国科学家 Knipling 和 Kanianthra 等通过测量眼睛的开闭状态及其运

动和眼睛的一些生理学表现形态来判断驾驶员的疲劳状态，同时也认为通过眼睛

的状态来判断疲劳状态是非常有效的[10]。 

美国 Attention  Technologies 公司设计了一款根据驾驶员的眼部特征监测其疲

劳状况并预警的产品(DD850 Driver Fatigue Monitor)。它通过使用红外的传感器采

集驾驶员眼部信息，并根据驾驶员眼部的状态计算 PERCLOS 参数作为疲劳报警

依据，公司生产的整个设备可以安装在车子的仪表盘上，并且其预警的方式和敏感

度可以根据需要调整[11]。 

2004 年，欧盟启动了一项被称为“AWAKE”的驾驶行为综合监控系统，该系统

通过检测驾驶员的眼睛状态、方向盘的操作以及车道线偏离的情况，并研究各种特

征与疲劳之间的联系，根据疲劳等级采用不同的方式提醒驾驶员[12]。 

Zhang 等基于 RBF 神经网络进行眼部的特征识别，通过眨眼频率与 PERCLOS
参数去对驾驶员进行疲劳分级，但此方法的计算量较大[13]。Sun 等提  取眼睛的边

缘信息，再采用 Hough 变换来检测眼球，观察驾驶员的眼睛闭合状态，此方法预
处理较复杂，计算较大，不能满足实时性[14]。Ralph 根据眼睛的状态和头部的位置

计算三个能够代表驾驶员疲劳状态的疲劳参数，再利用 SVM 训练一个分类器，判
断驾驶员是否需要疲劳预警[15]。Mandalapu 利用 SVM 训练一个嘴部状态判别的分

类器，根据嘴部信息判断驾驶员的疲劳状态，此方法由于嘴部状态个体差异性较大，

因此判别误差较大且鲁棒性不够[16]。Luis  M 采用有限状态机对眼睛的各种状态之

间的联系建模，计算 PERCLOS、眨眼频率等参数融合决策出驾驶员的疲劳状态。 

1.2.2  国内研究现状 

2002 年，浙江大学研制了一个防驾驶员瞌睡的装置，根据灰度积分投影的方

法快速确定人眼的位置。首先利用图像在垂直方向上的灰度投影确定人脸的边界，

然后根据水平方向的灰度投影曲线定位人眼，最后利用阈值分割及边缘检测判断

眼睛的开闭状态，通过统计一段时间内驾驶员眼睛的闭合时间、闭合的频率等参数，

来确定驾驶员当前的疲劳状态[17]。 

重庆大学导航与制导实验室开发了  “高速公路智能型汽车行驶主动安全预警

系统”，它主要应用了模式识别、信息融合等技术，为驾驶员提供一种辅助驾驶的

功能，并且该系统通过了国家重型质量监督检测中心的测试与鉴定，已经可以达到

实际应用的阶段，并且效果处于国际优先水平[18]。 

2 

 
 
 
重庆师范大学硕士学位论文                                                                                                      1  绪论 

2017 年，吉林大学邹昕彤毕业生发表了基于表情与头部状态识别的疲劳驾驶
检测算法的研究论文[19]，该文主要针对眼睛特征，嘴部张开角度，头部运动状态等

进行特征分析，设定疲劳等级，对特征进行分类最终确定疲劳程度。 

但是，目前国内外已知的，通过数字视频图像处理与识别技术去分析人脸表情

和头部运动信息检测驶员的疲劳状态有一定的不足之处[20]： 

(1)眼部特征信息易缺失 

国内外研究面部表情眼睛的特征分析占有十分重要的比重，在当代社会中，佩

戴眼睛比例的人群是十分庞大的[21]，对这类人进行面部表情分析时，眼睛的特征信

息会受到干扰，导致信息不准确。 

(2)头部运动信息具有滞后性 

在头部运动信息的检测中，因疲劳导致的瞌睡点头现象是重要的疲劳检测状

态，但是当瞌睡点头现象出现时，驾驶员已经进入严重疲劳状态，随时都有可能导

致车祸的发生。当驾驶员进入严重疲劳状态时，会有间接性睡眠产生，持续时间约

为 3 秒左右，会产生下意识的操作行为[22]。应当在检测到该状态之前进行疲劳预

警，所以头部运动信息具有滞后性。 

(3)数据处理不同步 

为了保持测试的准确性，目前的使用方法对特征点的提取较复杂，导致疲劳检

测中大量的图片信息导致维数巨大，处理速度慢，容易造成传输信息与实际情况的

延迟性，延迟性导致信息不能及时上传，无法实时反应驾驶员的疲劳特征，导致预

警延迟，容易造成事故发生[23]。 

1.3  研究的主要工作和安排 

疲劳驾驶表情的识别经过不断的发展和进步，取得了许多的进步成果。但是仍

存在可以进步的空间。 

(1)人脸表情特征提取的合理性。目前研究人脸表情特征主要分布在眼睛和嘴

部区域，忽视了人脸其他部分的特征。造成了特征提取不完全，降低了人脸表情的

识别率。 

(2)人脸数据集的制定。目前人脸的数据集形式为人脸图像，本实验需要通过

眼部、嘴部、脸颊部分进行特征提取。因此，需要手动提取出感兴趣区域并存储为

数据集。通过人脸比例进行特征部位提取。采用的人脸数据集为 CK+及疲劳数据

集，该数据集存有人脸的 6 种基本表情以及疲劳表情：由愤怒（anger）、高兴

(happiness)、惊讶(surprise)、厌恶(disgust)、中立(normal)和恐惧(fear)、疲劳(fatigue)

组成。 

(3)实验实景化。将实验与实景相结合，实景中可能会出现光照、不相关物体干

3 

 
 
重庆师范大学硕士学位论文                                                                                                      1  绪论 

扰等复杂的场景可能会导致识别率下降。因此，应增加表情识别的鲁棒性。 

(4)疲劳识别预警应用软件的设计。软件应具备识别一段视频内人脸表情的变

化，对符合疲劳特征的人脸进行疲劳统计，当在一定时间内处于疲劳的时间过长，

需要进行预警提醒驾驶员处于疲劳驾驶状态。 

1.4  论文研究框架 

表情识别主要分为 4 个过程:确定人脸区域、预处理、特征提取、表情分类。

首先，使用 Face_recognition 算法划分人脸区域，随后对人脸进行灰度化处理，去

噪声。采用 Gabor 多方向特征融合与分块直方图的人脸表情识别方法进行特征提

取，通过 PCA(主成分分析)进行降维，选择前 13 个主成分，最后采用随机森林进

行分类。具体的章节安排如下: 

第 1 章主要介绍了研究背景及意义，以及国内外研究现状，人脸表情的当前状

况，本文的主要研究工作等。 

第 2 章阐述了表情识别分类的基础，讨论了本设计的工作流程，介绍了相关的

研究方法，预处理主要根据感兴趣区域的划分进行相关设计讨论，采用比例法提取

特征区域。特征提取采用 Gabor 多方向特征融合与分块直方图的人脸表情识别方

法进行特征提取，对特征进行 PCA 降维，利用随机森林进行表情分类。 

第 3 章详细阐述了 Gabor 多方向特征融合与分块直方图的人脸表情识别方法，

通过采用分块直方图的方法，即保持了 Gabor 的局部细节，又保持了一定的结构特

性，经过实验对比普通的 Gabor 滤波方法识别率显著提升。 

第 4 章主要介绍了 PCA 降维后随机森林分类的表情识别方法。首先介绍了降

维的重要性，在经过 Gabor 多方向特征融合与分块直方图的处理后，维度过高。采

用 PCA 主成分分析法对特征进行降维，选择前 13 个主成分。最后使用随机森林进

行分类。经过实验验证对比 PCA+随机森林构造的分类器提升了识别率。 

第 5 章主要设计表情识别分类的界面软件。设计了输入图片进行分类识别的

交互界面，通过输入人脸图片，判断人脸表情，并将表情结果实时显示在界面上。

测试了不同表情下的表情分类的成功率。 

4 

 
 
重庆师范大学硕士学位论文                                                                                      2  表情识别框架 

2  表情识别框架 

本章主要介绍疲劳预警软件的整体框架以及工作流程、相关方法以及应用的

人脸数据库。在本实验中，采取了多个特征提取以及分类方法比较，将实验效果最

佳化。因此，本章将简单介绍实验中应用到的特征提取与分类识别的相关算法。 

2.1  表情识别基本流程 

人脸表情识别的主要流程分别为：从图像中识别人脸感兴趣区域并获取、图像

预处理、用特征提取算法提取特征、最后通过提取到的特征进行表情分类。如图 2-

1 所示： 

图 2-1  表情识别框架 

(1)人脸检测：含有人脸的图像通过已有的 CK+数据集和疲劳数据集获得，将

数据集通过电脑处理，检测存在人脸的区域，获得含有人脸图像的数据，划定人脸

区域生成新的人脸图片，应考虑并设计符合复杂环境要求的人脸检测应用。 

(2)图像预处理：获取人脸图像后，将人脸图像进行去噪声、灰度化、尺寸归一

化等。为接下来的特征提取做准备。 

(3)特征提取：将经过预处理的图片以数值化的形式进行存储，利用特征提取

算法进行运算，有效的特征提取将影响最终的识别率，预处理阶段已经将存在大量

特征的区域划分完成，因此有利于最终有效特征的提取。 

5 

 
 
 
 
 
重庆师范大学硕士学位论文                                                                                      2  表情识别框架 

(4)特征分类：对上述提取的特征进行分类，选取和设置一个合理的分类规则

有利于最终将图片分类到正确标签上，尽可能降低错误率。 

2.2  人脸表情数据库 

本文采用 CK+人脸表情数据库、FER2013 人脸数据库和疲劳表情数据库进行

实验测试，CK+人脸表情数据库发布于 2010 年，在  Cohn-Kanade  Dataset  的基础
上扩展得来。含有五种不同的表情，分别是生气、恐惧、厌恶、开心、惊讶 24]。本

文取得 FER2013 中的中立表情进行应用，开心图片数量为 207 张，恐惧图片数量

为 108 张，厌恶图片数量为 266 张，惊讶图片数量为 249 张，生气图片数量为 270

张。疲劳表情数据库由网上部分疲劳数据库组成，模拟人类浅度疲劳状态，疲劳表

情数量为 188 张。如图 2-2 为综合表情数据库。 

图 2-2 CK+表情数据库 

2.3  特征识别算法 

在表情识别的实现中，合理的特征提取算法与分类策略相结合是影响最终结

果的关键。本设计将采用相关传统方法进行表情识别比较。以下依次介绍本实验过

程中应用过的特征提取算法。 

2.3.1 LBP 特征提取算法 

LBP 通常用来描述图像中局部的特征信息，在计算机视觉系统开发中，LBP 特

征提取的优良特性使其得到了广泛的应用，LBP 图与灰度图像很相似，只是将灰
度值转为 LBP 值[25]。   

将灰度化的图像应用在 LBP 算法中，在图像中定义一个 3*3 像素的小区域，

在这个九宫格中，中心的像素将是该区域的一个阈值，周围像素依次与其进行比较，

当周围像素的值大于该中心像素的灰度值时，被标记为 1，当周围像素的值小于该

中心像素的灰度值时，被标记为 0。周围将会有 8 个值进行比较，将得到的 0-1 值

6 

 
 
 
 
 
重庆师范大学硕士学位论文                                                                                      2  表情识别框架 

进行二进制处理[26]。二进制后的值就是该中心像素的 LBP 值。该 LBP 值因此反映

了周围的纹理特征信息。LBP 特征提取过程如图 2-3 所示。 

目前经过改进的 LBP 算法也有很多，包括圆形邻域的 LBP 算子、LBP 等价模

图 2-3 LBP 特征提取 

式、MB-LBP 等。 

2.3.2 Gabor 小波特征提取 

Gabor 小波相似于人类的视觉神经系统，在视觉神经系统中类似于简单细胞的

视觉刺激。Gabor 函数是一个用高斯函数调制的复正弦函数,能够在给定区域内提

取出局部的频域特征。同时，Gabor 小波对于图像中的边缘信息非常敏感，能够提
供良好的方向选择和尺度选择特性[27]。在图像中的干扰信息中，光照影响是其中的

重要因素之一，但 Gabor 小波对于光照变化不敏感，对光照的变化有良好的适应
性。因此，Gabor 小波被广泛的应用在视觉信息理解中，取得了很好的效果[28]。 

Gabor 滤波后的效果图如下图 2-4（每行是同一尺度，每列是同一方向）。 

图 2-4 Gabor 人脸特征提取 

2.4  基于 Gabor 特征融合与方块直方图的特征提取算法 

在上一小节中，简要介绍了目前人脸特征提取的实用方法，为了使人脸特征得

到充分地提取，根据 Gabor 滤波与人脑视觉神经相似的特点，本文选择 Gabor 小

波特征提取，同时结合其他方法，提高特征提取效果。 

在经过 Gabor 滤波的处理后，会得出 5 个尺度和 8 个方向的 Gabor 特征图，

7 

 
 
 
 
重庆师范大学硕士学位论文                                                                                      2  表情识别框架 

维度大幅提高。同时，每张特征图中都包含了不同方向和尺度的特征信息，是不可

以忽略的，人脸的每一点都可能包含大量表情特征并决定了表情分类的走向，因此，

通过 Gabor 特征融合可以将每张人脸产生的 40 张不同尺度和方向的特征图融合为

一张特征图，该方法包含大量特征的同时又达到了降维的效果。 

Gabor 小波将每张表情图像转换成了 40 个对应不同尺度与方向的特征图，使

特征维数大幅增加，造成了相应的数据冗余，为了保证决策特征信息保留，制定特

征融合规则进行特征融合。融合规则为：将局部区域像素点的 8 个 Gabor 方向特

征最大值进行评估，该方法可以表达图像中最明显的局部特征，在此基础上，结合

分块直方图，加强特征保留。 

分块直方图的作用就是提取表情纹理图像的全局特征，为了防止分块直方图

直接对融合图像进行特征描述会损失一些图像上的细节特征，因此，对融合图像进

行划分，划分成不重叠的相同面积小块，分别对这些小块进行直方图描述。分块直

方图保留了更多的邻域信息，能够同时掌握局部的细微变化和全局的变化。 

将以上方法结合，即保留了 Gabor 对人脸敏感滤波的人脸特征，又大大降低了

维数，达到了预期的效果。 

2.5  表情特征降维 

PCA(Principal Component Analysis)，即主成分分析方法，通过分析其中对数据

贡献最大的主成分进行映射，在所有的特征中，可能存在大部分冗余数据，少量关
键数据，因此，需要提取最关键的几个主成分数据[29]。PCA 降维示例图如图 2-5 所
示。 

8 

 
 
重庆师范大学硕士学位论文                                                                                      2  表情识别框架 

图 2-5 PCA 降维 

为了防止分块直方图的维数过高，造成数据的处理时间过长，采取 PCA(主成

分分析)方法对分块直方图进行降维处理。图像中存在冗余维度，过滤掉对特征影

响较小的冗余特征，选择前 13 个主成分进行处理时，就可以得到 90%的主要特征

信息。极大地减少了运算时间。 

2.6  表情分类器构建 

通过对表情特征进行分类，将对应的人脸匹配于正确的表情标签中，分类器的

选择决定了程序运行的时间成本，准确率的高低以及召回率的高低。在一定的数据

集中合理的分类器有助于提升分类效果。 

2.6.1  随机森林特性 

该分类器最早由 Leo Breiman 和 Adele Cutler 提出，该分类器在所有分类器中

属于年轻一代，在算法的体现中较为灵活，在应用的层面上越来越广泛，随机森林

是通过一个个单颗的决策树所组成的，每棵树都有自己的思想，将其组合成一个森

林，不同的决策树都是一个对特征进行分类的分类器，会产生一个结果，输入一个

样本数据，通过不同决策树的思想分别对其进行分析，将自己的结果进行统计，得

分数量最高的类别成为最终类别[31]。随机森林分类如图 2-6 所示。 

9 

 
 
 
 
重庆师范大学硕士学位论文                                                                                      2  表情识别框架 

(a)                                                            (b)                                                          (c) 

图 2-6  随机森林分类 

随机森林算法具有以下优点: 

(1)在目前的分类算法中，随机森林的准确率数据前列。 

(2)对于缺省值的问题也可以得到一个很好的结果。 

(3)能够评估各个特征在分类问题上的重要性。 

(4)在生成结果的过程中，能够获取内部生成错误的一种无偏估计。 

(5)学习训练过程快。 

2.6.2 SVM（支持向量机）特性 

支持向量机(Support Vector  Machine,  SVM)，作为传统机器学习的一个非常重

要的分类算法，支持向量机是一种原创性（非组合）的具有明显直观几何意义的分

类算法，具有较高的准确率[32]。虽然支持向量机的几何意义较为直观，但是细节非

常复杂，内容涉及到凸优化分析，核函数，神经网络等多个领域。支持向量机分类

如图 2-7 所示。黑线是支持向量机的超平面分割线，超平面是距离两类最大距离的

分割线。 

图 2-7  支持向量机分类 

10 

 
                                   
                               
 
 
 
重庆师范大学硕士学位论文                                                                                      2  表情识别框架 

支持向量机的优点： 

(1)SVM 在小样本的数据中实用性极强且有坚固的理论基础，SVM 在分类和

回归的问题上进行了相应简化。 

(2)SVM 在计算的复杂度上面与支持向量的数目呈正相关性，而不是数据样本

在空间的数量，因此避免了大量的维度产生。 

(3)最终结果由少数的支持向量去决定，对于突然出现的不正常数值迟钝,可以

帮助使用者抓住最关键的数据，从而放弃那些冗余的数据，因此该算法比较简单，

在鲁棒性上也有明显体现。 

(4)SVM 学习问题可以表示为凸优化问题，因此可以利用已知的有效算法发现

目标函数的全局最小值, 

(5)有优秀的泛化能力。 

随机森林和支持向量机都有着各自的优点，在人脸识别的过程中，人脸表情包

含多种类别，不同的分类器对不同表情的特征有着不一样的分类效果，本文将在第

四章中对两个分类器效果进行数据对比，来选取最佳分类器。 

2.7  本章小结 

本章主要讲解了疲劳驾驶识别实验的基本流程，从选取人脸表情数据库对人

脸图像进行预处理到提取表情特征，再到对表情特征进行分类，简要介绍了各个过

程用到的算法。在利用视频实验进行测试前，确定合理的方法，是实验成功的前提。

本章主要介绍了整体图像识别的基本概念。是理解本次实验的前提，便于文章后续

的疲劳驾驶表情研究。 

11 

 
 
重庆师范大学硕士学位论文              3  图像预处理及基于 Gabor 尺度方向融合的特征提取方法 

3  图像预处理及基于 Gabor 尺度方向融合的特征提取方法 

本章将对输入的视频图像进行预处理，预处理对后续人脸特征提取有着重要

的作用，预处理的效果将影响特征的提取效果。本文针对疲劳以及其他六种基本表

情进行特征研究分类，利用基于多尺度多方向 Gabor 融合+分块直方图的表情识别

方法进行特征提取。能否将表情进行准确的分类，对人脸的细节特征提取至关重要，

基于多尺度多方向 Gabor 融合+分块直方图的表情识别方法可以在不丢失细节的情

况下捕捉到重要特征。对最终的表情识别分类提供了有效的算法支撑。本章将详细

讲解算法的原理及其应用。 

3.1  人脸检测与预处理 

驾驶员的人脸检测作为表情识别的第一步至关重要，人脸作为表情识别的信

息源，是后续信息处理的核心。预处理是图像不可或缺的一步，在驾驶过程中获取

到的人脸图像信息会受到噪声，光照等因素的干扰，同时对特征区域的特征信息造

成破坏，无法准确的分析驾驶员的面部特征，会影响最终的疲劳识别结果。因此，

预处理对后续特征提取有着重要作用，是能否有效提取特征的关键。 

3.1.1  人脸检测 

由于数据集中的表情图片包含其他冗余信息，需要利用人脸检测算法将人脸

分割出来并生成新的图像存储。检测人脸需要用到 Haar 特征分类器，该特征分类

器包含了人脸的特征信息，利用 Opencv2 中的 detectMultiScale 函数与 Haar 人脸特

征分类器结合可以检测到图片中的人脸信息。如图 3-1 所示。 

(a)                                                                                (b) 

图 3-1  人脸检测结果 

3.1.2  图像预处理 

为了防止图像在提取特征的过程中出现干扰信息，需要对图像进行预处理工

作。 

12 

 
 
 
 
 
               
 
重庆师范大学硕士学位论文              3  图像预处理及基于 Gabor 尺度方向融合的特征提取方法 

(一)图像灰度化 

综合人脸数据集为彩色图片，更易受光照等影响。会对后续处理产生干扰。将

彩色图片的信息中主要分为 R，G，B 三个通道分量，通过三个分量信息的组合成

为了彩色图像，R，G，B 每个色彩分量的灰度值范围分别为 0-255，每个数值代表

了不同的颜色程度，对三个分量信息进行组合，即 255×255×255。可得到 1658 万

多种颜色，对图像来说 1658 万种可能的颜色值过度冗余，因此，需要对彩色图进
行灰度化，转换为单通道颜色值，大大减少了图像数据的冗余度[33]。目前可采取的

灰度化方法主要有：分量法、最大值法、平均值法、加权平均法等。本文采用平均

值法进行灰度化处理。平均值灰度化法的思想是将三个通道的颜色值进行平均求

值，其计算如式(3.1)所示。 
                                            Gray(i, j) = (R(i, j) + G(i, j) + B(i, j))/3………………… (3.1) 

通过平均值法将彩色图像处理为灰度图像时，图像显示的较为柔和，这也是平

均值灰度化的有点，灰度化实例如图 3-2 所示。 

                          (a)灰度化前                                                                    (b)灰度化后 

(二)直方图均衡化 

图 3-2  图像灰度化 

在得到的图像中可能存在像素值相近的情况，图像的细节表现程度差，此种情

况会造成部分细节无法提取。此类图像在灰度直方图中显示像素区间过窄，为了提

取更多有效的图像特征，需要对图像的细节进行增强处理。通过影响图像整体的对

比度，可以防止图像背景与前景过暗或者过亮，增加图像的清晰度、细节表现、灰

度层次等。因此，本文采用直方图均衡化方法进行图像增强处理[34]。 

直方图均衡化一般利用两种函数进行处理。分别为：(1)概率分布函数。(2)累

计分布函数。概率分布函数在处理二维图像后会造成参差不齐的结果。累计分布函

数是得到每个灰度值所对应的累计直方图中的概率，用概率乘上想要将图像映射

到的像素区域最大值。如式(3.2)所示。 

                                             𝑠𝑘 = ∑

𝑘

𝑗=0

𝑛𝑗
𝑛

   𝑘 = 0,1,2, … , 𝐿 − 1 ………………………  (3.2) 

13 

 
 
                           
                             
重庆师范大学硕士学位论文              3  图像预处理及基于 Gabor 尺度方向融合的特征提取方法 

其中，n 代表了像素和，L 是图像中可能的灰度级总数。 

图像处理计算过程如下表 3-1，3-2 所示。 

表 3-1  图像像素分布 

255 

50 

255 

200 

128 

200 

200 

200 

200 

255 

128 

255 

50 

50 

128 

50 

对上图图像像素进行累计函数映射处理，函数灰度映射示例如下表 3-2 所示。 

表 3-2  累计函数映射结果 

灰度值 

像素个数 

概率 

累计概率 

根 据 函 数 映

取整 

50 

128 

200 

255 

4 

3 

5 

4 

射后灰度值 

0.25 

0.1875 

0.3125 

0.25 

0.25 

63.75 

0.4375 

111.5625 

0.75 

1 

191.25 

255 

64 

112 

191 

255 

图像直方图均衡化处理如图 3-3 所示。 

                              (a)均衡化前                                                  (b)均衡化后 

图 3-3  直方图均衡化 

(三)图像去噪 

图像的噪声妨碍了图像特征的提取，对图像的质量造成了一定的损失，对图像

中存在的大量噪声去除，需要采取相关算法进行去噪。在所有图像去噪的方法中，

主要应用的包括:中值滤波、高斯滤波、双线性滤波、非局部平均法等[35]。对图像

常见的高斯噪声来说，非局部平均去噪方法可以有效地抑制图像中的高斯噪声，因

14 

 
 
 
               
 
重庆师范大学硕士学位论文              3  图像预处理及基于 Gabor 尺度方向融合的特征提取方法 

此本文采用非局部平均法对图像进行去噪。非局部平均法的原理是对图像以块为

区域进行扫描，对存在与该区域结构相似的邻域像素值进行加权平均处理得到新

的图像像素值。对比邻域的像素时，与邻域像素的距离越近，则该邻域像素权重越

大，否则权重越小。扫描过程如图 3-4 所示。 

图 3-4    块状区域扫描 

非局部平局法(NML)相当于对整张图像进行扫描，因此可能会造成处理时间过

长的结果，但是对于图像去噪的结果来说效果较好。图像去噪结果如图 3-5 所示。 

        (a)图像去噪前                                        (b)图像去噪后 

图 3-5  图像去噪 

3.1.3  视频图像预处理 

通过摄像记录驾驶员在驾驶过程中的表情变化，视频作为动态图像，为了检测

一段时间内驾驶员是否处于疲劳状况，需要对视频进行抽帧，为了使数据有效且不

过于冗余，采用 5fps 进行画面抽帧提取。判定当前疲劳表情帧数与所有帧数的比

值，确定该段时间内驾驶员是否处于疲劳状态。抽帧示例图如图 3-6 所示。 

15 

 
 
 
                             
           
重庆师范大学硕士学位论文              3  图像预处理及基于 Gabor 尺度方向融合的特征提取方法 

3.2 Gabor 多尺度融合特征提取 

图 3-6  驾驶员驾驶过程抽帧图 

在人脸特征的提取上，Gabor 小波与人类的视觉系统具有相似的成分。Gabor

变换属于傅里叶变换，因此在提取人脸特征区域具有良好的效果。是用于边缘提取

的线性滤波器，可以调整不同的尺度和方向，通常为 5 个不同尺度和 8 个不同方

向。这些特性来源于对图像边缘的提取，同时对光照不敏感，在不同的光照下具有

很好的适应性[36]。 

在二维 Gabor 函数中，存在类似于峰，谷，脊的底层图像特征。因此，人脸的

眼睛，鼻子，嘴巴等五官特征信息可以很好地提取出来。同时，Gabor 函数的小波
特性对灰色图像的纹理特征具有良好的匹配性[37]。图 3-7 为 Gabor 滤波器与脊椎动

物视觉皮层感受相应对比。 

图 3-7 视觉皮层对比图 

第一行为脊椎动物的视觉神经的示意图。第二行为 Gabor 滤波器的示意图，第

三行为两者差的示意图。 

16 

 
 
 
重庆师范大学硕士学位论文              3  图像预处理及基于 Gabor 尺度方向融合的特征提取方法 

Gabor 滤波器的特性适用于提取人脸的特征。但是，经过 5 个尺度，8 个方向

融合后的 Gabor 多尺度多方向融合特征的计算量和内存需求很大，每张原始图经

过滤波后将得到 40 张特征图，导致特征维数过高，对驾驶员驾驶过程中的视频处
理速度有较大的影响[38]。因此，本文接下来采用基于 Gabor 的多尺度多方向融合特

征的方法进行处理，降低特征维数，尽可能将特征融合在低维数的特征图片中进行

处理。 

人脸的表情特征可能存在于整个人脸部分，需要结合分块直方图进行特征描

述，分块直方图对全局特征具有良好的描述性，但是经过 5 个尺度，8 个方向融合

后的 Gabor 多尺度多方向融合特征具有特征聚合的特性，丢失任何一点细节将损

失惨重。因此，将融合特征图分成相等且不重叠的 6*6 个小块逐个进行分块直方
图描述分析，可以做到信息的最大化采集[39]。 

人脸表情的特征选择流程图如下图 3-8 所示。 

图 3-8  人脸表情特征选择流程图 

3.2.1  人脸多尺度多方向特征 

在人脸表情中，不同的表情存在不同的行为特征。当驾驶员出现疲劳的状态时，

面部的脸颊肌肉呈现放松状态，眼睑微微闭合，眉毛向下弯曲。嘴唇肌肉放松，呈

微微张开状态等。这些特征都具有不同的尺度，其余的人脸表情特征也存在不同的

尺度。因此，Gabor 滤波器可以在灰度特征图中有效地从不同的尺度和方向来进行

分析图像灰度变化。 

人脸特征图经过 Gabor 滤波器 5 个尺度，8 个方向分析后，将产生 40 个不同

尺度方向的特征图(Gabor 特征图如图 3-9 所示)。对于视频处理来说，一段时间内

将产生大量的数据集。因此，1:40 的比例不适合应用在实时监测的系统当中。 

每张人脸特征图的各个关键特征可能处于不同尺度和方向的 Gabor 滤波图中，

同时，这些 Gabor 滤波图也会存在相同的冗余数据。因此，将不同尺度和方向的
Gabor 特征图进行融合可以减少数据间的冗余并且保留关键的决策信息[40]。 

本文将通过相应的融合规则对 40 张特征图进行特征融合，同时对表情图像进

行多尺度分析。 

17 

 
 
 
重庆师范大学硕士学位论文              3  图像预处理及基于 Gabor 尺度方向融合的特征提取方法 

3.2.2  多尺度融合规则 

图 3-9  人脸 Gabor 特征图 

目前主要存在两种融合规则对 Gabor 特征进行融合，这两种规则的共同点都

是对 Gabor 的 8 个方向特征融合，最终得到 5 个尺度的特征融合信息。 

规则 1:对图像所有像素点的方向特征值进行整理合融合，每个像素点都存在

Gabor 所有方向和尺度的特征，相当于该像素点拥有 40 个不同方向和尺度的特征。
保留了所有的特征信息[41]。 

规则 2:保留图像中像素点每个尺度上 Gabor 方向中特征值最大的那个进行融

合。这样保留了特征最明显的部分，减少了一定的冗余度。 

以下对规则 1 和规则 2 进行详细介绍。 

(1)  融合规则 1 

在 Gabor 滤波的过程中存在实部特征与虚部特征，需要分别对两者的特征进

行融合。 

在多尺度的融合规则 1 中，不同的尺度中图片每个像素都具有 8 个方向的特

征值，为了减少冗余数据，取 8 个方向特征值的最大值进行运算。运算规则如下式

(3-3)。 

                s  =  argmax u {||Kx, y (z)||}, u ∈ (0,···   ,7)……………… (3-3) 

其中,Kx,y(z),u∈(0,…,7)对应像素点 z  =(x,y)在 8 个方向上的 Gabor 特征。将 s

作为融合编码进行融合。每一个编码 K 都代表一个尺度的局部方向特征。Gabor 特

征同时包含了实部、虚部或者模。最终对图像的每个像素进行运算。得到 5 个尺度

上的方向特征融合图像。如下图(a)、(b)、(c)所示。 

18 

 
 
重庆师范大学硕士学位论文              3  图像预处理及基于 Gabor 尺度方向融合的特征提取方法 

(a)实部融合 

(b)虚部融合 

(c)模融合 

经过该规则融合后的图像保留了特征最明显的信息，减少了重复或者不必要

的冗余信息。经过融合后的图像具有丰富的纹理特征信息。这样的 Gabor 特征图将

对局部具有良好的识别性。 

(2)  融合规则 2 

融合规则 2 保留了像素点不同方向不同尺度的所有特征值。因此，将每个尺度

的 Gabor 方向以二进制编码的形式进行编码[42]。 

融合规则 2 同样保留了 Gabor 的虚部，将 Gabor 的实部和虚部按以下规则进

行编码。 

(1) 

(2) 

(1)、(2)分别对应 Gabor 的实部与虚部二进制规则。Re 为像素点 Gabor 特征实

部的取值范围，Im 为像素点在 Gabor 特征虚部的取值范围。 

通过以上得到像素相应的二进制编码后，将其转化为 10 进制数值，范围

为:[0,255]。最后同样得到了 5 个尺度的多方向特征值。如下图(d)、(e)所示。 

(d)Gabor 特征实部融合 

19 

 
 
 
 
 
 
 
 
重庆师范大学硕士学位论文              3  图像预处理及基于 Gabor 尺度方向融合的特征提取方法 

(e)Gabor 特征虚部融合 

融合规则 2 的信息更加丰富，几乎不会遗漏任何的特征。但是，在特征的处理

过程中，对每个像素的分析生成了大量的数据，对后期数据的处理分析并不是十分

有利。因此，本实验采用融合规则 1 进行融合特征提取利用。 

采取融合规则 1 的多尺度方向的特征融合缺少对图像的全局特征纹理表达。

因此，在特征的提取过程中结合直方图对图像进行图像的全局表达更加合理。直方

图有对图像进行全局的纹理特征表达的特点。接下来将直方图作为图像全局特征

的补充与 Gabor 融合特征图组合，对人脸表情进行特征描述。 

3.3  特征分块直方图描述 

灰度图像的灰度直方图可以表达整个图像的灰度分布状况，以及灰度像素值

的频率。描述了整幅图像的特征分布。但是直接利用灰度直方图对融合图像进行描

述将会丢失大量的细节。因此，将 Gabor 融合图像进行相应分割，对每一个被分割

的小方块进行灰度直方图特征描述，可以保留相应的细节。将此称为分块直方图

[43]。 

为了防止数据处理过于庞大，又不会丢失相应的图像细节。对融合图像采取

6*6 块的分割计划。将每一幅融合图像分为 36 块直方图进行处理。每个矩形子块

可以表示为: 

                                   Rv, r(z)(v ∈ (0, … ,4), r ∈ (0, … ,64))………………… (3.4) 

其中 v 为尺度，r 为子块。分块直方图的分布如下: 

                            ℎ𝑣, 𝑟, 𝑖 = ∑ 𝑧  𝐼(Rv, r(z) = I), i = 0, … , k − 1……………… (3.5) 

其中，k=8。 

特征图分割块如下图 3-10 所示。 

图 3-10  特征图分块 

直方图的每个条柱子代表了融合编码在该区域出现的次数。每个编码都代表

了局部的特征信息。因此，分块直方图包含了大量的邻域信息。增强了局部特征的

20 

 
 
 
 
重庆师范大学硕士学位论文              3  图像预处理及基于 Gabor 尺度方向融合的特征提取方法 

整体关联性。对脸部特征的细微变化描述的更加清晰。分块直方图信息如下图 3-

11 所示。 

图 3-11  分块直方图信息 

分块的直方图能够同时保留局部以及整体的特征信息。 

3.4 PCA 主成分分析降维 

在对融合过后的特征进行了分块直方图处理后，每张特征图的直方图被分为

6*6=36 块，人脸图像的灰度图片的分辨率为 256*256，Gabor 特征经过融合后为 5

个尺度。因此特征维数为 6*6*256*5=46080，经过分块直方图处理的特征维数仍然

过高，因此，我们需要采用 PCA(主成分分析)对维数进行降维处理。 

在对图片进行 PCA 降维的过程中，首先针对每个维度进行均值运算。均值运

算如式(3.6)。 

x =

1
𝑚

𝑚
∑ 𝑥𝑖
𝑖=0

...…………………………… (3.6) 

(1)接下来对数据的每个维度进行均值零化处理。均值零化处理就是让每个均值

皆为 0。每个数据都减去均值。均值零化如式(3.7)。 

  x0 = x1 − x2 

…..………………………… (3.7) 

(2)去均值最主要的目的是为了防止过拟合。当数据的特征值过大，进行激活

函数输出的时候，会导致对应位置的数值变化量较小。会导致效果变差。 

计算协方差矩阵用来求解该矩阵的特征值和特征向量。采用特征值分解方法

进行分解。随后将求得的特征向量按特征值大小进行排列，组合成矩阵。取前 N 行

组成新的矩阵 Q。(注：N 为想保留的主成分维数)最后利用新的矩阵 Q 与标准化后

的数据相乘，即可得到降维到 N 维的新的特征图像。 

PCA 主要的思想核心是将 K 维度降到 N 维度。N 维度即是我们想得到的目标

维度。在已存在的特征维度中，大部分的维度并不是主要的和积极的。因此我们需

要设定一个合理值，将最能表达当前图片特征的维度留下来，也就是我们需要的主

21 

 
 
 
 
重庆师范大学硕士学位论文              3  图像预处理及基于 Gabor 尺度方向融合的特征提取方法 

成分(N 的值)。在本文中取前 13 个主成分进行特征提取。前 13 个主成分可以达到

90%的贡献率。可以达到最终表达图片特征的需求。 

3.5  算法可行性分析 

(1)每幅表情图片利用 Gabor 提取 5 个尺度，8 个方向共计 40 种特征，利用融

合特征算法进行特征融合，将每个尺度方向的特征融合为一张特征图片，大大降低

了特征的冗余度。同时该融合特征成功捕捉了 Gabor 空间频率、空间位置、方向选

择性等局部结构信息。精简了算法的处理过程，提高了运行效率。 

(2)在识别人脸表情的过程中，本论文采取 Gabor 特征对表情进行特征分类，

与传统划分区域计算眼睛、嘴巴等运动方式不同。考验人类做出表情时人脸的细微

变化。该类细节变化体现在人脸的额头、眼睛、眉毛、脸颊肌肉、嘴部肌肉等等。

因此，每部分的细节都保存着此人的面部表情信息。特征融合可以有效描述特征纹

理信息，融合后的特征保留了 Gabor 在各个方向尺度的信息细节。局部纹理特征丰

富。分块直方图在全局特征的信息处理过程出色，将两者结合可以充分地表达人脸

的局部特征和邻域特征。所以，本论文采取融合特征和分块直方图相结合的方法进

行特征提取。 

(3)Gabor 特征提取与分块直方图特征描述方法充分的表达局部的特征信息，

确保了算法所得的图像特征模型为局部模型。当人脸出现局部形变时，对最终的结

果影响很小。有效地降低了在驾驶员驾驶过程中出现头部运动造成的影响。因此，

该算法在头部运动方面具有很强的鲁棒性。 

3.6  本章小结 

本章主要介绍了表情特征的提取与融合方法，首先分析了 Gabor 滤波适合提

取人脸的表情特征，为了防止提取的特征过于冗余，随后对提取的人脸特征进行融

合，详细讲解了融合规则，融合后的特征图片具有丰富的特征信息。为了保证不丢

失全局特征，结合分块直方图表征特征信息。特征融合+分块直方图的特征提取方

法可以充分表达当前图片的人脸表情信息。最后对算法进行了分析。实验提取特征

结果表明，相比于不对特征进行融合，实验特征提取时间大大缩短，提升了效率。 

22 

 
 
 
重庆师范大学硕士学位论文                                                                  4  表情分类和疲劳判定逻辑 

4  表情分类与疲劳判定逻辑 

在上一章采用 Gabor 特征融合+分块直方图的方法对图像进行了特征提取，本

章将对提取到的特征进行模型训练，训练出愤怒（anger）、高兴(happiness)、惊讶

(surprise)、厌恶(disgust)、中立(normal)和恐惧(fear)、疲劳(fatigue)组成的表情模块，

构建相应的分类器。在训练之前需要进行相应的特征维度降维，保留主要的成分进

行分析，提升训练速度。 

本章将讨论分类算法构建分类器，提升准确的识别率，制定驾驶疲劳判断逻辑，

对分类过后的驾驶视频进行分析，根据结果进行预警。 

4.1  随机森林 

4.1.1  随机森林基本原理 

随机森林算法的思想是将决策树集成，组合在一起，构造一个强大的分类器。

因此，随机森林基本单位是决策树。每一个决策树都单独为一个分类器，可以对得

到的特征进行分类并投票，在一个随机森林的所有决策树进行投票后，票数最多的

分类为最终的分类结果[44]。 

随机森林算法的特点是: 

(1) 在目前已知的所有分类器中，准确率非常高。 

(2) 适合运行在大型的数据集上。 

(3) 对高维度的数据特征处理具有良好的适应性。 

(4) 能够对每个特征在分类的重要性上进行评估。 

随机森林用若干个弱分类器进行，这些弱分类器就是树，每棵树都需要对样

本进行训练，且训练的过程中是随机抽取样本并在训练结束后将该数据集放回，

意味着训练的过程中可能存在重复训练。因此，每棵树的训练也是不同的。随机

森林的随机性可以有效地防止过拟合。随机森林流程图如下图 4-1 所示。 

23 

 
 
 
 
 
 
 
重庆师范大学硕士学位论文                                                                  4  表情分类和疲劳判定逻辑 

图 4-1  随机森林 

随机森林构建的分类器集群性能主要受两方面影响。分别是受来自训练样本

的影响和单颗决策树的分类器强度影响。在训练样本中，训练集的正负分布，即训

练集的平衡；训练集的规模大小；训练样本的类型等；在单颗决策树的分类器方面，

单颗决策树的分类强度和决策树之间的关联性强度都会影响随机森林的性能。总

的来说，衡量随机森林性能的三个指标分别为：分类效果指标；泛化误差；运行效

率。 

4.1.2  决策树特征选择 

决策树作为随机森林的子集，承担着单体特征分类的责任，决策树的结构就如

本身的名字一样呈树状结构。决策树对数据进行分类时在树的每层进行一次特征

选择，选择继续向下分类，直到不可分为止[45]。决策树主要分为两类。分别是离散

型决策树和连续性决策树。离散型决策树的目标变量是离散的，如性别：男或女等。

连续性决策树的目标变量是连续的，如工资、年龄、价格等。决策树如图 4-2 所示。 

24 

 
 
 
重庆师范大学硕士学位论文                                                                  4  表情分类和疲劳判定逻辑 

图 4-2  决策树 

决策树主要由根节点，决策节点，叶子节点构成。的根节点代表了整个样本集

合，该节点可以进一步划分为两个或者多个子集。当节点在下一步被拆分成更多的

节点时，此节点就是决策节点[46]。叶子节点为最后无法再被拆分的节点，也可以称

为最终结果的分类节点。在决策树构成的过程中需要通过剪枝将决策树的规模缩

小，目的是防止决策树出现过拟合的状况，同时构建随机森林也是解决问题的良好

办法。 

每次从当前节点向下分支都进行一次特征选择，特征选择有不同的方法进行

规定，由此也可以衍生出不同的决策树。目前使用的方法为：ID3（通过信息增益

选择特征）、C4.5（通过信息增益比选择特征）、CART（通过 Gini 指数选择特征）

等。使用这些方法对决策树进行划分的目的是相同的，即每次划分后，该数据的分

类都要比前一次更加清晰。 

决策树的优点： 

（1）具有可读性:通过给予决策树一个合理的训练模型，决策树将很快得出一

个相应的分类结果。 

（2）分类速度快：在面对大量数据时，可以在短时间内解决问题。 

决策树的缺点： 

对未知的测试数据分类较差。有较大的可能产生过拟合现象。 

25 

 
 
 
重庆师范大学硕士学位论文                                                                  4  表情分类和疲劳判定逻辑 

针对决策树的缺点问题，构建随机森林可以很好地解决过拟合现象。构建大量

决策树，利用决策树产生的分类结果进行投票，投票的权重最终结果决定分类结果，

可以有效的避免数据单一化造成的分类误差，有效的提高了最终分类结果的正确

率。也有效地防止了过拟合现象。 

4.1.3  随机森林分类结果 

本实验数据集采用 CK+人脸数据库、FER2013 人脸数据库和疲劳表情数据库，

共采用 7 中人脸表情进行实验。分别为愤怒（anger）、高兴(happiness)、惊讶(surprise)、

厌恶(disgust)、中立(normal)、恐惧(fear)和疲劳(fatigue)。其中高兴的图片集为 207

张，厌恶的图片集为 266 张，疲劳的图片集为 108 张，惊讶的图片集为 249 张，轻

蔑的图片集为 75 张，中立的图片集为 108 张，愤怒的图片集为 270 张。随机森林

预测表情分类如图 4-3 所示。 

注：(0 代表高兴、1 代表中立、2 代表厌恶、3 代表疲劳、4 代表惊讶、5 代表愤怒、6 代表恐

图 4-3  随机森林表情分类 

惧) 

分类结果总体正确率为 98.4%。其中高兴、中立、疲劳、惊讶、愤怒识别正确

率均高于 98%，误识别率极低。且分类的召回率达到了 99.7%，厌恶的识别率稍低

于以上表情。恐惧表情识别率过低，且高兴、惊讶表情误识别为恐惧表情的几率分

别为 22%和 8%。 

可能的原因为： 

26 

 
 
 
重庆师范大学硕士学位论文                                                                  4  表情分类和疲劳判定逻辑 

（1）恐惧表情在嘴部与眼部的肌肉运动状态与高兴相似，眼部肌肉因紧张呈

微闭状态，嘴部肌肉因受到刺激呈现张开状态。 

（2）恐惧表情数据集过少，导致特征训练不完全。 

在驾驶的过程中，驾驶员可能产生基本表情基本不包括恐惧表情，可以用其他

驾驶过程中出现频率高的其他基本表情代替。据研究表明，轻蔑表情在驾驶员驾驶

过程中会大量表达，例如驾驶过程中遇见驾驶技术不娴熟的司机等。根据实验数据

以及驾驶实际情况分析，本文将用同为基本表情的轻蔑表情替代恐惧表情。 

4.2 SVM(支持向量机)   

4.2.1 SVM 基本原理 

支持向量机是一个二分类的模型，SVM(支持向量机)最终的目的是寻找一个最

合适的超平面来进行测试样本的分割。在分割的过程中，尽量使类别之间的距离最

大化。分类的模型由简单到复杂，可能存在线性可分和线性不可分[47]。 

（1）当数据是线性可分的数据时，利用数据的硬间隔最大化，训练为线性可

分向量机。 

（2）当数据是与线性可分比较近似的时候，利用数据的软间隔最大化，训练

为线性向量机； 

（3）当数据是线性不可分时，将核技术与软间隔最大化相互结合起来，训练

为非线性向量机； 

下图 4-4 为线性可分时且存在多个可划分的超平面示例图。 

图 4-4  存在多超平面的线性分割 

27 

 
   
 
 
重庆师范大学硕士学位论文                                                                  4  表情分类和疲劳判定逻辑 

当训练集数据线性不可分时，简单的线性可分支持向量机就无法正常的工作

了。因此需要训练一个非线性分类模型。图 4-5 为线性不可分平面图。 

图 4-5  线性不可分示例图 

结合多项式回归在处理非线性可分数据时候的作用,在 SVM 的线性不可分的

数据上,如果将数据映射到高维空间中,那么数据就会变成线性可分的,从而就可以
使用线性可分 SVM 模型或者软门隔线性可分 SVM 模型[48]。图 4-6 为映射到高维

的图像。 

那么，从低维空间映射到高维空间的映射函数就显得尤为重要。核函数的存在

图 4-6  映射高维图像 

就是为了解决以上问题。 

28 

 
   
 
重庆师范大学硕士学位论文                                                                  4  表情分类和疲劳判定逻辑 

4.2.2  核函数 

在普通的非线性处理中，通过得到一组数据，找到一个映射函数，将其从二维

映射到三维，再到四维，然后做 SVM 运算，期间产生了大量的维度，造成了维度

灾难。 

核函数在解决线性不可分问题的时候,采取的方式是:使用低维特征空间上的

计算来避免在高维特征空间中向量内积的恐怖计算量;  也就是说此时 SVM 模型可

以应用在高维特征空间中数据可线性分割的优点,同时又避免了引入这个高维特征。 

假设函数 Φ 是一个从低维特征空间到高维特征空间的一个映射,那么如果存在

函数 K(x,z),对于任意的低维特征向量 X 和 z,都有，称函数 K(x,z)为核函数(kernal 

function)，如下式(4.1)所示。 
                                                    K(x, z) = Φ(x) ∗ Φ(z)…………………………… (4.1) 

4.2.3  松弛变量 

经过核函数的运算后，低维线性不可分的数据变成了高维线性可分数据，如

下图 4-7 所示。 

图 4-7  处理后线性可分图 

但是我们对样本增加一个额外的数据可能会出现以下情况。如图 4-8 所示。 

29 

 
 
 
 
重庆师范大学硕士学位论文                                                                  4  表情分类和疲劳判定逻辑 

图 4-8  线性不可分 

如图 4-8 中所示，仅仅增加了一个样本，该样本出现在了无法被分割的位置，
如果对此重新进行核函数计算，代价又非常大，所以，适当的忽略问题点非常重要。

因为该点属于特殊点，仅仅存在一个，在大量的样本中对结果的影响较小。线性可

分的过程又需要使间距尽可能大，因此，设置一个合适的松弛变量可以避免此状况

的发生。 

松弛变量的作用于核函数相似，都是解决线性不可分问题，只不过松弛变量属

于对核函数映射过后的少数不可分变量进行优化罢了。 

核函数与松弛变量的设定对 SVM(支持向量机)的效果有着至关重要的作用，

因此，在实验中需要合理的设置相关值。 

4.2.4 SVM 分类结果 

在同样的数据集中，共采用 7 中人脸表情进行实验。分别为愤怒（anger）、高
兴(happiness)、惊讶(surprise)、厌恶(disgust)、中立(normal)和恐惧(fear)和疲劳
(fatigue)。其中高兴的图片集为 207 张，厌恶的图片集为 266 张，疲劳的图片集为
108 张，惊讶的图片集为 249 张，轻蔑的图片集为 75 张，中立的图片集为 108 张，
愤怒的图片集为 270 张。SVM 分类器的效果如图 4.9 所示。 

30 

 
 
 
重庆师范大学硕士学位论文                                                                  4  表情分类和疲劳判定逻辑 

注：(0 代表高兴、1 代表中立、2 代表厌恶、3 代表疲劳、4 代表惊讶、5 代表愤怒、6 代表轻

图 4-9 SVM 表情识别分类 

蔑) 

SVM(支持向量机)的总体识别准确率为 96.1%，召回率为 97.2%。  在 SVM 分

类的过程中，高兴、中立、厌恶、疲劳、惊讶、表现良好，准确率均达到了 96%以

上，愤怒与轻蔑识别率分别为 95%与 72%，轻蔑表情成功率略低，与随机森林方

法相同，都对轻蔑表情整体识别度不精确。在误识别率上，愤怒表情被识别为中立

与厌恶的比例较高，轻蔑表情被识别为高兴、中立、厌恶、惊讶的概率相近。 

与随机森林相同，产生的原因可能为表情特征相近与部分表情数据量较少。 

4.3  随机森林与 SVM 结果对比分析 

通过以上小节对方法分类结果数据的分析，不同的分类器体现了不同的实验

效果，具体数据比对由下表 4-1 展示： 

表 4-1  分类器数据对比 

准确率 

召回率 

运行时间 

SVM 

96.1% 

98.2% 

6.6s 

随机森林 

98.4% 

99.7% 

6.9s 

通过以上对比得知，随机森林的各项结果数据要优于 SVM，SVM 与随机森林

对小样数据集的处理都比较优秀，得到的准确率结果处于较高水准，但是 SVM 分

类器对多类别分类的效果不如随机森林。因此，在部分表情上准确率出现了降低，

影响了整体的准确率。在分类运行时间方面，取自相同时长的视频片段，视频时长

31 

 
 
 
 
重庆师范大学硕士学位论文                                                                  4  表情分类和疲劳判定逻辑 

为半分钟。SVM 略高于随机森林。然而，在系统应用在实际场景过程中必然面对

着大量的数据集，SVM 运行效率得不到保证，相反，随机森林对大量数据集处理

效果较好，运行时间较快。这也是本文选择随机森林进行表情分类的初衷。 

4.4  疲劳状态检测与判定逻辑 

在驾驶过程中，驾驶员产生的表情决定了当前驾驶员的精神状况，驾驶员的周

围情况可能会影响驾驶员从非疲劳到疲劳的过渡时间长短。从心理学上讲人类需

要适当的外界刺激才能维持大脑活动在较高的水平上。当驾驶员在既宽广又平坦

的高速公路上驾驶的时候，大脑就长时间处于刺激比较少的状态，大脑活动就会受

到抑制，从而产生疲倦和懈怠。在高速上，大部分的驾驶员一直持续盯着前方的车，

如果前方没有车，就只会望向这条伸延到永远的道路尽头。找不到视野目标，驾驶

员的视野范围就会变窄。紧接着，驾驶员对速度的感受力也会下降。 

当驾驶员周围有其他乘客存在且与该乘客存在互动行为时，驾驶员不易陷入

高速催眠的疲劳状态。可以适当延长驾驶员的驾驶时间。此状况驾驶员可能会因与

乘客的互动产生积极的表情，例如高兴，惊讶等。驾驶员不再因为大脑受到刺激减

少而受到抑制，因此可以适当延长系统报警时间。当驾驶员周围没有刺激时，驾驶

员表情长时间处于中立表情，系统应当考虑高速催眠效应，提前提示驾驶员疲劳预

警。 

4.4.1  驾驶员驾驶疲劳的产生机理分析 

目前驾驶员在驾驶过程中主要从两方面产生疲劳： 

（1）精神疲劳 

在驾驶过程中驾驶员会对路面状况进行判断过程从而达到安全驾驶的目的。

在该阶段，人体的主要的工作区域为大脑以及中枢神经系统，在驾驶过程中，持续

不断的警惕使大脑不断承受负荷，导致驾驶员出现思维迟钝、判断能力减弱、从而

导致误判或不判断的情况。当驾驶员进入轻度疲劳时，人体会做出相应的抵抗动作，

例如打哈欠等，经过一定的抵抗，驾驶员会重新进入精神积极状态，但是持续时间

会变短，当再次进入疲劳时，需要靠外界刺激消除疲劳，例如同车内人员提醒，预

警功能等。 

（2）体力疲劳 

驾驶员体力疲劳主要由感知、操作以及身体保持平衡的肌肉群联合作用所引

起，在驾驶员操作汽车的时候，人体肌肉不断做收缩动作，此时肌肉需要不断补充

能量，该能量主要由肌肉细胞中的三磷酸腺苷(ATP)分解所产生的能量，ATP 以提
供肌肉持续活动做功所需的能量[49]。当血液内的含氧量充足时，ATP 的合成是通过

32 

 
 
 
重庆师范大学硕士学位论文                                                                  4  表情分类和疲劳判定逻辑 

对糖和脂肪酸的氧化来实现的;当血液供氧不足时，则主要通过糖份的无氧酵解来

实现，此时会产生乳酸这一肌肉疲劳致因物质。如果保持持续不断的肌肉作业，以

致肌肉对 ATP 的需求超过血液的供氧能力以及肌肉细胞的 ATP 合成能力。此时

ATP 的产生和消耗平衡被打破，使得肌肉的做功能力下降，同时乳酸大量聚集，从

而引起肌肉酸痛、无力的体力疲劳现象。 

4.4.2  驾驶员驾驶疲劳的影响因素 

（1）驾驶时间因素 

目前研究表明，当正常的驾驶员连续驾驶 3 个小时后，会产生疲劳状况，且数

据表明 3 个小时后，交通意外也会开始增加。当驾驶员连续驾驶 4 个小时后，交通

意外的发生率开始陡增，是 3 个小时的 1.5 倍。根据已有文献表明(该文献记录了

1000 名法国卡车司机驾驶的过程)，该文献描述驾驶员在一段封闭的试验道路上进

行驾驶，试验过程为当驾驶员在驾驶过程中出现 3 次睡着状况为止，停止试验。试

验表明，出现该状况的驾驶时间段为 7 小时-12 小时。综合数据分析后，表明当时

间为 8 小时后事故率大大增加。因此，本文将连续驾驶时间 3 小时归为轻度疲劳，

连续驾驶时间 4 小时为中度疲劳，连续驾驶 7 小时为重度疲劳。 

（2）心理情况因素 

根据心理学上的耶基斯-多德森定律描述工作难易程度、唤醒水平和工作绩效
三种之间的关系可知，操作压力较高会对工作者造成心理压力[50]，易于导致工作上

的失误。同时，较高的工作压力需要投入更多的精力保持较高的唤醒水平，增加脑

力的工作负担，进而产生疲劳现象，过低的操作压力导致较低的唤醒水平，同样降

低工作效果[51]，如图 4-10 所知。 

图 4-10  驾驶任务需求、工作负荷与绩效水平之间的双”U”型曲线 

（3）环境情况因素 

在驾驶过程中，驾驶员可能会受周围环境影响而改变精神状态。当车内存在其

他成员时，驾驶员可能存在与乘客交谈情况，驾驶员会随语境情况改变相应精神状

态，会表达出生气，害怕，厌恶，开心，惊讶以及轻蔑等基本表情，当驾驶员处于

33 

 
 
重庆师范大学硕士学位论文                                                                  4  表情分类和疲劳判定逻辑 

以上表情时，说明精神处于活跃状态，不计为疲劳状态。在驾驶员非疲劳表情方面，

如驾驶员处于中立表情和处于其他非疲劳表情对大脑的刺激是不同的，当驾驶员

长时间处于中立表情时，大脑会慢慢进入惰性状态，导致疲劳状态提前到来，需要

对疲劳判断的正常驾驶时间点适当缩短，提前预警。当驾驶员处于积极情绪时，亢

奋状态不断刺激大脑皮层，使驾驶员可以保持更长时间的兴奋状态，该积极情绪可

能来自于车内的不定因素，在该种状态下，系统可以使预警时间适当的延长驾驶时

间。 

在以上三点疲劳因素中，除了心理情况因素无法改变外，可从环境因素与驾驶

时间因素提出解决办法。综合以上内容，可以提供预防司机处于疲劳状态驾驶车辆

系统，可以根据驾驶员具体的驾驶情况对疲劳状态进行具体分析，增加系统的人性

化，防止过于机械的阻止驾驶员驾驶。可以大大增加系统的实用性与适用性。 

4.4.3  疲劳判定准则 

结合以上内容，根据驾驶员驾驶时间，提出时间判断疲劳准则。由下表 4-2 可

知。 

表 4-2  驾驶时间疲劳判定准则 

疲劳状况 

预警与动作 

0h-3h 

否 

否 

3h-4h 

轻度 

提示 

4h-7h 

中度 

预警 

7h-12h 

重度 

停止驾驶 

根据驾驶时间可以硬性判断驾驶员处于疲劳状态，主要为了防止驾驶员为了

完成驾驶目标利用手段强制自己处于兴奋状态，当驾驶员处于轻度与轻度和部分

中度疲劳时，通过手段使大脑处于短暂亢奋状态是可取的，但是当大脑处于重度疲

劳时，通过手段使大脑处于亢奋状态效果会随时消失，进入短暂睡眠状态，此时是

非常危险的，因此，需要通过硬性方式时间进行预警。 

通过时间判断疲劳准则可能在部分情况失效，例如驾驶员通过非驾驶活动使

自己进入疲劳状态，此时时间标准不成立。因此，本文基于 Gabor 特征融合特征提

取识别的疲劳预警系统可以防止此时间的发生。 

当驾驶员处于疲劳状态时，系统将捕捉疲劳表情计入疲劳状态分析，当驾驶员

出现疲劳时，可能产生以下两种情况。 

（1）产生疲劳情绪抵抗性 

驾驶员处于相应疲劳会通过环境进行情绪抵抗，该情况可能为与车内其他乘

客聊天，喝冰饮料，拍打自己面部等。这些举动在轻度或者中度疲劳时会产生效果

并延缓疲劳状态来临，因此需要通过其他基本表情判断准确表达疲劳效果，当抵抗

34 

 
 
 
重庆师范大学硕士学位论文                                                                  4  表情分类和疲劳判定逻辑 

状态来临时，可以适当延迟预警。当出现以上抵抗情况时，驾驶员的面部表情会表

现出快乐、惊讶、厌恶、疲劳、愤怒、轻蔑等。本文将这些基本表情标记为积极表

情（此类表情会使脑部进入亢奋状态）。 

（2）无法产生相应抵抗性 

当驾驶员在进入轻度或中度疲劳时可能因为环境问题无法产生抵抗效果。此

时驾驶员面部表情为疲劳表情和中度表情混合。因此需要及时提醒驾驶员。 

通过以上原则，疲劳准则应用主观评分法设置权重，将积极表情与中立表情考

虑在内，当人类表情处于亢奋状态中时，积极表情起正因子作用，疲劳表情起负因

子作用，当驾驶员表情一般为积极表情，一般为疲劳表情时，说明驾驶员处于疲劳

情绪抵抗中，因此，正因子作用小于负因子作用。当驾驶员在驾驶过程中长时间处

于情绪波动低潮时，即中立表情起引导作用，因此中立表情在驾驶过程中起负因子

作用，但是相比疲劳表情因子作用要低。 

本文通过主观客观综合评测法设置表情因子权重。 

在主观方面：根据本身疲劳产生与抵抗过程的表情表达体验中总结，当积极表

情出现时对自身大脑精神状态的影响呈积极状态，帮助消退部分疲劳状态，当中立

表情以及疲劳表情出现时，使大脑处于消极状态，导致疲劳程度加深。 

在客观方面：根据医学文献研究，抵抗行为影响自身大脑皮层状态有助于减缓

疲劳的产生与到来。 

因此，综合以上方面，赋予积极表情因子 P=1，中立表情因子 N=-1，疲劳表

情因子 F=-4。 

疲劳状态为 S，P1、N1、F1 为同段时间内相应表情频率。 

                                                      S = P ∗ P1 + N ∗ N1 + F ∗ F1……………………(式 4.1) 

通过上式计算疲劳状态 S，由下表 4-3 可知。 

表 4-3  表情疲劳判断准则 

S>=-1.5 

-1.5>S>=-2 

-2>S>=-2.5 

  -2.5>=S 

疲劳状况 

否 

预警与动作  无 

轻度疲劳 

中度疲劳 

提示 

预警 

重度疲劳 

停止驾驶 

4.5  本章小结 

本章主要针对 SVM 与随机森林在人脸识别分类上进行了实验。选择了对表情

分类的最优分类器。分析了各种表情对驾驶员的疲劳影响。通过驾驶员在驾驶过程

中产生疲劳的机制原理，制定了与之对应的疲劳判定准则，为系统判断疲劳状态提

供了理论支持。   

35 

 
 
 
 
重庆师范大学硕士学位论文                                                                              5  疲劳分析预警软件 

5  疲劳分析预警软件 

经过对驾驶过程中驾驶员表情特征的提取于分类，可以得到驾驶员在驾驶过

程中相应的精神状态，在前面几章主要讲解了如何提取驾驶员驾驶过程中的表情

特征以及如何对其分类。本章主要根据已有算法进行相应的疲劳预警系统设计，设

计相应的功能模块，测试系统的鲁棒性以及实用性。通过输入驾驶视频，对视频进

行处理，最后由软件进行数据分析，得出相应结论。 

5.1  软件组成部分 

疲劳预警软件主要通过电脑硬件以及相应的软件设计组成。软件的图像采集

部分通过电脑的摄像头硬件获取，分析图像数据的硬件通过高性能计算机处理。软

件部分由 python 语言算法设计并运行，软件的 UI 界面通过 pyqt5 模块进行开发。

以下将进行硬件系统以及软件系统的详细讲解。硬件参数由下表 5-1 所示。 

PC 操作系统 

处理器 

内存 

显卡 

硬盘 

表 5-1  软件硬件参数 

Windows10 64 位操作系统 

Inter(R)Core(TM)i7-7700HQ CPU @2.80GHz 

8.00GB 

1.NVIDIA GeForce GTX1050 

2.Inter(R)HD Graphics 630 

512G 固态硬盘  + 512G 机械硬盘 

摄像头采集设备 

Integreted Webcam 

软件由 python 语言开发，采用的编程软件为 Pycharm。采集视频图像通过

OpenCV 调用摄像机录制采集。对视频进行预处理调用，预处理主要包括 UI 操作

界面设置的帧数进行取帧，取帧后的图像需要进行灰度化，通过人脸识别算法进行

人脸提取，提取关键区域，将处理过后的人脸图像写进 CSV 文件，供人脸表情特

征提取使用。特征提取采用基于 Gabor 尺度方向融合与分块直方图的特征提取方

法。最后利用随机森林算法进行表情分类。由于随机森林的特性，数据模型规模较

小，采用 CPU 进行处理，并没有采取 GPU 框架。操作界面通过 pyqt5 模块进行开

发设计。软件的相应版本由下表 5-2 所示。 

36 

 
 
 
 
 
 
重庆师范大学硕士学位论文                                                                              5  疲劳分析预警软件 

模块名称 

Pycharm 

Keras 

Pyqt5 

Pandas 

Scikit-learn 

Imutils 

Opencv-python 

表 5-2  相应模块版本参数 

对应版本 

2017.3.7 

2.2.4 

5.13.0 

0.24.2 

0.21.2 

0.5.2 

4.10.25 

5.2  软件流程框架 

从输入视频图像到提取图像特征在到最后对其进行表情分类的工作流程由下

图 5-1 所示。 

图 5-1  系统流程框架图 

疲劳预警软件通过视频图像采集、人脸图像预处理、图像表情特征提取、图像

表情分类、疲劳状态判断等流程处理，将处于相应表情时间最长的表情标签进行输

出，最后在通过相应表情的占比数据分析疲劳等级。因此，系统主要分为五大模块。

下面将分别介绍相应模块的功能与作用。 

37 

 
 
   
重庆师范大学硕士学位论文                                                                              5  疲劳分析预警软件 

图像输入模块:通过 OpenCV 调用电脑照相机，利用电脑的照相机获取人脸表

情录像。将视频存储在相应的路径中等待调用。调用通过 UI 界面操作调用。 

视频图像预处理模块：该模块主要功能为视频采集的帧数，对采集到的图片进

行预处理方便提取特征，减少冗余干扰信息，将处理过后的视频图像写进 CSV 文

件中供图像特征提取模块使用。视频采集的帧数选取可以由低到高控制，当驾驶员

处于非疲劳时，可以减少帧数，降低处理负担。当驾驶员分别处于轻度，中度，和

重度疲劳时，相应增加帧数提取频率。判断驾驶员在小区域时间内疲劳严重程度，

及时发出预警。避免意外的发生。 

图像特征提取模块：该模块负责将预处理模块写进 CSV 文件的图像数据进行

Gabor 尺度方向融合与分块直方图的特征提取，将提取后的特征写进另一个 CSV

文件中进行存储调用。 

图像表情分类模块：调用目前存在的数据集进行训练过后的模块对视频提取

出的特征进行表情分类。该模块会将分类后的数据进行标签标记，存储到 txt 文件

中。并将最终列表中同类元素最多的标记得到，输出该标签对应的表情，得到最终

该视频占比最高的表情类。为后续分析模块提供帮助。 

疲劳分析模块：该模块利用制定的逻辑进行疲劳分析定级。通过标签列表中疲

劳元素占比情况分析该段视频中驾驶员的疲劳状况，并采用相应的预警功能，同时

可以通过驾驶时长来规避长时间的疲劳驾驶。综合判断达到提醒驾驶员避免疲劳

驾驶的效果。 

5.3  系统界面设计 

本文运用 python 的 Pyqt5 设计 GUI，实现了对疲劳状态识别与分析的可视化

操作，其界面如图 5-2 所示。控制部分主要由输入视频按钮，输入人脸识别模型按

钮，载入随机森林模型按钮，视频帧数输入，视频取帧按钮，特征提取按钮，表情

分类按钮以及状态分析按钮组成。首先要输入原视频进行分析准备素材，接着输入

人脸识别模型以及随机森林模型提取出人脸，并对接下来即将得到的特征利用模

型进行训练。在视频帧数方面合理控制不同情况下对驾驶员驾驶过程的抓取。随机

进入操作阶段，对视频进行抽帧，对抽得的帧数进行特征提取，随机对其分类。最

后由最右边的输出控制台打印出该段视频的疲劳分析。该输出控制台同时可以打

印出对操作所得的反馈信息。 

38 

 
 
 
重庆师范大学硕士学位论文                                                                              5  疲劳分析预警软件 

图 5-2  疲劳预警系统界面 

5.3.1  文件输入模块设计 

点击控制输入视频按钮后，弹出选取视频文件的界面，如图 5-3 所示。录得的

驾驶视频信息存储在指定的文件夹内，根据视频所在路径进行文件抓取，如图 5-4

所示。 

图 5-3  输入视频操作 

39 

 
 
 
 
重庆师范大学硕士学位论文                                                                              5  疲劳分析预警软件 

图 5-4  视频文件选取 

点击控制界面的输入人脸识别模型按钮以及载入随机森林按钮，将需要使用

的模型进行输入，输入框内显示模型文件路径，人脸识别模型利用 OpenCV 自带

的 级 联 分 类 器 haarcascade_frontalface_default.xml ， 随 机 森 林 模 型 通 过 已 有 的

Fer2013 人脸数据库以及疲劳表情数据进行训练得到各个表情的分类模型，分类效

果良好的模型 model.pkl 如图 5-5 所示。 

图 5-5  选取模型界面 

40 

 
 
 
 
重庆师范大学硕士学位论文                                                                              5  疲劳分析预警软件 

5.3.2  预处理模块设计 

在视频帧数处理方面，默认初始状态值为 5fps，根据上文判断疲劳的逻辑以及

驾驶员已驾驶的时间长短来进行自动帧数设置，当检测到疲劳特征状况时，系统自

动将帧数上调，减少细节的丢失。当驾驶员驾驶时间达到一定阈值时，系统自动调

高帧数，预防随时可能产生的疲劳状况。参数区如图 5-6 所示。 

图 5-6  处理参数显示区 

在经过以上步骤结束后，正式进入操作流程，首先对视频进行抽帧，该步骤同

时可以完成对视频的预处理任务，主要包括，抽帧、图片灰度化、划取人脸区域、

存入 CSV 文件。得到处理后的图片，存放在指定文件夹下。视频抽帧过程如图 5-

7 所示。 

图 5-7  视频抽帧过程 

41 

 
 
 
重庆师范大学硕士学位论文                                                                              5  疲劳分析预警软件 

5.3.3  特征提取模块设计 

完成视频抽帧的流程后，需要对抽帧后的数据进行特征提取，点击特征提取按

钮后，调用存储的 CSV 文件，写入存储特征的新 CSV 文件。视频特征提取如图 5-

8 所示。 

图 5-8  视频特征提取过程 

5.3.4  表情分类模块设计 

得到视频处理过后的特征，利用训练好的随机森林 model.pkl 模型，将特征输

入并进行分类，并将得到的分类结果打印到屏幕上。视频表情分类如图 5-9 所示。 

42 

 
 
 
 
重庆师范大学硕士学位论文                                                                              5  疲劳分析预警软件 

图 5-9  视频表情分类过程 

5.3.5  疲劳分析模块设计 

最终将分类过后得到的信息数据进行分析，点击状态分析按钮将系统分析过

后的最终结果打印到屏幕上，屏幕输出的数字标签分别代表每帧图片上的表情状

态，0 代表快乐，1 代表蔑视，2 代表厌恶，3 代表疲劳，4 代表惊讶，5 代表生气，

6 代表中立。软件将计算出疲劳在该段视频的占比频率。状态分析结果示例图如 5-

10 所示。 

43 

 
 
 
重庆师范大学硕士学位论文                                                                              5  疲劳分析预警软件 

图 5-10  状态分析结果图 

5.4  软件适用性 

在输入视频中，为测试疲劳检测程度，录制了一段长度为 37.87 秒的短视频，

该视频中本人分别模拟了 30%左右的疲劳表情，15%左右的开心表情，25%左右的

惊讶表情，10%的其他表情。根据系统给出的表情分类，生气(标签 5)的占比高于

正常水平，可能产生的原因是生气表情与疲劳表情部分特征相似，但是偏离值不高，

疲劳表情也处于正常波动水平(0%-5%)，整体表情偏离值属于正常波动值，说明了

软件的有效性。视频疲劳表情帧如图 5-11 所示。在软件运行的过程中，界面显示

流畅，没有卡顿。 

44 

 
   
 
重庆师范大学硕士学位论文                                                                              5  疲劳分析预警软件 

图 5-11  疲劳表情图取帧 

5.5  本章小结 

本章主要是对基于 Gabor 尺度方向融合与随机森林分类的疲劳预警软件进行

阐述。简要介绍了软件的软件部分与硬件部分，以及系统工作的整个流程。从驾驶

时间方面和驾驶员面部疲劳特征方面对疲劳程度的判定方法进行了相应阐述。最

后通过实验测试了软件的运行能力，根据测试效果来看，软件操作简单，运行流畅，

界面反馈清晰合理。但是在部分表情存在判断失误的现象，在分类的准确率上还可

以进一步提高。在软件的鲁棒性上，未来还需进一步研究。 

45 

 
 
 
 
重庆师范大学硕士学位论文                                                                                          6  总结与展望 

6  总结与展望 

6.1 全文总结 

在我国疲劳驾驶造成的事故率越来越高，已经成为了驾驶事故原因中的主要

因素，伴随着计算机性能的不断发展，表情识别算法越来越丰富，以及对人脸表情

的深入研究，利用视频实时监控驾驶人员的疲劳状况已经成为可能。目前针对疲劳

驾驶主要根据头部的运动状态以及驾驶员嘴部与眼部的状态去分析目前疲劳状况，

但是该方法的滞后性非常明显，出现以上状态时已经可能随时发生事故，因此，本

文结合脸部表情检测方法，通过分析疲劳特征制造疲劳特征模型，在产生深度疲劳

前进行疲劳预警，可以更加有效的防止因疲劳驾驶所造成的事故，并在实验过程中

取得了一定的效果。为预防疲劳驾驶提供了有效的方法。 

本文首先对疲劳驾驶的背景和意义进行了研究，提出了在疲劳驾驶方面关于

目前疲劳识别的滞后性等待解决的问题，接着设计了本文的疲劳预警系统的系统

框架，对驾驶中监控的视频进行相应的预处理，人脸识别，灰度化，直方图均衡化

等预处理操作。获得可以提取特征及分类的实验图像。 

接着对人脸疲劳特征不易提取等问题进行算法的优化选择，通过 Gabor 融合

特征+分块直方图的方法充分提取人脸表情特征以及降低维度，减少数据冗余度，

优化数据处理时间。最后通过实验表明，Gabor 特征融合方法+分块直方图可以有

效的提取人脸表情特征。有利于接下来的表情分类。 

在表情分类方面，选择了目前效果最好的 SVM(支持向量机)以及随机森林方

法，通过准确率，召回率，分类时间的数据对比，选择了在人脸表情特征分类表现

更加优异的随机森林方法。该方法在识别基本表情和疲劳表情时的准确率可以达

到实验所需求的目标， 

最后设计了疲劳预警软件的总体框架，主要分类硬件部分与软件部分，在软件

部分设计了各个功能的相应模块，完成了整个疲劳软件的控制界面，通过实验的进

展，验证了本文系统的适用性和鲁棒性。 

6.2 展望 

虽然本文在人脸疲劳预警软件上取得了一定的成果，但是由于实验条件和时

间的限制，本文的系统设计还存在一些不足之处。为了使疲劳预警软件更加广发地

应用到驾驶的日常生活当中，在阅读了大量的相关文献基础上，对接下来的工作进

行了以下展望： 

46 

 
 
 
 
 
重庆师范大学硕士学位论文                                                                                          6  总结与展望 

(1)本文主要针对驾驶员在驾驶过程中正脸的表情识别情况，并未考虑到待测

人脸的姿态偏转和遮挡等相关问题。下一步工作将考虑出现以上情况时，利用相关

的算法进行人脸获取。提高表情识别在各种情况下的鲁棒性。 

(2)本系统目前处理的表情逻辑还不够完善，需要针对其他基本表情进一步分

析疲劳的判断条件。制定更加合理的疲劳判断逻辑。 

(3)目前的实验主要是在手机录取视频进行疲劳表情分析，为了后面可以应用

于实际的驾驶室内，需要进行仿真实验，根据实验结果继续改进疲劳预警软件，完

善相应功能。 

47 

 
 
 
重庆师范大学硕士学位论文                                                                                                  参考文献 

参考文献 

[1]  陈之坤,迟万达,高尚,刘晓欣,范迪.基于深度学习的疲劳检测算法[J].山东科技大学电信学

院,2020,(08):68-71. 

[2]  柳 龙 飞 , 伍 世 虔 , 徐 望 明 . 基 于 人 脸 特 征 点 分 析 的 疲 劳 驾 驶 实 时 检 测 方 法 [J]. 电 视 技

术,2018,(12):6-9. 

[3]  唐阳山,徐忠帅,杨语尧.基于面部表情的驾驶员疲劳特征提取[J].辽宁工业大学学报(自然科

学版),2018,(06):13-15. 

[4]  徐峰,张军平.人脸微表情识别综述[J].自动化学报,2017,43(3):333-348. 

[5]  王丽.智能服务机器人表情识别技术研究[D].黑龙江:哈尔滨工业大学,2015. 

[6] Luo Y, Zhang T, Zhang Y. A novel fusion method of PCA and LDP for facial expression feature 

extraction[J].Optik-International Journal for Light and Electron Optics,2016,127(2):718-721. 

[7]  吴彩明.人脸表情识别关键技术的研究与应用[D].重庆:重庆邮电大学，2013. 

[8]  陈丽渊.基于关键部位定位的人脸表情识别的研究与应用[D].上海:上海交通大学,2013. 

[9]  Darwin  C.The  expression  of  the  emotions  in  man  and  animals[M].London,UK:John 

Murray,1872:347-366. 

[10]  Jun  Wang,Xiaoping  Yu,QiangLiu,Zhou  Yang.Research  on  key  technologies  of  intelligent 

transportation  based  on  image  recognition  and  anti-fatigue  driving[J].EURASIP  Journal  on 

Image and Video Processing, 2019,17(1):1-13. 

[11] Suwa M, Sugie N, Fujimora K. A preliminary note on pattern recognition of human emotional 

expression[C]// Proceedings of the 4th International Joint Conference on Engineers,1978:408-

410. 

[12]  Mase  K,Pentland  A.Recognition  of  Facial  Expression  from  Optical  Flow[J].IEICE 

Transactions,1991,7(10):3474-3483. 

[13]  Lien-J-J-J.Automatic  Recognition  of  Facial  Expression  Using  Hidden  Markov  Models  and 

Estimation of Expression Intensity[M]. Pittsburgh, PA, USA: Carnegie Mellon University,1998. 

[14] Ahonen T,Hadid A,Pietikainen  M.Face  Description  with  Local  Binary  Patterns:Application  to 

Face  Recognition[J].IEEE  Transactions  on  Pattern  Analysis&Machine 

Intelligence, 

2006,28(12):2037-2041. 

[15] Jabid T,Kabir M H,Chae O.Robust Facial Expression Recognition Based on Local Directional 

Pattern[J].ETRI Journal,2010,32(5):784-794. 

[16]  闫保中,王晨宇.基于人眼特征的疲劳驾驶检测技术研究[J].应用科技,2020,01(9):47-54. 

[17]  王志良,陈锋军,薛为民.人脸表情识别方法综述[J].计算机应用与软件,2003,20(12): 63-66. 

48 

 
 
                                                                             
重庆师范大学硕士学位论文                                                                                                  参考文献 

[18]  徐文晖,孙正兴.面向视频序列表情分类的 LSVM 算法[J].计算机辅助设计与图形学学报，

2009,21(4):542-548. 

[19]  赵浩,吴小俊.基于改进联合模型的人脸表情识别[J].计算机工程,2010,36(6):206-209. 

[20]  谢尔曼,罗森林,潘丽敏.基于 Haar 特征的 Turbo-Boost 表情识别算法[J].计算机辅助设计与

图形学学报,2011,23(8):1442-1446. 

[21]  刘帅师，田彦涛，王新竹.基于对称双线性模型的光照鲁棒性人脸表情识别[J].自动化学

报,2012,38(12):1933-1940. 

[22]  易积政,毛峡,Ishizuka  Mitsuru,等.基于特征点矢量与纹理形变能量参数融合的人脸表情识

别[J].电子与信息学报,2013,35(10):2403-2410. 

[23]  徐峰,张军平.人脸微表情识别综述[J].自动化学报,2017,43(3):333-348. 

[24]  蒋胜利.浅析网络自主学习的监控明[J].现代教育技术,2004,14(5):46-48. 

[25]  汪 鹏 , 吴 昊 . 国 内 外 移 动 互 联 网 医 疗 应 用 现 状 及 未 来 发 展 趋 势 探 讨 明 . 中 国 数 字 医

学,2014,9(1):8-10. 

[26]  刘 梦 佳 , 赵 建 国 . 基 于 SVM 的 疲 劳 驾 驶 人 脸 图 像 特 征 检 测 算 法 [J]. 半 导 体 光

电,2020,10(02):278-282. 

[27] Lee I,Jung H,Ahn C H,et al.Real-time personalized facial expression recognition system based 

on  deep  learning[C]//2016  IEEE  International  Conference  on  Consumer  Electronics  (ICCE). 

IEEE, 2016: 267-268. 

[28]  周书仁,梁昔明,朱灿.基于 ICA 与 HMM 的表情识别团[J].中国图形学报，2008,13(12): 2321-

2328. 

[29]  胡敏,朱弘,王晓华等.基于梯度 Gabor 直方图特征的表情识别方法团.计算机辅助设计与图

形学报[J],2013,25(12):1856-1861. 

[30]  柴瑞敏,曹振基.基于 Gabor 小波与深度信念网络的人脸识别方法[J].计算机应用,2014, 

34(9):2590-2594. 

[31]  卢宏涛,张秦川.深度卷积神经网络在计算机视觉中的应用研究综述[J].数据采集与处理，

2016,31(1):1-17. 

[32]  张发光,赵晖.基于扩展 C 型 HMM 人脸表情识别[J].计算机应用与软件,2011,28(4):60-62. 

[33]  吴琼,李运田,郑献卫.面向非平衡训练集分类的随机森林算法优化.工业控制计算机 2013. 

26(7):89-90 

[34]  杜均.代价敏感学习及其应用[D].中国地质大学(武汉),2009 

[35]  雍凯.随机森林的特征选择和模型优化算法研究[D].哈尔滨工业大学,2008.12 

[36]  孙丽丽.基于属性组合的随机森林[D].河北大学,2011.5 

[37]  孙轶轩.基于数据挖掘的道路交通事故分析研究[D].[博士学位论文].北京:北京交通大

学,2014. 

49 

 
重庆师范大学硕士学位论文                                                                                                  参考文献 

[38]  袁翔,孙香梅.疲劳驾驶检测方法研究进展[J].汽车工程学报,2012,2(03): 157164. 

[39]  王小鹏,闰国梁,闰文秀.基于最大嫡分割和肤色模型的人眼定位[J].计算机工程.2010,36(14):

161-165. 

[40]  范九伦,赵凤.灰度图像的二维 Otsu 曲线阂值分割法[J].电子学报，2007,35(4):751-755. 

[41]  孙奇飞.人脸疲劳状态的识别与研究[D].广东:广东工业大学,2008. 

[42]  Collobert  R,Kavukcuoglu  K,Farabet  C.Implementing  neural  networksefficiently[M]//Neural

  Networks:Tricks  of  the  Trade.Springer,Berlin,Heidelberg,2012:537-557. 

[43]  Srivastava  N,Hinton  G,Krizhevsky  A,et  al.Dropout:A  Simple  Way  to  Prevent  Neural  Net

works  from  Overfitting[J].The  Journal  of  Machine  Learning  Research,2014,15(1):1929-19

58. 

[44] Prechelt  L.Early  Stopping-but When[M]//Neural  Networks:Tricks  of  the trade.Springer  Berlin 

Heidelberg,1998:55-69. 

[45]  Girdhar  R,  Ramanan  D.Attentional  Pooling  for  Action  Recognition[C]//Advances  in  Neural 

Information Processing Systems.2017:33-44. 

[46]  Bader.Nontraditional  tensor  decompositions  and  applications[J].Sandia  National  Laboratori

es,2010,51(3):455-500. 

[47]  陈晓敏.适用于疲劳驾驶检测的人眼定位与跟踪算法的研究与实现[D].沈阳:东北大学,201

0. 

[48]  修春波,任晓,成怡.人眼定位的边缘强度信息积分投影方法[J].计算机科学与探索,2015,(5):

421-428. 

[49]  王小鹏,闰国梁,闰文秀.基于最大嫡分割和肤色模型的人眼定位[J].计算机工程.2010,36(14):

161-165. 

[49]  屈肖蕾.基于转向操作和车辆状态的疲劳驾驶检测方法研究[D].[博士学位论文}.北京:清华

大学,2012. 

[50]  胡鸿,易灿南,廖远志等.疲劳驾驶研究进展综述[J].价值工程,2015,34(18):254-256. 

[51]  杨海燕,蒋新华,聂作先.驾驶员疲劳检测技术研究综述[J].计算机应用研究,2010,27(05): 

1621-1624. 

50 

 
 
 
重庆师范大学硕士学位论文                                                                                                      附录 A 

附录 A：作者攻读硕士学位期间发表论文及科研情况 

[1]王崴绪.基于图像边缘检测划分区域的密码[J].电子世界,2019,(7).

51 

 
 
 
                                                                                     
重庆师范大学硕士学位论文                                                                                                          致谢 

致  谢 

时光如梭，如歌。转眼间，两年的研究生求学生活即将结束，站在毕业的门

槛上，回首往昔，奋斗和辛劳成为丝丝的记忆，甜美与欢笑也都尘埃落定。重庆

师范大学以其优良的学习风气、严谨的科研氛围教我求学，以其博大包容的情怀

胸襟、浪漫充实的校园生活育我成人。值此毕业论文完成之际，我谨向所有关

心、爱护、帮助我的人们表示最诚挚的感谢与最美好的祝愿。 

本论文是在导师陈勇副教授的悉心指导之下完成的。两年来，导师渊博的专

业知识，严谨的治学态度，精益求精的工作作风，诲人不倦的高尚师德，朴实无

华、平易近人的人格魅力对我影响深远。导师不仅授我以文，而且教我做人，虽

历时两载，却赋予我终生受益无穷之道。本论文从选题到完成，几易其稿，每一

步都是在导师的指导下完成的，倾注了导师大量的心血，在此我向我的导师陈勇

副教授表示深切的谢意与祝福! 

非常感谢大家在我的毕业设计中，给予我极大的帮助，使我对整个毕业设计

的思路有了总体的把握，并耐心的帮我解决了许多实际问题，使我有了很大的收

获。同时，他们在整个开发过程中提出了许多建设性意见，并给我解决了一些专

业性问题。感谢多年来传授我知识的老师们，更要感谢那些对我学习上支持和鼓

励的人。同时感谢所有关心帮助过我的同学、老师和学校。 

总之，在以后的学习生活中我将以加倍的努力对给予我帮助的学校、老师及

同学们的回报。 

王崴绪  于实验室 

2020 年 4 月 1 日 

52 

 
 
               
 
 
 
 
 
 
 
 
 
 
