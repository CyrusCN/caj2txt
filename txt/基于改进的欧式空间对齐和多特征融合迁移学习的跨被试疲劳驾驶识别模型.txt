摘要I摘要目前驾驶员疲劳驾驶是导致交通事故的主要原因之一，通过对脑电信号进行分析来检测疲劳驾驶是一种可行的方法，然而现有方法对脑电信号进行跨被试分类时往往需要大量目标域数据用于校准，才能得到较好的分类性能。本文致力于使用少量校准数据的同时保证疲劳驾驶分类模型的跨被试分类性能，针对脑电信号具有个体差异性和低信噪比的特点，提出了基于改进的欧式空间对齐和多特征融合迁移学习的疲劳驾驶识别模型，提高了在少量校准数据条件下的跨被试分类性能。为降低不同被试之间的个体差异性，提高迁移学习跨被试分类识别准确率，本文使用欧式空间对齐的方法进行数据对齐。针对传统欧式空间对齐方法在校准数据较少时表现不佳的问题，提出了基于参考矩阵加权平均的两种改进方法，平均欧式空间对齐（AverageEuclidean-spaceAlignment，AEA）和加权平均欧式空间对齐（WeightedAverageEuclidean-spaceAlignment，WAEA），分别应用于零校准和有少量校准数据的情况。AEA使用源域数据的平均参考矩阵估计目标域参考矩阵，而当存在少量目标域数据用于校准时，WAEA使用矩阵之间的余弦相似度计算源域参考矩阵的加权平均，并利用权衡参数融合源域参考矩阵和目标域参考矩阵，以在少量的校准数据上得到较好的对齐结果，从而提高跨被试分类性能。实验结果表明，在5%的校准比例下，两种对齐方法在两种常用的机器学习和深度学习方法上得到的跨被试分类准确率比对齐前分别高5%和10%，且WAEA后使用模型迁移并微调所有卷积层的准确率提高了20%，说明了WAEA在迁移学习中的必要性。为提高模型对低信噪比信号的分类准确率，本文使用多尺度特征融合的方法提高模型特征提取能力，并结合WAEA和模型迁移学习提高跨被试疲劳驾驶识别性能。首先，本文在WAEA的基础上对模型预训练和微调策略进行了更深入的研究，选择了脑电领域常用的3种卷积神经网络，使用不同的预训练和微调策略得到一个共性特征提取网络并冻结其网络参数作为预训练模型。然后，在共性特征提取网络后连接多个不同深度的特性特征提取网络，将共性特征与特性特征拼接在一起使用多层感知机分类，并使用校准数据微调模型。最后，与单尺度特征分类算法和其他迁移学习算法进行了对比试验。结果表明本文提摘要II出的方法在不同的校准比例下结果最优，在5%的校准比例下得到的accuracy为95.08%、f1-score为95.05%、precision为96.11%和recall为94.34%，均优于各对比方法，能够使用较少的校准数据得到更优的分类性能。关键词：脑电图；疲劳驾驶；迁移学习；数据对齐；多特征融合AbstractIIIABSTRACTDriverfatigueiscurrentlyrecognizedasoneoftheprimarycausesoftrafficaccidents,andusingtheelectroencephalogram(EEG)signalstodetectdriverfatigueisaviablemethod.However,existingmethodsforcross-subjectclassificationofEEGsignalsoftenrequireasubstantialamountoftargetdomaindataforcalibrationinordertoachievesatisfactoryclassificationperformance.Inthispaper,anovelfatiguedrivingrecognitionmodelisproposed,whichisbasedonimprovedEuclideanspacealignmentandmulti-featurefusiontransferlearning.Theprimaryobjectiveofthismodelistoensurerobustcross-subjectclassificationperformanceforfatiguedriving,evenwhenlimitedcalibrationdataisavailable.Notably,thismodeltakesintoconsiderationtheindividualdifferencesandlowsignal-to-noiseratiocharacteristicsofEEGsignals,resultinginenhancedcross-subjectclassificationperformanceevenunderlimitedcalibrationdataconditions.Tomitigatetheindividualdifferencesbetweensubjectsandenhancetheaccuracyofcross-subjectclassificationintransferlearning,weemploytheEuclidean-spacealignmentmethodfordataalignment.ToovercomethelimitationsoftraditionalEuclidean-spacealignmentmethodswithlimitedcalibrationdata,weintroducetwoimprovedmethods:AverageEuclidean-spaceAlignment(AEA)andWeightedAverageEuclidean-spaceAlignment(WAEA),forzerocalibrationandlimitedcalibrationdatascenarios,respectively.AEAestimatesthereferencematrixofthetargetdomainbyaveragingthereferencematricesofthesourcedomaindata,whileWAEAcalculatestheweightedaverageofthesourcedomainreferencematricesusingcosinesimilaritybetweenmatricesandcombinesthesourceandtargetdomainreferencematriceswithaweightingparametertoachievebetteralignmentresultswithlimitedcalibrationdata,therebyimprovingthecross-subjectclassificationperformance.Testresultsdemonstratethatunderacalibrationratioof5%,thetwoalignmentmethodsachieve5%and10%highercross-subjectclassificationaccuracythancommonlyusedmachinelearninganddeeplearningmethodswithoutalignment,andtheaccuracyofmodeltransferandfine-tuningofAbstractIVallconvolutionallayersisimprovedby20%withWAEA,highlightingthenecessityofWAEAintransferlearning.Tofurtherenhancetheclassificationaccuracyofthemodelforlowsignal-to-noiseratiosignals,weincorporateamulti-scalefeaturefusionmethodtoenhancethemodel'sfeatureextractioncapability,incombinationwithWAEAandmodeltransferlearningtoimprovecross-subjectfatiguedrivingrecognitionperformance.Firstly,weconductin-depthresearchonthepre-trainingandfine-tuningstrategiesofthemodelbasedonWAEAandselectthreecommonlyusedconvolutionalneuralnetworksinthefieldofEEG.Weusedifferentpre-trainingandfine-tuningstrategiestoobtainacommonfeatureextractionnetworkandfreezeitsnetworkparametersasthepre-trainedmodel.Then,weconnectmultiplefeatureextractionnetworkswithdifferentdepthsafterthecommonfeatureextractionnetwork,concatenatethecommonfeatureswiththecharacteristicfeatures,andutilizeamulti-layerperceptronforclassification,andfine-tunethemodelwithcalibrationdata.Finally,wecomparetheproposedmethodwithsingle-scalefeatureclassificationalgorithmsandothertransferlearningalgorithms.Theresultsdemonstratethattheproposedmethodachievesthebestperformanceatdifferentcalibrationratios,withanaccuracyof95.08%,anf1-scoreof95.05%,aprecisionof96.11%,andarecallof94.34%atacalibrationratioof5%,outperformingthecomparedmethods.Thisindicatesthattheproposedmethodcanachievesuperiorclassificationperformancewithlimitedcalibrationdata.KeyWords:electroencephalogram;fatiguedriving;transferlearning;dataalignment;multi-scalefeaturefusion目  录 第1章 绪论............................................................................................... 1 1.1 研究背景和意义 ............................................................................... 1 1.2 国内外研究现状 ............................................................................... 1 1.2.1 主观评定法 ................................................................................. 2 1.2.2 客观检测法 ................................................................................. 3 1.2.3 基于脑电的疲劳驾驶检测方法 ................................................. 3 1.2.4 迁移学习在基于脑电的跨被试疲劳驾驶检测领域的研究 .... 5 1.3 目前存在的问题 ............................................................................... 6 1.4 本文主要研究内容 ........................................................................... 8 1.5 本文组织结构 ................................................................................... 8 1.6 本章小结 ........................................................................................... 9 第2章 相关知识介绍 ............................................................................ 10 2.1 EEG信号 ......................................................................................... 10 2.2 迁移学习理论 ................................................................................. 12 2.3 欧式空间对齐 ................................................................................. 13 2.4 评价指标 ......................................................................................... 14 2.5 本章小结 ......................................................................................... 15 第3章 基于改进欧式空间对齐方法的跨被试迁移学习 .................... 16 3.1 改进的欧式空间对齐 ..................................................................... 16 3.1.1 无目标域数据的对齐AEA ..................................................... 16 3.1.2 有少量目标域数据的对齐WAEA .......................................... 18 3.2 实验环境介绍 ................................................................................. 20 3.3 数据集介绍与预处理 ..................................................................... 20 3.3.1 数据采集 ................................................................................... 20 3.3.2 数据预处理 ............................................................................... 21 3.3.3 数据集划分 ............................................................................... 21 3.4 实验结果与分析 ............................................................................. 21 3.4.1 t-SNE协变量偏移可视化 ......................................................... 22 3.4.2 不同对齐方式在 CSP+LDA 下的分类性能 ......................... 23 3.4.3 不同对齐方式在 Deep Conv Net 下的分类性能.................. 27 3.5 本章小结 ......................................................................................... 31 第4章 基于WAEA和多尺度特征融合的迁移学习模型 ................... 32 4.1 融合迁移网络方法 ......................................................................... 32 4.2 共性特征提取网络的构建 ............................................................ 35 4.2.1 迁移模型的选择 ....................................................................... 35 4.2.2 预训练及微调策略的选择 ....................................................... 36 4.2.3 实验结果与分析 ....................................................................... 37 4.3 多尺度特征融合的迁移学习模型 ................................................ 40 4.3.1 模型的构建 ............................................................................... 40 4.3.2 实验结果与分析 ....................................................................... 44 4.4 本章小结 ......................................................................................... 48 第5章 总结与展望 ................................................................................ 49 5.1 总结 ................................................................................................. 49 5.2 展望 ................................................................................................. 50 参考文献 ................................................................................................... 51 第1章绪论1第1章绪论1.1研究背景和意义交通伤害是世界范围导致死亡的主要原因之一，其在所有死因中的占比排名一直在稳步上升[1]。此外，道路交通安全作为全球首要的公共安全问题之一，已成为继心脏病、癌症之后的又一重要人类死亡原因，给人们的生命和财产带来了巨大损失。根据世界卫生组织的统计，每年约有135万人死于道路交通事故[2]。众所周知，尽管机动车自动驾驶技术在近年来得到了长足的发展，驾驶员在驾驶机动车过程中仍起着至关重要的作用，这一行为需要驾驶员始终保持注意力高度集中的状态[3]，疲劳会使驾驶员无法保持这一状态从而提高发生交通事故的可能，因此疲劳驾驶是交通事故发生的重要原因[4]。有统计数据显示，有35-45%的道路交通事故是由疲劳驾驶引起的[5]，根据美国国家公路交通安全管理局的报告，由疲劳驾驶引起的交通事故每年至少导致1550人死亡，71000人受伤，并造成125亿美元的经济损失。虽然不同地区疲劳驾驶造成的事故比例从1%左右到20%左右不等[6]，但因疲劳驾驶造成的交通事故后果相对更严重，在死亡事故中占的比例也更高。这是因为与其他因素相比，疲劳更容易被驾驶员忽视[7]，增加了事故发生的可能性，对道路交通安全有严重的危害。随着中国经济的快速增长和居民生活水平的提高，2009年以来，中国汽车生产和销售的规模连续位居世界第一，汽车保有量以14.1%年增长率高速增长[8]，使得中国道路交通环境日益复杂。因此，面对日益拥挤的交通，开发和设计一套高效、准确的分析方法来检测驾驶员在驾驶过程中的疲劳状态，对于减少交通事故的发生和改善道路安全环境具有重要意义。1.2国内外研究现状针对疲劳驾驶状态的检测，国内外众多学者均进行了相关的研究。目前，驾驶员疲劳状态的检测大致可以分为主观评定法和客观检测法两大类[9]，如图1.1所示。第1章绪论2图1.1疲劳驾驶的检测方法1.2.1主观评定法疲劳驾驶检测的主观评定法通过驾驶员填写心理测量问卷或他人对驾驶员的评价来判断疲劳程度。常用的心理测量问卷有：斯坦福嗜睡表（StanfordSleepinessScale，SSS）[10]、卡洛琳斯卡睡眠尺度表（KarolnskaSleepinessScale，KKS）[11]、视觉类比量化表（VisualAnalogueScales，VAS）[12]等。他人对驾驶员的评价主要由受训练的专家对驾驶员的面部特征和行为姿态进行疲劳评定来进行。基于主观评定的疲劳检测方法的优点是：操作简单、成本低并且容易实施。其缺点首先是驾驶员被专家询问时会刺激驾驶员，对当下的疲劳状态产生影响，导致对判断疲劳的准确度不高。其次，该方法只能离线检测、实时性差，在实际驾驶环境中，当驾驶员出现疲劳状态时不能及时评定并给予预警，只能用作实验室场景下事故的事后评估和复盘。第1章绪论31.2.2客观检测法疲劳驾驶检测的客观检测法通过检测客观特征来判断驾驶员是否疲劳，根据检测特征的不同又可分为基于非生理信号的疲劳驾驶检测和基于生理信号的疲劳驾驶检测。其中，常用于检测疲劳的非生理信号多集中在驾驶员的面部和头部，因为这里显示出的疲劳特征是最明显的，包括驾驶员闭眼的频率[13]、驾驶员打哈欠和张嘴的频率[14]、驾驶员面部物理特征[15]等，另外方向盘移动角度[16]和车道偏差[17]等车辆特征也被用于进行疲劳驾驶检测。上述方法在特定场景下检测疲劳驾驶有较好的效果，然而检测效果受外部环境影响较大，基于驾驶员的面部和头部特征检测方法在不同光照条件下的适用性有限，对佩戴眼镜的驾驶员效果也不够理想，基于车辆特征的疲劳驾驶检测方法准确率还需进一步提升，且该方法并不是直接检测疲劳驾驶本身，而是通过检测疲劳驾驶时车辆运行轨迹可能存在的特征，检测上存在一定滞后性，往往检测到疲劳时已经为时已晚，对于避免事故的发生作用有限。不同于基于非生理信号方法间接检测疲劳的“舍近求远”，已经有大量研究证实生理信号在疲劳产生前后波动较大，为疲劳早期发作提供了良好指示，可用于预防事故发生，因此能够通过分析生理信号对疲劳驾驶状态进行直接检测和判定。常用于检测疲劳的生理信号主要包括心电图（electrocardiograph，ECG）、脑电图（electroencephalography，EEG）和眼电图（electro-oculography，EOG）、肌电图（electromyography，EMG）等。这些生理信号已被广泛用于识别和检测人类状态[18-21]，能够精确、可靠的反映驾驶员的真实状态，为疲劳驾驶检测提供支撑。在这些生理信号中，EEG在检测驾驶员状态的任务上表现最好，可以更直观地反映人脑的生理活动，因此可以用于对驾驶员状态进行感知和分析。此外，脑电图具有对伪影有很强的免疫力，因此检测结果更加准确[22]。与其他生理信号相比，由于EEG具有时间分辨率高、无创性、低成本等特性，其被称为评价人类认知状态的“金标准”[23]，因此，EEG成为未来智能交通辅助驾驶领域关注的焦点。通过探索驾驶员EEG与驾驶状态之间的内在关联，可以实现对驾驶员状态精准检测，为避免疲劳驾驶提供有效方法，进而减少交通事故的发生和改善道路安全环境。1.2.3基于脑电的疲劳驾驶检测方法由于基于EEG的疲劳驾驶检测方法具有客观性、准确性等优点[24]，国内第1章绪论4外就使用EEG对疲劳驾驶状态检测进行了一系列研究。现有的EEG疲劳驾驶检测方法多通过选择合适的特征和分类器来开展研究。常用的特征提取方法包括共空间模式（CommonSpatialPattern，CSP）[25]、小波变换（WaveletTransform，WT）[26]、功能脑网络（FunctionalBrainNetwork，FBN）[27]、功率谱密度（PowerSpectralDensity，PSD）[28]等。常用的分类器有使用支持向量机（SupportVectorMachine，SVM）[29]、线性判别分析（LinearDiscriminantAnalysis，LDA）[30]、随机森林（RandomForest，RF）[31]等方法。另外随卷积神经网络方法的迅速发展，使用卷积神经网络（ConvolutionalNeuralNetwork，CNN）[32]来完成对原始脑电数据的特征提取和分类任务也逐渐应用于疲劳驾驶检测领域。具体来说，Mu等人[33]评估了基于熵的特征提取方法的可行性，选择谱熵、近似熵、样本熵和模糊熵四种熵值提取驾驶疲劳特征，并筛选了部分电极用SVM分类器进行分类，在自建数据集上得到的平均识别准确率为98.75%。针对SVM在处理高质量数据时表现良好，但面对复杂数据时表现不佳的问题，San等人[34]提出了一种混合深度遗传模型来弥补SVM在处理复杂不变性方面的不足，并用于疲劳驾驶任务的检测。Zou等人[35]提出了一种基于最短路径树组合构造功能脑网络的方法，并将其应用于疲劳驾驶状态识别和疲劳驾驶神经机制分析。Subasi等人[36]使用小波变换的方法，对疲劳驾驶脑电信号进行分类，得到了最高97%个体内准确率。Chen[37]等人将同步似然与最小生成树相结合，并将其应用于特征识别和分类。Zeng等人[38]提出了一种基于LightGBM算法的驾驶员状态检测方法，使用CSP提取到的特征与SVM、LDA等传统分类器相比，在分类和决策效率方面获得了更好的性能。Lin等人[39]综合考虑脑电图的频率、时间和二维空间信息，提出了一种4D卷积神经网络算法，将脑电图信号中的所有信息与人体状态和行为表现的变化联系起来，揭示了不同的疲劳水平下大脑前额和后扣带皮层部分频段脑电的显著激活。Mora[40]等人将脑电图转化为二维矩阵张量用于训练CNN来对疲劳驾驶进行检测，用4个电极取得了84%以上的准确率。这些研究不仅为解决基于EEG的疲劳驾驶检测提供了可供参考的方法，同时也印证了EEG的变化与疲劳的高度相关性。然而上述研究虽然在各自场景下对疲劳驾驶识别都有一定的效果，但多集中在同一被试情况下的EEG分析检测，面对训练数据和测试数据来自不同被试的跨被试疲劳驾驶识别问题时效果往往不尽人意。这是由于EEG信号具有非稳态、非线性、非高斯和高度个体差异性第1章绪论5的特点，在跨被试分析中会出现协方差偏移和低信噪比的问题，导致跨被试EEG分类准确率较低，因此上述方法对于跨被试的疲劳驾驶识别效果有限。对于新的被试往往需要重新采集大量校准数据构建模型，该过程被称为模型校准，模型校准制约了基于EEG的疲劳驾驶检测的发展，研究如何使用少量的校准数据得到更高的跨被试分类准确率已经成为目前的研究热点。1.2.4迁移学习在基于脑电的跨被试疲劳驾驶检测领域的研究在基于EEG的跨被试疲劳驾驶检测中，由于EEG具有个体差异性，训练数据（源域）和测试数据（目标域）往往不遵循同一分布，这导致一些经典的机器学习方法效果较差，由于迁移学习具备从其他领域学习的能力，因此迁移学习方法可以在一定程度上提高基于EEG的跨被试疲劳驾驶检测分类性能[41]。最近，已经有许多使用迁移学习方法对EEG信号进行跨被试分析，并取得优异结果的研究。具体来说，Zeng等人[43]基于在图像识别领域表现优秀的迁移学习模型EasyTL，提出了其改进InstanceEasyTL并用于跨被试疲劳驾驶分析，结果显示该方法相对于传统的SVM及域对抗神经网络等机器学习模型相比，仅需要较少的校准数据就能得到不错的准确性和鲁棒性。Liu[44]等人提出了一种无需校准的迁移学习方法，采用最大独立域自适应和转移成分分析的方法进行EEG的跨被试疲劳驾驶识别，然而其准确率仅有73.01%。Shalash等人[45]将采集到的脑电信号预处理后转换为二维频谱图，并通过预训练的AlexNet对其进行分类，并进行了通道约减的研究，在疲劳驾驶数据集上得到的准确率超过90%。Lan等人[46]在疲劳驾驶数据集上评估了三种经典分类方法：经典分类器、迁移组件分析的分类器以及以及基于深度学习的分类器。研究结果表明，基于迁移学习的分类器在跨被试疲劳驾驶识别任务中的表现优于其他两种分类器，得到跨被试识别准确率为72.70%，比使用经典分类器和深度学习的方法分别提高分别提高9.08%和12.86%。迁移学习的方法已在多个领域被证实有效，能够在一定程度上提高EEG的跨被试分类性能，但是在跨被试疲劳驾驶的研究上还比较少，距离走向实际应用还有许多问题，如校准数据需求量大、特征提取能力不足等。因此本文使用迁移学习的方法从其他被试中学习分类特征，以提高在校准数据量较少情况下的基于EEG的跨被试疲劳驾驶分类准确率。第1章绪论61.3目前存在的问题传统的EEG分析方法主要还是集中在单一被试的研究，对跨被试的研究还比较少。单一被试EEG分析的好处是识别准确度更高，然而在EEG的实际应用场景中更需要跨被试的分析。由于EEG具有非稳态、非线性的特点，不同被试之间的脑电信号存在差异[47]，甚至同一被试的EEG信号随着时间的变化也会发生改变[48]，这使得传统的分析方法在跨被试的应用场景下容易产生不准确的分析甚至错误的决策。具体来说，在构建基于EEG的跨被试分析方法中具有以下困难：（1）协变量偏移（CovariateShift）：对于有监督式机器学习，一般准则和假设为训练数据与测试数据这两个分布是独立同分布的，即用于训练的输入分布푃푇푅(푥)等于用于测试的输入分布푃푇퐸(푥)，当这两个分布不同时，大多数机器学习模型的性能通常会下降。这种形式的数据集移位称为协变量偏移。发生这种情况的原因有很多，例如训练和测试数据来自不同的人群、试验和观察的数量缺乏随机性、数量不足或其他有偏见的抽样措施；在EEG试验中，协变量偏移是由于个体差异和非稳态性引起的[49]。图1.2显示了一个协变量偏移的例子，图上的圆圈和三角为EEG数据，灰色和黑色表示来自不同的被试，圆圈和三角表示两个不同的类别，假设要将图上数据按类别进行分类，显然分类边界遵循函数푦=−푥3。然而当我们仅以灰色部分数据为训练数据集训练模型时，可以得到许多合适的分类边界，例如푦=푥2/3或푦=2푥同样在区分灰色数据中的两个类别时分类性能良好，但是푦=푥2/3或푦=2푥对于黑色的测试数据并不是一个合适的分类边界，并且在训练期间机器学习算法很难在仅使用训练数据的条件下发现更复杂的底层鉴别函数푦=−푥3。因此，当训练数据的特征分布与测试数据的特征分布不同时，仅在训练数据上训练的模型对测试数据的分类表现不佳，体现在EEG上就是使用一个被试数据构建的模型在另一被试的EEG数据上分类效果不佳，甚至使用同一个被试不同时间采集的数据得到的效果也不尽人意。由于协变量偏移是训练数据和测试数据分布不同引起的，有许多方法可以检测协变量偏移。对于给定的两个数据集푃푇푅(푥)和푃푇퐸(푥)，一种检测协变量偏移方法是通利用降维技术对低维空间中的分布进行可视化。诸如t-分布随机邻接嵌入（t-DistributedStochasticNeighborEmbedding，t-SNE）、多维缩放、等距映射等多维学习技术在这方面非常有用，因为它们可以捕捉到数据中的非线第1章绪论7性信息。其中t-SNE是一种无监督的机器学习算法，被广泛用于数据可视化，因为它对局部结构特别敏感，可以减少点向低维空间中心聚集的趋势，能直观的观察高维数据的低维分布，通过t-SNE我们能看到高维空间不同输入分布的差异，从而观察到协变量偏移的程度。图1.2协变量偏移示意图（2）低信噪比：利用EEG进行分析和分类的另一个挑战是EEG的信噪比较低，由于EEG的非稳态性、非线性和非高斯的特点，很难从中过滤出对特定任务敏感的信息，这使得EEG分类模型必须具有更好的特征提取能力，需要能够提取复杂的非线性特征。EEG的低信噪比是由多种内部和外部原因引起的，例如导致神经元集合状态持续变化的大脑活动、用户注意力水平、用户疲劳、使用的传感器设备以及电极的头皮放置等[50]。近年来深度神经网络因其具有强大的特征提取能力在图像识别、语音识别等领域大放异彩，在EEG领域也表现出优异的分类性能，然而使用深度神经网络对EEG进行分类研究时，特别是在进行跨被试分类的研究时，往往会出现数据不足的问题，许多研究指出较小的EEG数据集对于估计大脑状态有不利影响[51]，这使得深度学习虽有强大的特征提取能力，但在跨被试EEG分类领域表现平平。以上困难使得对于新被试的EEG数据，很难直接使用在其他被试EEG数据上训练好的模型进行分析，往往需要收集大量新被试的EEG数据用于校准模型，在这种情况下，收集校准数据和模型重新训练的昂贵成本阻碍了EEG的发第1章绪论8展。因此，如何克服EEG的个体差异性，利用其他被试的EEG数据进行跨被试分析成为了研究热点，由于迁移学习已被证明在图像识别和分类领域具有一定跨域学习能力，使用迁移学习对EEG数据进行跨被试分析成为一种可行的方法。1.4本文主要研究内容针对基于EEG的跨被试疲劳驾驶识别效果不佳的问题，本文提出基于改进的欧式空间对齐和多尺度特征融合的迁移学习方法，提升在少量校准数据条件下的跨被试EEG分类性能。本文的主要研究内容如下：（1）改进欧式空间对齐算法。针对传统欧式空间对齐算法存在需要目标域全部数据计算参考矩阵用于对齐，仅有少量数据时对齐后得到的准确率较低，且只能用于事后评估疲劳驾驶而不能及时检测的问题，提出了两种使用源域数据估计平均参考矩阵，并将其用于对齐的方法，有效降低了不同被试之间的个体差异性，提高了迁移学习方法的跨被试分类性能。（2）模型预训练和微调。对EEG领域常用的3种模型进行预训练，使用更细致的逐层微调策略对预训练模型进行微调，进一步提高了迁移学习的跨被试分类性能。（3）构建基于欧式空间对齐的多尺度特征融合迁移学习模型。针对跨被试EEG分析中低信噪比的问题，构建共性特征提取网络和特性特征提取网络，并融合多尺度特征，提高模型的特征提取能力，尽可能从有限的数据中学习更好的特征用于分类，并结合迁移学习中的微调方法提高跨被试的分类性能。1.5本文组织结构本文共分为5个章节：第1章介绍了选题的背景及意义，疲劳驾驶状态识别方法的研究现状以及本文的主要研究内容。第2章阐述了本文所使用方法的理论知识，如EEG信号的自有特点及迁移学习和欧式空间对齐的相关知识。第3章介绍了对欧式空间对齐的改进，提出了在零校准下和有少量目标域数据作为校准数据的两种对齐方法，并在真实采集的数据上进行了一系列实验，第1章绪论9证明了本文提出的对齐方法在机器学习和深度学习上都有一定提高，特别是使用迁移学习中的微调方法效果显著。第4章对第3章中使用的微调方法进行了更深入的研究，对比了不同模型在不同微调策略下的表现，并从中选择共性特征提取网络，结合多个特性特征提取网络提取多尺度特征融合用于分类。通过在真实采集的数据上进行测试并与其他迁移学习的方法进行对比证明了我们提出的方法的先进性。第5章首先对本文的工作进行了总结，然后对本文工作存在的不足之处进行了反思并对下一步工作方向进行了展望。1.6本章小结本章首先介绍了本文的选题背景及意义，然后介绍了疲劳驾驶状态识别的国内外研究现状及方法，其中基于EEG的疲劳驾驶检测方法是本文研究的主要对象。随后指出了EEG跨被试分类的重要性和迁移学习在EEG跨被试分类中的研究现状，接着通过总结EEG跨被试分类存在的困难引出本文的主要研究内容和研究方法，最后介绍了本文的组织结构。第2章相关知识介绍10第2章相关知识介绍2.1EEG信号人脑中有超过1000亿个神经元，这些神经元的活动正是大脑正常运作、处理信息和产生行为的基础。神经元通过电化学信号相互交流，这些信号的活动模式构成了大脑所有功能的基础，包括感知、记忆、思维和情感。当大脑中的神经元相互交流时会产生电脉冲，这些电脉冲可以被放置在头皮上的电极检测到，然后被记录为一系列的波形，而这些波形组成了EEG。通过分析EEG，我们可以得到与大脑相关的生理状态和功能状态的宝贵信息，如睡眠质量、认知能力和情绪，完成对大脑状态的判断。该技术最早由德国神经学家HansBerger于1924年开发[52]，此后成为神经科学和医学领域的一个广泛使用的工具。目前，EEG被广泛用于脑部疾病的诊断鉴别和思维活动的研究，包括运动想象、情绪识别、癫痫检测、睡眠质量评估、疲劳检测等方面。EEG信号通过在放置在头皮上的电极来采集，图2.1显示了最初由Jasper在1958提出的10-20系统[53]，该系统是国际公认的描述脑电头皮电极位置的方法之一，它指定了头皮上75个电极的标准化位置，因每个电极分别位于经纬度线上的10%和20%处得名。另外，为了获得更高的空间分辨率，可以在10-20系统中添加额外的电极，从而构成更密集的电极网络，如10-10或10-5系统。然而，考虑被试的使用感受和脑电设备的应用前景，许多研究者转向使用更少的通道来完成相应的任务，如仅使用前额电极完成运动想象或情绪的检测任务。EEG信号的特点可归纳为以下三个方面：首先，大脑信号是复杂的，这导致了EEG信号的非平稳性、非线性和非高斯性[54]。其次，EEG信号具有高度差异性，这表现在不同个体对于同一事件的脑电图信号可能不同，甚至同一个体在不同时间对同一事件的EEG信号也可能不同[55]。最后，脑电图信号具有很高的噪声，容易受到人为干扰而失真，因此，很难从EEG信号中提取与特定任务相关的有效信息。第2章相关知识介绍11图2.110-20系统电极放置位置示意图目前，对EEG进行分析一般通过信号预处理、特征提取、分类几个步骤完成。（1）预处理：EEG在采集过程中受到颅骨和噪声干扰，信号微弱、信噪比低。因此，需要对信号进行预处理，减少各种噪声干扰，提高信噪比。人工伪迹是最常见的噪声，包括生理伪迹和非生理伪迹。非生理伪迹可通过滤波和改善实验方法来控制，生理伪迹可以通过低通滤波器和眼电参考信号来去除。空间滤波也是提高信噪比的方法，包括共同平均参考、Laplace滤波和独立成分分析[56]，良好的EEG信号预处理是对EEG进行有效分析和解读的前提。（2）特征提取：由于EEG数据是多通道高维数据，预处理后通常还要提取特征用于分类。常用的人工特征提取方法包括时域分析、频域分析、时频分析和空间分析。时域分析主要研究信号在时域上的特征，比如峰值检测、平均第2章相关知识介绍12值检测、方差分析等；频域分析主要通过对信号进行频谱上的分析，将信号分解为不同频率的信号得到特征，常用的方法有傅里叶变换和功率谱估计等；时频分析是指同时在时域和频域上对信号进行分析并提取特征，能够有效提取非平稳信号的特征，常用的方法有小波变换和短时傅里叶变换等；空间分析则是研究脑电的空间信息，主要针对脑电的通道进行研究，对神经活动进行定位，常用的方法有独立成分分析和共同空间模式等。这些特征提取方法可以为后续的数据分析和建模提供有效的支撑。（3）分类：近年来为了使用EEG分析和识别人脑状态，人们采用了许多经典的机器学习算法对提取到的特征进行分类，如支持向量机、线性判别分析、K近邻等，另外使用深度神经网络对EEG完成端到端的分析也有一定研究，如使用长短时记忆网络[57]和卷积神经网络[58]对EEG自动地提取特征并分类。2.2迁移学习理论迁移学习理论最早可以追溯到1995年NIPS95研讨会上首次被提出的“学会学习”概念，即“在一个领域中学到的知识应用到一个不同但相关的领域”，这个概念被广泛引用，并成为了迁移学习的基石之一。近年来迁移学习发展迅速，在计算机视觉、自然语言处理、语音识别等领域都有应用，在EEG领域也有相关研究。迁移学习可以被简单地定义为从源域中学习，并在有少量或没有数据的目标域中进行预测，即源域数据作为训练数据，目标域数据作为测试数据。目前迁移学习的方法主要包括3种：基于实例的迁移方法、基于特征的迁移方法和基于模型的迁移方法。为提升迁移学习的迁移效率，学者们进行了大量的探索研究。基于实例的迁移方法主要通过对源域数据进行加权，提高源域数据分布与目标域数据分布之间的匹配度进而提高迁移效率。该方法通过一定的方式评估源域中的实例与目标域数据的匹配度，并生成实例权重，使得权重高的实例与目标域更匹配，换句话说就是在训练中重用那些与目标域数据更相似的数据。关于如何选择更相似的数据可以利用生成对抗网络中的判别器[59]，也可以使用相关的距离度量，如KL散度和最大均值差异（Maximummeandiscrepancy，MMD）[60]，在基于实例的迁移方法中，选择合适的分布间评价指标是影响其第2章相关知识介绍13效果的关键因素。基于特征的迁移方法将源域特征空间映射到目标域特征空间上，或者将源域和目标域都映射到同一子空间上来提高迁移效率，映射后的源域和目标域分布更相似，使用映射后的源域数据训练的模型在映射后的目标域数据上表现良好，典型方法有在黎曼空间上把不同被试的样本协方差对齐（RiemannianspaceAlignment，RA）[61]和在欧几里得空间上的对齐（Euclidean-spaceAlignment，EA）[62]。EA相对于RA取得了更好的计算性能，同时在准确率上有一定提高，已经在多个领域上得到应用，我们将在2.3节中详细介绍EA。基于模型的迁移方法假定各个任务的各个模型应该共享一些参数或超参数的先验分布，并通过共享这些模型参数来提升迁移效率。基于模型的迁移学习的思想是，预训练模型已经学习了源域中的有用特征和模式，可以应用于目标域以提高分类性能。通过使用预训练模型，目标模型可以从源模型已经学习到的相关知识中获益。有几种方法可以实现基于模型的迁移学习，其中微调是最常用的一种。微调指在源域上训练一个预训练模型，接着继续在目标域上训练全部或者部分网络参数[63]，微调具有操作简单和快捷有效的特点，已经在图像识别和语音识别等多个领域得到应用。在数据有限的新被试中，微调可以有效提高模型在目标域上的分类性能，然而这需要仔细考虑预训练模型与新被试之间的异同，以及可用训练数据的数量和质量。2.3欧式空间对齐EA的基本思想是使不同被试的数据分布更加相似，因此在源域数据上训练的分类器，能够在目标域上表现出更好的分类效果，这个想法在迁移学习中得到了广泛的应用。在EEG分类任务中，由于EEG信号的样本协方差矩阵能够反映EEG信号通道之间的关系，还包含了一定的空间和时间信息，在不同的EEG分类任务中被广泛使用。EA计算每个被试的平均样本协方差矩阵，再经过数据对齐，使每个被试的样本协方差矩阵等于单位矩阵，使对齐的EEG样本被白化，在这里白化指的是机器学习中常用的数据预处理方法，它可以降低数据的冗余性，有利于后续的特征提取和分析。为了更好说明EA，假设源域中有m个被试，目标域中有1个被试，每个被试具有N个样本1{}NiiX，其中每个样本iX维度为nT，n为脑电通道数，T第2章相关知识介绍14为采样点个数。EA的过程如式2.1-式2.2所示：（1）计算一个被试的平均协方差矩阵R：11 TNiiiRXXN(2.1)（2）将R作为参考矩阵，对该被试所有样本执行对齐计算：1/*2iiXRX(2.2)式中，푋푖∗为对齐后的EEG信号。（3）对源域和目标域的所有被试都重复上述操作。经过EA后，一个被试所有N个对齐样本的平均协方差矩阵为：**1/21/21111NNTTiiiiiiXXRXXRINN(2.3)式中，퐼是单位矩阵。经过EA对齐算法后，所有被试的平均样本协方差矩阵等于单位矩阵，因此来自不同被试的空间协方差矩阵的分布会更相似。鉴于样本协方差矩阵是EEG信号的一个重要统计量，用户间的差异也会变小，这正是迁移学习所需要的效果。由于EA对齐算法不仅能够有效减少EEG数据之间的差异性，使来自不同被试的EEG数据的特征分布更加相似，而且因为EA在欧式空间进行计算，其计算效率较高，该对齐操作的效果在传统机器学习和深度学习方法上都得到了验证。然而通过式2.1可以看出EA对齐算法需要使用全部数据计算参考矩阵，而数据较少时计算得到的参考矩阵往往不能很好的体现数据的全局特征，这使得该算法在许多领域不适用。比如在疲劳驾驶检测领域上EA仅能用于事后评估，不能起到及时检测的作用，因此我们提出了对EA算法的改进，使其能用于少量或者没有目标域数据上的对齐，这将在3.1节中详细描述。2.4评价指标疲劳驾驶检测任务实际上是一个二分类任务，本文规定疲劳的标签为1，代表阳性样本，非疲劳标签为0，代表阴性样本。则其评价指标包括准确率（accuracy）、F1值（f1-score）、查准率（precision）和召回率（recall），计算公式分别见式2.4、2.5、2.6、2.7。第2章相关知识介绍15    TPTNaccuarcyTPTNFPFN预测正确的样本数总样本数(2.4)f1-22precisionrecallTPprecisionrecallTPTNscore样本数(2.5)1=1TPprecisionTPFP预测为且正确预测的样本数所有预测为的样本数(2.6)11TPrecallTPFN预测为且正确预测的样本数真是情况下所有为的样本数(2.7)式（2.4）-式（2.7）中TP表示被判定为疲劳样本，事实上也是疲劳样本的个数；TN表示被判定为非疲劳样本，事实上也是非疲劳样本的个数；FP表示被判定为疲劳样本，但事实上是非疲劳样本的个数；FN表示被判定为非疲劳样本，但事实上是疲劳样本的个数2.5本章小结本章介绍了EEG信号的相关知识，包括EEG的产生机理、采集方式、电极摆放位置等。接着介绍了EEG信号具有非稳态、非线性、非高斯、差异性和低信噪比的特点。再描述了EEG预处理，特征提取，分类的分析流程和常用方法。随后介绍了迁移学习中基于实例、基于特征和基于模型的三种迁移方法以及欧式空间对齐方法。最后介绍了疲劳驾驶检测任务中的评价指标。第3章基于改进欧式空间对齐方法的跨被试迁移学习16第3章基于改进欧式空间对齐方法的跨被试迁移学习从实际应用场景出发，利用其他被试的数据在较少的校准数据下进行跨被试分析成为当下研究热点。使用迁移学习对EEG数据进行跨被试分析成为一种可行的方法，然而对EEG使用迁移学习时同样会遇到个体差异性带来的协变量偏移的问题，这在本文1.3节中已有描述。一个减少协变量偏移的有效方法是EA，即在欧式空间中将所有被试的EEG信号通过参考矩阵对齐，使得不同被试之间的信号特征更相似，这能够在一定程度上缓解协变量偏移的问题，不过EA的计算方式决定了该方法在少量校准数据下无法得到可靠的参考矩阵，对齐的效果不尽人意，且只能用于事后评估。为此我们改进了EA，使其在少量目标域数据作为校准数据下的跨被试分类性能更佳。本章使用改进的欧式空间对齐方法在零校准和有少量校准数据的场景下降低协变量偏移、克服个体差异性，并结合迁移学习中的模型迁移方法进行跨被试EEG分析，验证本文提出的两种对齐方法在迁移学习中的有效性。3.1改进的欧式空间对齐针对EA需要使用全部目标域数据计算参考矩阵，在使用少量数据计算时，偏差较大的问题，本文提出两种使用源域中的参考矩阵来估计目标域的参考矩阵的方法，分别是在无目标域数据下使用的平均欧式空间对齐（AverageEuclidean-spaceAlignment，AEA）和在有少量目标域数据下使用的加权平均欧式空间对齐（WeightedAverageEuclidean-spaceAlignment，WAEA），分别对应疲劳驾驶检测中零校准和有少量目标域数据作为校准数据的场景。正如本文在2.2节中提到的，迁移学习中使用目标域数据作为测试数据，源域数据作为训练数据，故本文所指的目标域数据均为目标被试的EEG数据，源域数据为除目标被试之外被试的EEG数据。3.1.1无目标域数据的对齐AEAEA算法的对齐依赖由被试全部数据计算的协方差矩阵作为参考矩阵，当完全没有目标域数据时，直接计算目标域数据的参考矩阵也就成了无稽之谈，第3章基于改进欧式空间对齐方法的跨被试迁移学习17然而，我们可以通过源域数据的参考矩阵来估计目标域上的参考矩阵，本节提出一了种使用源域数据上的平均欧式空间对齐AEA的方法。假设源域中有m个被试，目标域中有1个被试，每个被试都具有N个样本{푋푖}푖=1푁，样本푋푖维度为n×T，n为脑电通道数，T为采样点个数，与进行EA时不同的是，在训练模型的时刻只有源域中数据可用，目标域中数据不可用，只有当模型训练结束时才能逐步获取目标域数据，该条件是为了模拟疲劳驾驶检测时的无校准检测情况。此时AEA对齐方式如式3.1-式3.3所示：（1）源域中样本的对齐同EA，即根据式2.1计算源域中m个被试的平均协方差矩阵，得到对应的m个参考矩阵：11NTkiiiRXXN(3.1)式中，1,2,,km。（2）对源域中m个被试的样本根据式2.2使用其对应的参考矩阵对齐，同时计算平均源域参考矩阵푅￿代替目标域的参考矩阵：11mkkRRm(3.2)（3）利用푅￿对目标域中样本푋푖对齐得到푋푖∗：*1/2iiXRX(3.3)在模型训练阶段由于源域中样本完整，使用EA能够更好的提取特征用于后续分类，而目标域中没有数据无法计算参考矩阵，故使用源域中所有参考矩阵计算平均参考矩阵푅￿，当需要对目标域数据进行预测时先用平均参考矩阵푅￿对原始数据变换，再送入模型中预测。该方法使用的参考矩阵为所有源域被试的平均，经过变换后的目标域数据分布也会与源域数据更相似，在没有使用目标域数据训练的情况下相对使用原始数据能够取得更好的效果，提供了在完全没有目标域数据情况下的一种对齐方法，然而该方法不加判别地使用源域中全部被试的参考矩阵用于对齐目标域数据，这可能会导致负迁移的问题，使用与目标域数据分布差别过大的源域数据对齐会对最后的预测结果产生不利影响。第3章基于改进欧式空间对齐方法的跨被试迁移学习183.1.2有少量目标域数据的对齐WAEA当有少量目标域数据时可用，应当充分利用该部分数据进行对齐，然而传统EA仅用少量目标域数据计算得到的参考矩阵不能很好的代表目标域上的数据分布，为降低数据过少时计算参考矩阵的偏差，考虑使用源域中参考矩阵进行辅助，并利用矩阵之间的余弦相似度作为权值，进行加权平均欧式空间对齐WAEA。同样假设源域中有m个被试，每个被试具有N个样本{푋푖}푖=1푁，目标域中有1个被试，也具有N个样本{푋푖}푖=1푁，但是在模型训练阶段仅有M（M<<N）个样本{푋푖}푖=1푀可供使用，在模型训练结束后，剩余N-M个样本{푋푖}푖=1푁−푀将被用于测试，该条件是为了模拟疲劳驾驶EEG检测中有少量样本供校准的情况。WAEA具体对齐步骤如式3.4-3.10所示：（1）由于源域数据全部可用，首先对源域数据进行EA，分别计算源域中m个被试的参考矩阵记为12,mRRR，并对源域中每个被试数据对齐，方法同2.3节。（2）利用目标域中可用的M个样本计算目标域参考矩阵TR：=11MTTiiiRXXM(3.4)式中，TR为通过目标域中少量数据计算得到的目标域参考矩阵，由于使用的数据较少，不能很好的反映目标域上数据分布，且具有较大波动性，考虑加入源域中被试的参考矩阵用于对齐。（3）由于已经有部分目标域数据可用，再使用源域中全部参考矩阵计算平均的方式显然不妥，应当尽量选择与TR相似的参考矩阵来对齐，余弦相似度能够估计矩阵的差异，并且得到了广泛应用，分别计算R和12,mRRR之间的余弦相似度作为权重：22cos,TkTkTkTkRsRRRRR(3.5)式中，ks为kR与TR之间的相似度，1,2,,km，TTR为TR的转置。（4）根据矩阵相似度使用最大最小归一化的方式为12,mRRR赋予不同的权值：第3章基于改进欧式空间对齐方法的跨被试迁移学习19minmaxmin11kkmkksswsss(3.6)式中，kw为kR的权值，1,2,,km，经过归一化后相似度较大的参考矩阵分配到的权重较大，且满足：11mkkw(3.7)（5）计算加权平均源域参考矩阵：11mSkkkRwRm(3.8)式中，SR为计算得到的加权平均源域参考矩阵。（6）组合TR和SR构成融合参考矩阵：(1)TSTSRRR(3.9)式中，TSR为融合参考矩阵，min(,1)MN为权衡参数，用于调整对齐中使用目标域参考矩阵的比重，当目标域中可用数据越多时使用TR作为融合参考矩阵的比重越大。（7）使用融合参考矩阵TSR对目标域中样本푋푖对齐得到푋푖∗：*1/2iTSiXRX(3.10)融合参考矩阵TSR同时考虑了通过目标域上少量样本得到的目标域参考矩阵TR和加权平均源域参考矩阵SR，并通过引入权衡参数，在不同域数据可用比例下动态调整TSR中TR和SR的占比，当目标域数据样本数量较多时提高TR在TSR中的占比，直到目标域中样本数与源域中一个被试的样本数相等时，完全使用目标域中样本进行对齐。另外，通过对目标域数据的充分挖掘，使用余弦相似度分别计算TR与源域中每个被试的参考矩阵12,mRRR之间的相似程度，经过最大最小归一化后用于计算加权平均源域参考矩阵SR。该方法在目标域可用数据较少时采用源域中参考矩阵估计目标域参考矩阵。为评估上述两种对齐方法的性能，本文在真实采集的数据集上进行了验证，见3.4节。第3章基于改进欧式空间对齐方法的跨被试迁移学习203.2实验环境介绍本文的研究是在一台装有Windows10操作系统的图形工作站上完成的，处理器为两颗lntel(R)Xeon(R)CPUE5-2620v4@2.10GHz，运行内存16GB，图形卡为NVIDIAQuadroM2000。采用Python3.6作为编程语言通过Anaconda搭建实验环境，使用jupyternotebook和Pycharm编写实验代码，机器学习框架为sklearn，深度学习框架为Keras，backend采用TensorFlow。3.3数据集介绍与预处理3.3.1数据采集本次实验数据来源于江西科技学院信息技术研究所，包括25名在校大学生作为被试，所有被试均满足以下条件：（1）身体健康，无精神疾病史。（2）实验期间未服用药物或使用含兴奋性物质的食物，如咖啡、酒精等。（3）有机动车驾驶执照。在实验开始之前所有被试都进行了相关培训，确保被试熟悉实验流程。为确保实验安全，本次实验通过一套汽车驾驶模拟器来模拟真实的驾驶行为，被试需要坐在驾驶舱内操控汽车驾驶模拟软件上显示的机动车，驾驶舱为北京中育联合教学设备有限公司生产的汽车驾驶模拟器，型号为ZY-31D，汽车驾驶模拟软件为紫光基业ZG-601。根据疲劳驾驶研究的相关经验，单调驾驶更容易引发疲劳，因此驾驶的环境选择为宽阔且笔直的高速公路。实验要求被试保持车辆在车道的中间行驶，并维持速度尽量不变。实验中首先要求被试驾驶20分钟，取最后5分钟的数据标记为非疲劳数据，并通过疲劳调查表验证被试的非疲劳状态。然后要求被试连续驾驶30分钟后填写疲劳调查表，如果认定被试处于疲劳状态则取最后5分钟采集的数据作为疲劳数据，否则要求被试继续驾驶30分钟，直至获取疲劳数据。实验过程中通过被试佩戴的32通道电极帽采集被试的脑电数据，实验使用的电极帽有32个电极，根据10-20国际标准导联系统摆放电极位置，去除2个参考电极后共使用30通道的EEG信号，采样频率设置为1000Hz。最后将25个被试的EEG数据按秒切分为单个样本，最终得到每个被试600个样本，其中第3章基于改进欧式空间对齐方法的跨被试迁移学习21正样本（疲劳状态）有300个，负样本（静息状态）有300个。3.3.2数据预处理由于原始脑电信号带有肌电、眼电等干扰信号，对原始脑电信号进行以下预处理：（1）滤波：目前一般认为大脑活动主要发生在脑电波的5个频段内，即δ（1~3Hz）、θ（4~7IHz）、α（8~13Hz）、β（14~30Hz）和γ（30~80Hz），故本文使用带通滤波器对原始信号进行滤波，去除无关频率分量，滤波器频带为1-80Hz。（2）去除伪迹：在脑电信号采集过程中，被试的眼球转动和肌肉运动也会反应在脑电信号上，与实验不相关的眼电、肌电信号就会被一起采集，为去除干扰信号，本文采用独立成分分析方法对脑电波信号进行盲源分离，到达去除伪迹的目的。（3）基线漂移校正：在脑电信号采集过程中，环境温度、湿度等物理因素的变化可能导致电路元器件参数改变，使得输出叠加了与脑电信号无关的信号，引起漂移现象，本文采用基线和斜率去零点漂移的方法对脑电信号进行校正。3.3.3数据集划分无目标域数据时的数据集划分：为模拟完全没有目标域数据时的情况，采用留一法从25个被试数据中依次选择一个被试数据作为目标域，其余24个被试数据作为源域。用源域数据作为训练集，目标域数据作为测试集，以模拟零校准时的跨被试分类情况。有少量目标域数据时的数据集划分：同样采用留一法选择源域和目标域，然而对选中的目标域数据分别按照一定的校准比例划分成两部分，将较小部分目标域数据作为校准数据加入源域数据作为训练集，剩下的较大部分目标域数据作为测试数据，以模拟有少量校准数据的跨被试分类情况。3.4实验结果与分析本节对3.1节中提到的两种对齐方法进行了实验测试，使用留一法划分了两种不同的数据集，在无目标域数据和有少量目标域数据用于校准的情况下，使用传统机器学习方法和深度学习方法验证改进的欧式空间对齐方法的效果。第3章基于改进欧式空间对齐方法的跨被试迁移学习223.4.1t-SNE协变量偏移可视化在使用EEG进行跨被试疲劳驾驶检测时，往往会出现协变量偏移的问题，这在1.3节中已经有详细介绍，为了说明对齐在跨被试EEG分析中的作用，我们有必要观察对齐前后EEG的协变量偏移情况，下面采用t-SNE可视化对齐前后的效果。（1）无目标域数据时，AEA前后的t-SNE可视化。图3.1（a）展示了25个被试中第一个被试作为目标域时的对齐前的结果，可以发现对齐前目标域在所有被试的数据中占据一个较小的区域，各个被试之间存在明显的协变量偏移，用源域上数据（黑色）训练得到的模型在目标域（灰色）上显然不能得到很好的分类结果；而3.1（b）显示了源域经过EA对齐，目标域经过AEA对齐后的结果，可以看到目标域不再紧紧缩在一小块区域，而是在较大范围都有分布，协变量偏移有所改善，之后再使用机器学习或者深度学习的方法对数据进行分析会比对齐前取得更好的效果。（2）有少量目标域数据时，WAEA前后的t-SNE可视化。当有5%目标域数据用于校准，即校准比例为5%时，WAEA前后的t-SNE可视化如图3.2所示，其中图3.2（a）表示对齐前的可视化结果，图3.2（b）代表源域经过EA对齐，目标域利用校准数据进行WAEA对齐后的可视化结果。其中黑色点代表目标域数据，灰色点代表源域数据，可以看到对齐前目标域数据分布较小，并且与源域的数据分布不符合，经过WAEA后目标域数据分布与源域分布变得更接近，并且分布相对AEA更加分散，更有利于机器学习和深度学习，这是由于WAEA融合了部分目标域上的数据用于估计参考矩阵，能够得到更好的结果。（a）AEA前（b）AEA后图3.1AEA前后t-SNE可视化第3章基于改进欧式空间对齐方法的跨被试迁移学习23（a）WAEA前（b）WAEA后图3.2WAEA前后t-SNE可视化3.4.2不同对齐方式在CSP+LDA下的分类性能本小节使用常用于分类EEG信号的机器学习方法CSP+LDA来验证对齐在跨被试EEG疲劳驾驶检测中的作用。CSP是一种在EEG领域被广泛使用的空域滤波特征提取方法，该方法利用矩阵对角化，找到一组最优空域滤波器最大化两类EEG信号的方差，从而得出用于后续分类的特征向量。LDA是一种常用的分类算法，其主要目的是找到一个线性组合，使得不同类别之间的距离最大化。LDA会根据训练数据中的不同类别计算出各个类别的均值和协方差矩阵，并计算出一组线性判别函数。（1）无目标域数据时对齐与否的比较。为充分体现对齐在跨被试EEG疲劳驾驶检测中的作用，我们按照对训练集和测试集对齐策略的不同制定了4种对齐组合，如表3.1所示。表3.1四种组合的名称和对齐方法名称训练集对齐方法测试集对齐方法initial-intitle不对齐不对齐initial-AEA不对齐AEAEA-intitleEA不对齐EA-AEAEAAEA对训练集和测试集都不对齐，使用原始数据，记为initial-intitle；对训练集不对齐，对测试集使用AEA，记为initial-AEA；对训练集使用EA，对测试集不对齐，记为EA-intitle；对训练集使用EA，对测试集使用AEA，记为EA-AEA。使用3.3.3节中介绍的数据集划分方法，依次选择25个被试中的1个被试第3章基于改进欧式空间对齐方法的跨被试迁移学习24数据作为目标域来测试，剩余24个被试数据作为源域用作训练，采用4种不同的对齐组合方式训练CSP提取特征并用于LDA分类，计算25个不同目标域上的平均准确率。结果如表3.2和图3.3所示。表3.2四种组合在CSP+LDA下零校准跨被试分类结果methodaccuracyf1-scoreprecisionrecallinitial-intitle50.84%50.35%50.92%49.81%initial-AEA50.59%50.10%50.61%49.62%EA-intitle50.80%50.30%50.82%49.88%EA-AEA55.48%55.96%55.60%54.63%图3.3四种组合在CSP+LDA下的零校准跨被试分类准确率从表3.2中可以看到，使用原始数据训练的分类器，在零校准的情况下，进行跨被试EEG疲劳驾驶检测的效果都较差，大部分的结果都接近50%的随机猜测。使用initial-intitle效果较差的原因是因为EEG具有个体差异性，训练中会发生协变量漂移，在3.4.1节中也能被很好的观察到，因此在不同源域上训练的分类器不能直接用于分类。而initial-AEA和EA-intitle效果较差的原因是训练集和测试集中只有一个数据集进行了对齐，另一个数据集使用的还是原始数据，导致训练集上的特征分布与测试集不符合，效果自然较差。EA-AEA取得了最高的准确率，该组合首先对源域被试进行EA对齐，降低了目标域中的个体差异性，并且用源域上的得到的参考矩阵对目标域对齐，一定程度上缓解了个体差异性对识别准确率带来的不利影响，相对其他几种组合均有5%左右的提高。第3章基于改进欧式空间对齐方法的跨被试迁移学习25为说明这种提高具有统计学意义，我们进行了配对t检验，该检验能够判断两组样本是否存在显著性差异，一般认为p值小于0.05时即可认定存在显著差异，在t检验之前已用SPSS进行方差齐性检验，以确保组内数据符合正态分布。表3.3显示了EA-AEA与其他组合的显著性差异比较，其中有显著差异结果被加粗，从中我们可以看到EA-AEA与其他三种方法均有显著差异，即EA-AEA的平均准确率明显优于其他组合。表3.3EA-AEA与其他三种组合的显著性检验initial-intitleinitial-AEAEA-intitleEA-AEA0.03560.03410.0352（2）有少量目标域数据时对齐与否的比较。在对齐方法的选择上，由于已经有少量目标域数据可供使用，此时选择测试WAEA而不是AEA的效果，另外EA也可根据少量数据计算参考矩阵并用于对齐，将其也加入对齐方法中对比，最后根据对训练集和测试集的不同对齐策略，我们制定了6种对齐的组合方式，见表3.4所示：表3.4六种组合的名称和对齐方法名称训练集对齐方法测试集对齐方法initial-intitle不对齐不对齐initial-WAEA不对齐WAEAinitial-EA不对齐EAEA-intitleEA不对齐EA-WAEAEAWAEAEA-EAEAEA本小节使用3.3.3节中介绍的有少量目标域数据时的数据集划分方法，选择一个被试数据作为目标域数据，剩余24个被试作为源域，校准比例的划分选择5%、10%、15%、20%、25%和30%。按照给定的组合训练CSP提取特征并用LDA进行分类，实验结果见表3.5。从表3.5可以看到，当校准比例为5%时，所有组合得到的准确率都普遍较低，这与在无目标域数据上的测试结果相符合。相对于零校准的情况，在加入5%的目标域数据作为校准数据后，各种组合的跨被试识别准确率都有了一定的提升，然而这种提升极其有限，这是由于目标域中样本数量过多且具有高度差异性，加入未经对齐的少量数据并不能使得特征提取器和分类器找到一个好的决策边界。以原始数据为训练集的三种方法initial-intitle、initial-WAEA和第3章基于改进欧式空间对齐方法的跨被试迁移学习26initial-EA得到的准确率分别是50.97%、50.58%和50.49%，这充分说明了EEG的个体差异在未对齐时给跨被试分析带来的困难。而在源域和目标域上都进行对齐的两种组合EA-WAEA和EA-EA比起前三者的准确率要好不少，这是由于被试的EEG数据经过对齐后特征分布更加相似，有利于找到良好的决策边界用于分类。另外我们还注意到，EA-WAEA比EA-EA的效果更好，这是由于EA在目标域数据有限的情况下只能通过少量数据计算参考矩阵，不能很好的代表整体数据，而WAEA结合源域上的参考矩阵和目标域上的参考矩阵，并通过余弦相似度进行加权平均，一方面使用了目标域信息，另一方面充分挖掘源域信息，使用较少的目标域数据作为校准数据得了更好的准确率。表3.5六种组合在CSP+LDA和不同校准比例下的跨被试分类准确率method5%校准比例10%校准比例15%校准比例20%校准比例25%校准比例30%校准比例initial-intitle50.97%51.07%51.19%51.67%51.91%52.71%initial-EA50.58%50.72%50.95%51.34%51.86%52.54%Initial-WAEA50.49%50.71%50.47%50.97%51.46%51.97%EA-intitle50.65%50.97%51.16%51.64%51.70%51.97%EA-EA53.58%53.64%53.91%54.89%55.61%57.61%EA-WAEA55.26%55.71%56.81%57.61%58.47%58.71%为更直观的体现不同组合在不同校准比例下的表现，我们绘制了每种组合的平均分类准确率随校准比例变化的曲线，见图3.4。图3.4六种组合在CSP+LDA和不同校准比例下的跨被试分类准确率曲线第3章基于改进欧式空间对齐方法的跨被试迁移学习27所有对齐组合的准确率都随着校准比例的提高而逐渐增加，这其中对训练集和测试集都进行对齐的EA-WAEA和EA-EA保持对其他方法的领先，另外我们观察到在校准比例较小时EA-WAEA对EA-EA有一定优势，但是随着校准比例的增加这种优势逐步减小，最终两种方法得到的平均准确率趋近一致，这是WAEA的计算方法决定的。由式3.9可知WAEA使用的参考矩阵是由目标域参考矩阵和源域加权平均参考矩阵融合得到的，当计算目标域参考矩阵所用的样本量越大，认为目标域参考矩阵越重要，因此当校准比例提高后WAEA和EA所用的参考矩阵会越来越相似，直到使用了与源域中参考矩阵相同的样本数，此时WAEA等于EA。然而在校准比例较小时，目标域可用数据较少，WAEA能够比EA取得高的准确率，在目标域数据获取困难时具有一定意义。3.4.3不同对齐方式在DeepConvNet下的分类性能近年来利用深度学习方法对EEG信号进行分析也有很多研究，其中DeepConvNet[64]是一个用于对EEG信号进行分类的网络，已经在多个数据集上被证明能有效解码EEG信号并分类。本小节使用DeepConvNet作为深度学习方法，验证对齐在跨被试EEG疲劳驾驶检测中的作用。（1）无目标域数据时对齐与否的比较。由于目标域上完全没有数据时EA不可用，因此只能考虑initial-intitle、initial-AEA、EA-intitle和EA-AEA四种对齐组合方式，每种组合的解释见表3.1。我们按照3.3.3节中无目标域数据时的数据集划分方法，依次选择一个被试数据作为目标域数据来测试，其余被试数据作为源域数据来训练，按照不同对齐组合方式在对应的训练集上训练DeepConvNet后直接对测试集中的数据进行测试，最后对所有被试的测试结果取平均，结果如表3.6。表3.6四种组合在DeepConvNet下的零校准跨被试分类结果methodaccuracyf1-scoreprecisionrecallinitial-intitle51.12%48.36%51.33%46.23%initial-AEA51.32%48.84%51.56%46.42%EA-intitle55.23%53.19%55.82%50.81%EA-AEA61.41%59.94%62.47%57.63%从表3.6中可以看到在使用DeepConvNet作为分类器时，EA-AEA的平均准确率和各项指标同样表现最好，平均准确率达到61.41%，比initial-intitle、第3章基于改进欧式空间对齐方法的跨被试迁移学习28initial-AEA和EA-intitle分别提高了10.29%、10.09%、6.18%。同样使用t检验来验证这样的提高具有显著性差异，表3.7显示了EA-AEA与initial-intitle、initial-AEA均具有极显著差异，与EA-intitle具有显著差异。表3.7EA-AEA与其他三种组合的显著性检验initial-intitleinitial-AEAEA-intitleEA-AEA0.00580.00610.0124（2）有少量目标域数据时对齐与否的比较。由于此时已经有少量目标域数据，使用WAEA而不是AEA对目标域数据进行对齐。根据对训练集和测试集对齐方法的不同，制定了6种对齐组合initial-intitle、initial-WAEA、initial-EA、EA-intitle、EA-WAEA和EA-EA，每个组合的解释见表3.4。使用3.3.3节中介绍的有少量目标域数据时的数据集划分方法，选择一个被试数据作为目标域数据，剩余24个被试作为源域，校准比例的划分选择5%、10%、15%、20%、25%和30%。按照给定对齐组合处理训练集和测试集后，使用DeepConvNet在训练集上训练，在测试集上测试后取平均准确率，实验结果见表3.8和图3.5。表3.8六种组合在DeepConvNet和不同校准比例下的跨被试分类准确率method5%校准比例10%校准比例15%校准比例20%校准比例25%校准比例30%校准比例initial-intitle56.87%55.74%58.41%59.76%62.84%65.41%initial-EA58.82%57.26%59.81%60.65%63.64%67.33%Initial-WAEA59.89%58.59%60.24%61.96%64.34%68.72%EA-intitle61.02%59.86%61.18%61.97%65.47%70.31%EA-EA61.34%60.62%63.16%63.96%68.61%72.26%EA-WAEA62.08%62.14%63.41%64.83%72.31%74.05%从图3.5可以看到随着校准比例的提高，所有对齐组合在DeepConvNet作为特征提取和分类器的情况下都取得了不同程度的提高，其中EA-WAEA在不同校准比例下都取得了最好的平均准确率，EA-EA次之，这两种组合在源域和目标域上都进行了对齐的操作，使得目标域和源域之间的特征空间更加相似，让深度神经网络能够在目标域上更好的分类，具有更强的泛化性能，这说明了对齐操作在迁移学习中的必要性。第3章基于改进欧式空间对齐方法的跨被试迁移学习29图3.5六种组合在DeepConvNet和不同校准比例下的跨被试分类准确率曲线同时我们发现与图3.4中类似，EA-WAEA比EA-EA的领先程度随着校准比例的上升逐渐缩小，这是由WAEA的计算公式决定的，当校准数据较少时，利用源域中参考矩阵和目标域上参考矩阵的相似度进行加权平均，充分利用源域数据时一定程度上避免了负迁移，当校准数据较多时，尽量少的使用源域中参考矩阵，转而使用目标域上得到的参考矩阵，更有利于提高目标域上的分类准确率。为进一步提高对目标域数据的利用，我们使用目标域上划分出的校准数据对已经训练好的模型进行微调，关于微调的介绍见2.2节中基于模型的迁移方法。微调的层数初步设定为全部卷积层并训练50个epoch保证收敛，这是一个比较初级的微调方法，但是用于验证对齐的效果也足够了，我们会在第4章中讨论不同的微调方法。微调过后在测试集上测试并计算平均准确率，结果见表3.9和图3.6。表3.9六种组合在DeepConvNet和不同校准比例下的微调后分类准确率method5%校准比例10%校准比例15%校准比例20%校准比例25%校准比例30%校准比例Initial-WAEA85.77%89.18%91.84%91.97%92.48%92.77%initial-EA83.81%86.97%88.17%90.61%91.17%91.64%Initial-WAEA82.75%85.49%86.91%87.81%89.51%89.87%EA-intitle86.27%88.79%90.86%91.71%92.08%92.51%第3章基于改进欧式空间对齐方法的跨被试迁移学习30表3.9（续表）六种组合在DeepConvNet和不同校准比例下的微调后分类准确率method5%校准比例10%校准比例15%校准比例20%校准比例25%校准比例30%校准比例EA-EA90.42%92.81%95.49%95.89%96.07%96.08%EA-WAEA92.28%94.98%95.71%96.08%95.99%96.12%图3.6六种组合在DeepConvNet和不同校准比例下的微调后分类准确率曲线微调过后，所有对齐组合在DeepConvNet作为分类模型的跨被试分类准确率都有大幅提升，其中EA-WAEA依旧在所有校准比例下取得了最高的准确率，在校准比例为5%时就取了了92.28%的分类准确率，当校准比例为30%时，其准确率也提高到96.12%，这是由于对齐后的训练数据与测试数据具有更加相似的分布，对这样的数据进行微调能得到更好的性能；其次EA-EA的表现第二好，在校准比例为5%和30%时的准确率分别是90.42%和96.08%，并且当校准比例超过15%时EA-EA和EA-WAEA的表现几乎一致，经t检验两者并不存在显著差异，然而WAEA在校准数据较少时能够比EA取得更好的结果。另外对训练集和测试集都使用了对齐的EA-WAEA和EA-EA比其余方法的微调结果都要好，这与直接使用预训练模型测试的结果一致，再次验证对齐操作能够提升迁移学习过程中的分类性能。为了更直观的体现出微调后分类准确率的提升，图3.7以堆积柱形图的方式显示了5%校准比例下的提升。从图3.7可以看到，几乎所有对齐方法在微调后都有了20%的准确率提升，这个提升效果显著，而我们仅仅使用了最简单的第3章基于改进欧式空间对齐方法的跨被试迁移学习31微调方法，即微调所有卷积层，在第四章里我们会进一步研究微调层数和网络结构，以期望能够使用更少的目标域数据得到更好的分类性能。图3.7微调前后的准确率对比经过一系列的对比实验，证明本章提出的两种改进的欧式空间对齐算法AEA和WAEA能分别在零校准和校准数据较少的场景下有效降低协变量偏移，提高疲劳驾驶EEG跨被试分类准确率，特别是WAEA结合DeepCovnet微调后的提升效果显著。3.5本章小结本章主要介绍了改进的欧式空间对齐方法AEA和WAEA，分别适用于零校准和有少量目标域数据供校准的情况。我们通过一系列的实验证明了两种对齐方法对齐在迁移学习中具有重要意义，能有效提高跨被试分类性能。特别是WAEA在少量校准数据下结合迁移学习中的模型迁移方法表现出优异的性能，能使用少量校准数据得到较高的跨被试分类准确率。第4章基于WAEA和多尺度特征融合的迁移学习模型32第4章基于WAEA和多尺度特征融合的迁移学习模型本文在1.3节中提到了导致跨被试EEG分类准确率不佳的两个困难，即协变量偏移和低信噪比，前者可以通过对齐来缓解，后者则可以通过提高模型的特征提取能力来应对。在第3章中WAEA对齐结合卷积神经网络DeepConvNet进行模型迁移的效果令人印象深刻，而在本章我们专注于在有少量目标域数据作为校准数据的条件下，通过增强模型的特征提取能力进一步提高疲劳驾驶EEG的跨被试分类性能。本章在WAEA的基础上进一步探索，通过多尺度特征融合来强化卷积神经网络对EEG的特征提取能力，同时研究了不同微调和预训练策略，结合模型迁移的方法提出了基于WAEA和多尺度特征融合的迁移学习模型，旨在使用较小的校准数据得到更好的跨被试EEG分类性能。4.1融合迁移网络方法CNN因其可以在网络内部进行自发的进行特征提取和分类，避免了人工提取特征的繁琐和局限，同时能够取得优异的性能，使得基于CNN的各种变种模型在多个领域取得巨大成果。图4.1显示了一个简单的CNN网络，输入数据会被多个卷积层处理，每个卷积层都会使用一组卷积核对输入数据进行卷积运算，生成一组新的特征图。这些特征图中包含了输入数据的不同层次、不同抽象程度的特征，其中浅层的卷积层通常用于提取输入的低级特征。例如在图像处理中，提取的浅层特征多为边缘、角落和颜色等。可以说浅层卷积层的卷积核提取到的特征具有一定的共性，即它们可以在不同的输入中识别相似的特征。而随着网络的深度增加，卷积核的数量和复杂度也会增加，捕获的特征也会更加高级和抽象，例如物体的整体形状和结构等，这些特征具有一定的特性，因此我们能够利用深层卷积层的提取到的特征进行分类。第4章基于WAEA和多尺度特征融合的迁移学习模型33图4.1一个简单的CNN网络不同尺度的特征在分类中能起到重要作用。深层网络的感受野比较大，语义信息表征能力强，但是特征图的分辨率低，几何信息的表征能力弱；低层网络的感受野比较小，几何细节信息表征能力强，虽然分辨率高，但是语义信息表征能力弱。我们能够结合浅层卷积层对共性的提取和深层卷积层对特性的提取，构建出多尺度的特征融合网络，增强模型的特征提取能力。近年来有许多关于使用CNN对EEG信号进行分类的研究，取得了比传统机器学习特征提取和分类更好的效果，充分证明了使用CNN分析EEG信号的可行性。然而这些研究多只使用了最深层的特征，为充分利用多尺度特征提高网络对EEG信号的表征能力，本章提出多尺度特征融合网络，综合考虑各个深度的卷积层提取到的不同尺度的特征，使模型具备更强的特征提取能力，并结合模型迁移学习以提高在有少量目标域数据下的跨被试分类能力。所提出的方法流程如图4.2所示，首先选择一个能对EEG信号进行有效分析的CNN网络，并通过实验选择其合适的浅层网络作为共性特征提取网络（commonfeaturenetwork，CFN），用于提取EEG信号的共性特征。之后连接上多个不同深度的卷积块用于提取不同尺度的特性特征，每个卷积块包括一个卷积层和一个最大池化层，具体卷积块的连接个数根据实验结果决定。最后将这些特征拼接在一起通过全连接层和softmax进行分类。其中共性提取网络参数通过在源域数据上预训练得到，特性提取网络参数通过在目标域数据上微调得到。第4章基于WAEA和多尺度特征融合的迁移学习模型34图4.2多尺度特征融合迁移学习流程为更好的提高有少量校准数据时的跨被试分类准确率，我们结合第3章中的WAEA对齐，可以得到一个基于改进的欧式空间对齐的多尺度特征融合的迁移学习模型，具体流程见图4.3。第一部分先进行EEG数据的预处理与对齐，对原始数据进行带通滤波、伪迹去除和基线漂移去除等常用预处理操作后，使用EA-WAEA进行对齐。第二部分是构建共性特征提取网络，首先预训练一个CNN网络，在预训练网络的基础上依次冻结网络浅层部分参数并用微调数据来微调模型，选择微调后准确率最高的冻结部分网络作为共性特征提取网络。第三部分是构建多尺度特征融合网络并微调，在得到的共性特征提取网络后添加多个不同深度的特性特征提取网络，提取多尺度特性特征融合后分类，训练过程中冻结CFN网络参数只训练特性特征提取网络，最后使用训练好的多尺度特征融合网络对目标域上测试数据进行分类。第4章基于WAEA和多尺度特征融合的迁移学习模型35图4.3基于WAEA和多尺度特征融合的迁移学习模型4.2共性特征提取网络的构建4.2.1迁移模型的选择在第3章中我们使用DeepConvNet作为迁移模型以验证EA-WAEA的有效性，为进一步研究适合EEG信号的迁移学习模型，本章中我们使用在EEG领域表现优异的3种模型进行对比，选出迁移效果较好的模型作为共性特征提取网络。这3种模型分别是DeepConvNet[64]、EEGnet[65]和EEG-Inception[66]。其中EEGnet是一个紧凑、多范式可用的小型卷积神经网络，具有3个卷积层，其利用可分离卷积技术大大降低了模型中的参数总量并取得了和大模型相当的结果；DeepConvNet是一个EEG解码任务的通用卷积神经网络，包含5个卷积层，同时使用时间卷积和空间卷积进行特征提取，并使用Dropout和batchnormalization提高分类准确率，在多个数据集上表现不俗；EEG-Inception通过引入Inception模块，利用不同尺寸的卷积核增加了特征提取的深度和广度，11个卷积层的结构使其具有更强的特征提取能力。以上模型在EEG领域已得到充第4章基于WAEA和多尺度特征融合的迁移学习模型36分验证，能有效提取特征并分类，并且这三种模型分别对应了不同深度的卷积神经网络，本节使用这3种网络为主干网络，构建共性特征提取网络，同时研究不同微调层数对最后分类结果的影响。4.2.2预训练及微调策略的选择根据4.1节中提到的，CNN模型的浅层网络提取到的是输入数据的共性特征，深层网络提取特性特征，为选择较优的共性特征提取网络并用于后续分类，我们将模型训练数据上预训练，然后冻结部分卷积层在校准数据上微调，选取微调后在测试数据上分类性能最好的网络的冻结部分作为共性特征提取网络。这是因为在较优的共性特征提取网络的基础上，微调后的特性特征提取网络能够取得更好的分类结果。（1）预训练策略选择。在第3章中出于充分利用校准数据的目的，我们将预训练数据设定为源域数据和校准数据，这导致对于每个新的被试都要重新训练一个预训练模型再进行微调，造成了很大的时间成本，为了降低预训练的时间成本，一个简单的解决方法是只使用源域数据进行预训练。这两种训练方式可以通过图4.4被直观的区分，图4.4（a）表示只使用源域数据预训练，利用目标域上的的校准数据进行微调，并在测试数据上测试；图4.4（b）则表示使用源域和校准数据共同预训练，再次利用校准数据进行微调后，在测试数据上测试。为了探索这两种预训练方法对微调后分类性能的影响，我们分别使用这两种方法进行预训练。预训练中每个模型使用Adma作为优化器，初始学习率设为0.001，batchSize大小为64，epoch总次数为100次。（a）使用源域数据预训练（b）使用源域和校准数据预训练图4.4两种预训练方式第4章基于WAEA和多尺度特征融合的迁移学习模型37（3）微调策略选择。不同深度的卷积层提取的是不同尺度的特征，较浅的卷积层更多是提取输入数据共性的特征，为选择较优的共性特征提取网络，我们调整模型的微调层数，并通过微调后的模型在测试数据上的分类性能进行选择。根据微调卷积层的数量我们制定了几种不同的微调策略，即按30%、50%、70%和100%的比例设定每个网络中被微调的层数，如30%表示只微调网络中最靠近输出的30%卷积层，其余卷积层的参数被冻结。微调过程中的模型超参数除epoch总次数为50和学习率为0.0001外，其余同预训练过程。表4.1显示了DeepConvNet、EEGnet和EEG-Inception在不同比例下的微调层数。表4.1不同模型的微调层数Model总卷积层数微调30%卷积层微调50%卷积层微调70%卷积层微调100%卷积层DeepConvNet51345EEGnet31\23EEG-Inception11368114.2.3实验结果与分析按照之前提到的2种预训练策略和4种微调层数比例组合，我们测试了DeepConvNet、EEGnet和EEG-Inception这3种模型在不同预训练策略和微调层数比例组合下表现。根据3.3.3节中有少量目标域数据时的数据集划分方法，选择一个被试数据作为目标域数据，剩余24个被试作为源域，校准比例的划分选择5%、10%、15%、20%、25%和30%，取每个被试的平均准确率为最后结果。本章的实验环境和实验数据详见3.2节和3.3节。不同校准比例下，使用源域数据和校准数据共同进行预训练后微调的结果如表4.2所示，加粗部分表示在同一个校准比例下得到的最好结果。从表4.2可以看到，微调不同的卷积层的确能够影响最后的分类准确率，比如当校准比例为5%时，EEG-Inception在微调50%卷积层时取得93.84%的平均准确率，而在微调30%卷积层时的平均准确率为88.65%，两者相差5.19%。另外我们发现不同模型的最优微调层数不同，如EEG-Inception在微调50%卷积层时取得最好的结果，而DeepConvNet和EEGnet在微调70%卷积层时取得最好的结果。第4章基于WAEA和多尺度特征融合的迁移学习模型38表4.2使用源域和微调数据预训练的微调后平均准确率校准比例模型微调30%卷积层微调50%卷积层微调70%卷积层微调100%卷积层5%DeepConvNet86.65%91.31%94.16%92.28%EEGnet84.17%\89.38%88.57%EEG-Inception88.65%93.84%92.07%89.37%10%DeepConvNet87.89%93.25%94.53%94.98%EEGnet85.47%\90.43%90.17%EEG-Inception90.42%95.79%93.17%91.64%15%DeepConvNet88.43%93.96%95.52%95.71%EEGnet86.53%\92.74%91.70%EEG-Inception91.69%97.15%94.04%92.35%20%DeepConvNet88.81%94.43%96.24%96.08%EEGnet87.21%\92.98%91.73%EEG-Inception92.54%97.36%94.61%92.71%25%DeepConvNet88.85%94.84%96.58%95.99%EEGnet87.58%\93.07%92.16%EEG-Inception93.04%97.44%94.65%93.28%30%DeepConvNet88.92%94.85%96.96%96.12%EEGnet88.01%\93.20%92.17%EEG-Inception93.20%97.64%94.84%93.94%表4.3显示了仅使用目标域数据进行预训练后的微调结果，我们发现了与表4.2类似的现象，即不同微调层数对分类准确率也有影响，并且最优微调层数是一致的。EEG-Inception的最优结果依旧在微调50%卷积层时得到，DeepConvNet和EEGnet的最优结果还是在微调70%卷积层时得到。这是因为相对于EEG-Inception来说，DeepConvNet和EEGnet的网络都较浅，需要训练的参数较少，在少量的微调数据下微调较多层也不会发生过拟合的现象。而像EEG-Inception这种较深的网络需要训练的参数更多更复杂，在少量的微调数据下稍微多微调几层就容易出现过拟合的现象。另外大部分的模型随着校准比例的增加，得到的平均分类准确率也不断增加。第4章基于WAEA和多尺度特征融合的迁移学习模型39表4.3仅使用源域数据预训练的微调后平均准确率校准比例模型微调30%卷积层微调50%卷积层微调70%卷积层微调100%卷积层5%DeepConvNet84.77%91.03%93.40%90.37%EEGnet84.17%\88.59%85.47%EEG-Inception86.97%93.14%91.41%88.62%10%DeepConvNet85.96%91.65%94.11%94.53%EEGnet84.81%\89.59%89.26%EEG-Inception89.21%95.28%92.44%91.01%15%DeepConvNet86.77%92.35%93.45%94.92%EEGnet85.16%\91.73%90.24%EEG-Inception91.42%96.41%93.87%91.73%20%DeepConvNet87.34%92.89%94.98%94.61%EEGnet85.63%\92.18%89.94%EEG-Inception90.75%96.78%93.67%92.25%25%DeepConvNet88.04%94.00%96.38%95.79%EEGnet85.85%\92.40%91.51%EEG-Inception91.89%97.18%94.49%92.97%30%DeepConvNet87.14%93.57%96.47%95.29%EEGnet86.03%\92.80%91.73%EEG-Inception92.32%97.31%94.32%93.10%综合表4.2和表4.3来看，微调50%卷积层的EEG-Inception在两种不同的预训练策略和不同校准比例下都取得了最好的分类准确率，当校准比例5%时，微调50%卷积层EEG-Inception在两种不同的预训练策略下取得了93.84%和93.14%的平均准确率，并且随着校准比例的上升逐渐提高至97.64%和97.31%。同时我们发现，两种预训练策略的确会对准确率造成一定影响。这体现在使用源域和校准数据共同预训练的模型的准确率比仅使用源域数据预训练的模型稍微高一点，不过这种提升非常有限。如当校准比例为5%时，EEG-Inception在两种预训练策略下的最好平均准确率差值为0.7%。我们在DeepConvNet和EEGnet上也观察到了类似的情况，使用源域数据和校准数据共同预训练会比仅使用源域数据预训练得到的最好平均准确率高0.76%和0.79%，然而这样的提高需要付出更多的时间成本。同时使用源域数据和微调数据预训练，这意味这对于每个新被试，我们都要进行长时间的预训练模型过程，导致用户在使用之前需要经历一段长时间的等待环节。这极大的破坏了用户的使用体验，而仅使第4章基于WAEA和多尺度特征融合的迁移学习模型40用目标域数据预训练的方法虽然会损失少量的分类性能，但是能够使用事先训练好预训练模型，避免重复进行预训练，等到用户需要分类时提取少量微调数据在给定的4种不同冻结程度的网络上进行微调即可选出较优的共性特征提取网络。最后选出微调结果最好的网络的冻结部分作为共性特征提取网络，缩短了对于新被试的校准时间。根据在本文数据集上的结果显示，我们选取仅在源域数据上预训练的前50%卷积层的EEG-Inception作为CFN用于构建后续的多尺度特征融合迁移模型，其网络结构如图4.5所示，其中IN表示输入，C1、C2和C3表示对时间上的卷积，D1、D2和D3表示对通道的卷积，N1表示对特征进行拼接。图4.5共性特征提取网络结构4.3多尺度特征融合的迁移学习模型4.3.1模型的构建出于充分利用多尺度特征提高分类准确率的目的，我们在共性特征提取网络后连接L个不同深度的特性特征提取网络，每个特征提取网络都能得到一个特征特征，加上CFN提取的共性特征，一共得到L+1个不同尺度的特征，最后将多尺度特征拼接在一起用于分类，在训练过程中冻结CFN网络的参数，只对之后添加的特性特征提取网络的参数进行训练。网络结构图4.6所示。第4章基于WAEA和多尺度特征融合的迁移学习模型41图4.6多尺度特征融合迁移模型其中每个特性特征提取网络由若干个卷积块组成，越深的网络拥有越多的卷积块。每个卷积块由一个卷积层和一个池化层组成，随着网络层数的加深，卷积层中滤波器的个数逐渐增加，卷积核大小逐渐减小，以提取更加抽象和高级的特性特征。经过多次试验，确定不同深度卷积块的卷积核大小和滤波器数量如表4.4所示。表4.4不同卷积块的卷积核大小及数量卷积块1卷积块2卷积块3卷积块4卷积核大小1×31×31×51×5滤波器数量8162432为实现多尺度特征融合模型的结构，需要确定多尺度特征融合模型中特性提取网络的个数L，本文通过实验优化的方法来确定。实验的思路是在共性特征网络后逐渐增加特性特征提取网络的个数，并且每增加一个特性特征提取网络，则当前特性特征提取网络比上一个特性特征提取网络多连接一个卷积块。第4章基于WAEA和多尺度特征融合的迁移学习模型42然后对每一个模型进行分类任务，直至网络过深导致模型出现过拟合使分类性能下降，此时认为具有最高分类性能的模型为我们需要的多尺度特征融合模型。图4.7不同特征提取网络个数下的分类准确率不同特性特征提取网络的个数的分类结果如图4.7所示，从图中我们可以看到，当仅使用共性特征提取网络分类时准确率较低，为85.17%。随着特征提取网络的个数从0增加到3个时分类准确率逐渐增加。当有3个特性特征提取网络，也就是得到3个特性特征和一个共性特征时，模型的分类准确率最高，而往后再增加特征提取网络的话，其分类准确率快速下降。这是因为网络架构越复杂其能够拟合的分类函数也越复杂，但对于训练样本的需求也越高。EEG样本数量较少导致网络容易出现过拟合使得其无法在过于复杂的模型上得到理想的结果。为此我们选择特性特征提取网络个数L=3，得到的多尺度特征融合迁移学习模型架构如图4.8所示。第4章基于WAEA和多尺度特征融合的迁移学习模型43图4.8多尺度特征融合迁移学习模型架构模型的输入是30×1000的矩阵，经过特性特征提取网络CFN的可分离卷积提取时间和空间特征。分别针对时序和通道的卷积得到EEG信号在时间和空间上的特征，这样做能够大大节省计算资源，并使用inception模块提取不同尺度的特征并拼接起来得到共性特征。在此基础上特性特征提取网络对EEG信号进行空间优化，使用了更多的滤波器和更小的卷积核。卷积层后面紧跟1个池化层用来减小特征图的尺寸，降低网络中的参数数量和计算复杂度，同时一定程度上提高网络的特征不变性和鲁棒性。在这之后把共性特征和3个特性特征都通过1个特征拼接层连接起来。最后用一个多层感知机对融合特征进行分类，其包括3个全连接层和1个softmax层。3个全连接层分别具有512和32和2个神经元，并通过dropout降低过拟合，丢弃概率设置为0.4。最后通过softmax进行分类预测，训练过程中使用标签平滑技术以提高模型的泛化能力。第4章基于WAEA和多尺度特征融合的迁移学习模型444.3.2实验结果与分析（1）分析多尺度特征融合迁移学习模型中特征融合的效果。为对比特征融前后的差异，进行有少量目标域数据作为校准数据情况下的对比试验。使用3.3.3节中介绍的有少量目标域数据时的数据集划分方法，选择一个被试数据作为目标域数据，剩余24个被试作为源域，校准比例的划分选择5%、10%、15%、20%、25%和30%。经过EA-WAEA对齐后，根据4.3.1节中的方法构建多尺度特征融合迁移学习模型，记该方法为MFTCNN。另外在共性特征提取网络后连接1至5层不同深度的特性特征提取网络，提取单尺度特征用于分类，记为TCNN1、TCNN2、TCNN3、TCNN4和TCNN5。其中TCNN1表示在共性特征提取网络后只使用一层的特性特征提取网络分类，其余命名规则类似。在20%的校准比例下，多尺度特征融合迁移学习模型与单尺度特征迁移学习模型的比较如表4.5所示。表4.5多尺度特征融合与单尺度特征迁移学习模型的跨被试分类结果模型accuracyf1-scoreprecisionrecallTCNN187.57%89.26%89.66%85.27%TCNN288.04%89.79%90.11%85.65%TCNN393.39%93.47%92.28%94.61%TCNN495.31%95.26%96.20%94.28%TCNN590.09%90.82%87.85%94.17%MFTCNN98.67%98.69%98.43%98.77%从表中可以看到使用多尺度特征融合的MFTCNN取得了最好的结果，达到98.67%的分类准确率，并且优于所有使用单尺度特征分类的迁移学习模型TCNN1至TCNN5。MFTCNN在accuracy、f1-score、precision和recall这四个指标上都取得了最好的分类结果，分别是98.67%、98.69%、98.43%和98.77%。另外在使用单尺度特征进行分类的任务上，深度为4的单尺度特征提取网络TCNN4取得了最好的分类准确率95.31%，这是由于有足够的网络深度能使其提取用于分类的特性特征，同时不算太复杂的网络结构使得其免于过拟合。从图4.9中我们更清楚的看到不同校准比例下多尺度特征融合迁移学习与单尺度迁移学习在准确率上的差距。我们提出的MFTCNN网络在所有校准比例下都取得了最好的分类结果，特别是在校准比例较少的时候优势更大。这说明了多尺度特征融合网络在少量训练数据下具有优异的特征提取能力，能得到第4章基于WAEA和多尺度特征融合的迁移学习模型45更好的分类性能。图4.9多尺度与单尺度模型迁移学习的准确率对比（2）与其他迁移学习方法进行对比。将本文提出的基于WAEA和多尺度特征融合的迁移学习模型与其他常用的迁移学习方法进行对比，主要选取了以下几种方法进行对比：文献[66]使用集成了Inception模块的卷积神经网络，通过迁移学习来提高对EEG数据的识别准确率，在预训练后对模型所有层进行微调操作来提高模型的分类性能。文献[67]对EEG信号进行短时傅里叶变换获得时频谱图像，将频谱图像送入预训练好的VGG-16卷积神经网络，逐步微调不同深度的卷积层最后分类。文献[68]则使用了域对抗神经网络，这是一种在图像处理领域被广泛应用的迁移学习方法，同时结合生成对抗网络辅助提取EEG的域不变特征。本文提出的多尺度特征融合迁移学习模型相比于以上几种方法进行了如下改进：首先在数据预处理阶段使用WAEA对齐的方式，降低了目标域和源域之间的差异，有效的增加了深度神经网络从源域中学习的能力，提高了网络在目标域上的分类性能。其次对迁移学习中微调的策略进行研究，没有直接微调全部卷积层，而是通过实验验证最优微调层，并提取出表现最好的部分作为共性特征提取网络用于后续分类。针对EEG信号非稳态、非线性、非高斯的特点，对共性特征提取网络提取的特征进行不同深度的卷积，得到多尺度特征并融合在一起用于分类，有效提高了模型对特征的提取能力，提高了跨被试的分类性能。第4章基于WAEA和多尺度特征融合的迁移学习模型46使用这3种算法与本文算法进行对比试验，在不同校准比例下同一测试集的结果如表4.6和图4.10所示。表4.6与其他迁移学习方法的对比校准比例算法accuracyf1-scoreprecisionrecall5%文献[66]88.62%88.43%90.57%86.42%文献[67]91.63%91.56%93.18%90.37%文献[68]71.68%69.99%74.49%66.37%本文95.08%95.05%96.11%94.34%10%文献[66]91.01%90.93%92.72%89.23%文献[67]93.52%93.51%94.86%92.22%文献[68]84.27%83.76%86.72%81.04%本文97.21%97.28%97.97%96.60%15%文献[66]91.73%91.64%93.36%90.06%文献[67]94.69%94.64%95.75%93.61%文献[68]86.39%85.98%88.59%83.62%本文97.78%97.36%98.37%97.20%20%文献[66]92.25%92.17%93.79%90.06%文献[67]95.04%94.97%96.11%94.37%文献[68]87.13%86.85%89.24%84.63%本文98.67%98.69%98.43%98.77%25%文献[66]92.79%92.68%94.21%91.26%文献[67]95.34%98.35%96.33%94.45%文献[68]89.37%89.16%91.21%87.23%本文99.14%99.20%99.39%99.21%30%文献[66]93.29%93.17%94.64%91.82%文献[67]95.17%95.15%96.12%94.23%文献[68]90.05%89.89%91.86%88.33%本文99.67%99.69%99.79%99.60%第4章基于WAEA和多尺度特征融合的迁移学习模型47图4.10与其他迁移学习方法在不同校准比例下的对比图4.11与其他迁移学习方法的对比从表4.6可以看到本文提出的方法在所有校准比例下都取得了最好的结果，在校准比例仅为5%得到的accuracy为95.08%，f1-score为95.05%，precision为96.11%，recall为94.34%，表现出让人满意的分类性能。图4.10更直观的展示了四种方法在不同校准比例下平均准确率的差异，图4.11则显示了四种方法在所有校准比例下平均后的平均准确率差异。可以看到文献[66]得到的效果差强人意，这可能是因为使用了Inception模块但是微调了所有卷积层，破坏了预第4章基于WAEA和多尺度特征融合的迁移学习模型48训练模型已经训练好的参数；文献[67]对微调策略进行了一定的改进，逐层微调卷积层，有效提高了分类性能，但是仅仅使用了单一尺度的特征，没有进一步探索特征提取的方法，与本文提出的基于WAEA和多尺度特征融合的迁移学习模型分类性能还有一定差距；而文献[68]使用的域对抗神经网络结合生成对抗网络的算法在校准数据较少时效果明显不如其他几种算法，这很可能是生成对抗网络在少量数据下表现不佳引起的，不过尽管随着校准比例的提高该方法的分类性能也快速提高。本文提出的方法在所有校准比例下具有最好的分类性能，这也说明了本文提出的算法在EEG迁移学习领域具有一定的优越性，能够有效应用于有少量目标域作为校准数据时的EEG跨被试疲劳驾驶检测分析。经过一系列的对比实验，证明本章提出基于WAEA的多尺度特征融合迁移学习模型相对单尺度特征迁移学习模型的跨被试分类准确率更高，具有更强的特征提取和分类能力，能够有效提高少量校准数据下的疲劳驾驶EEG跨被试分类准确率。4.4本章小结本章主要介绍了一种结合WAEA和多尺度特征融合的迁移学习模型。我们首先在WAEA对齐的基础上，对EEG领域常用的3种卷积神经网络进行逐层的微调，选出效果最佳的共性特征提取网络。然后在共性特征提取网络后连接上多个不同深度的特性特征提取网络。最后将多尺度特征融合并用多层感知机分类。通过在真实采集的疲劳驾驶数据集上进行不同校准比例的跨被试实验，并与其他学者提出的EEG领域的迁移学习方法进行对比，在多个指标上体现了本文提出的方法的有效性和先进性。第5章总结与展望49第5章总结与展望5.1总结疲劳驾驶作为道路交通安全的“头号杀手”，对人们的生命财产构成了严重威胁，探索检测疲劳驾驶的有效方法对减少交通事故的发生有重要意义。通过对脑电信号进行分析我们能够对疲劳驾驶状态进行有效的检测，然而对脑电信号进行跨被试分析仍存在一些困难，其一在于脑电信号的高度个体差异性使得模型进行跨被试分析的效果较差，往往需要大量新被试的脑电数据来对模型进行校准；其二在于脑电信号存在低信噪比的问题，其非线性、非平稳性和非高斯的特点对模型的特征提取能力提出了更高的要求。本文针对疲劳驾驶跨被试脑电信号分析需要大量数据用于校准和准确率不高的问题，提出了基于WAEA和多尺度特征融合的迁移学习模型，旨在使用较少校准数据的条件下得到尽量高的跨被试疲劳驾驶分类性能。本文完成的主要工作内容总结如下：（1）使用数据对齐的方法改善不同被试间的个体差异性，提高迁移学习中模型迁移的准确率。针对一种常用的数据对齐方法EA在少量目标域数据下表现不佳的问题，本文提出了有少量目标域数据的对齐方法WAEA和无目标域数据下的对齐方法AEA。AEA使用源域中的参考矩阵的平均对目标域参考矩阵进行估计，当有目标域数据用于校准时，WAEA利用矩阵之间的余弦相似度进行加权平均，并使用权衡参数来融合源域参考矩阵和目标域参考矩阵，以在较小的校准比例下得到更优的对齐结果。在真实采集的疲劳驾驶数据集上进行跨被试实验显示，经过本文提出的两种对齐方法处理后，常用的机器学习CSP+LDA和深度学习方法DeepCovNet的分类性能都有一定提高，并且对齐后使用迁移学习中的微调方法得到的分类性能显著提高，说明了对齐在迁移学习中的必要性。（2）使用多尺度特征融合网络提高模型的特征提取能力，并结合迁移学习提出了一种基于WAEA和多尺度特征融合的迁移学习模型，以在使用少量校准数据的情况下得到更好的分类性能。本文详细阐述了多尺度特征融合网络的构建，首先使用WAEA-EA对源域和目标域对齐来降低个体差异性，提高迁移学习的性能；然后使用源域数据在3种常用于脑电领域的CNN网络上进行预训第5章总结与展望50练，并在冻结模型部分卷积层的情况下用校准数据逐层微调，选择效果最好的网络的冻结部分作为共性特征提取网络；最后在共性特征提取网络后面连接上不同深度的特性特征提取网络，每个特性特征提取网络根据网络深度由若干个卷积块组成，用来提取不同尺度的特征，经过实验验证选择3个不同深度的特性特征提取网络。结合共性特征提取网络，融合得到的4个尺度的特征送入多层感知机分类。通过在真实采集的实验数据上进行不同校准比例的跨被试分类实验，比较accuracy、f1-score、precision和recall等指标，证明本文提出的方法在所有校准比例下都优于单尺度特征提取网络和其他3篇文献中的迁移学习算法，在校准比例仅为5%时得到的accuracy为95.08%，f1-score为95.05%，precision为96.11，recall为94.34%，有效利用了多尺度特征提高分类准确率，并使用迁移学习在少量校准数据下得到令人满意的分类性能。5.2展望虽然本文提出的基于改进的欧式空间对齐和多尺度特征融合的迁移学习疲劳驾驶识别模型能在校准数据较少的情况下得到令人满意的分类性能，但仍存在许多不足，后期主要从以下方面深入研究：（1）在完全没有目标域数据的情况下AEA对齐的效果较差，也无法通过微调的方式提高分类准确率，这种情况下需要提取脑电信号中的域不变特征用于分类，未来研究可以从提取域不变特征的角度着手。（2）本文采用了全部共30通道的脑电数据进行实验，未能对通道约减进行研究，过多的通道需求意味着会对数据采集工作造成一定困难，如果能进行通道约减，甚至仅使用前额电极进行分析，将会极大地促进EEG的应用，未来可以通过对通道间相关性的研究约减通道数，并探索单电极下的分类方法。参考文献52参考文献[1]ZhangJ,XiaoN.EEGandForeheadEOG-BasedDriverFatigueClassificationUsingSparse-DeepBeliefNetworks[C]//2021IEEE23rdIntConfonHighPerformanceComputing&Communications;7thIntConfonDataScience&Systems;19thIntConfonSmartCity;7thIntConfonDependabilityinSensor,Cloud&BigDataSystems&Application.IEEE,2021:1059-1066.[2]WangX,PengY,YiS,etal.Riskybehaviors,psychologicalfailuresandkinematicsinvehicle-to-poweredtwo-wheeleraccidents:resultsfromin-depthChinesecrashdata[J].AccidentAnalysis&Prevention,2021,24(3):103-115.[3]RoyA,GarnerAA,EpsteinJN,etal.Effectsofchildhoodandadultpersistentattention-deficit/hyperactivitydisorderonriskofmotorvehiclecrashes:Resultsfromthemultimodaltreatmentstudyofchildrenwithattention-deficit/hyperactivitydisorder[J].JournaloftheAmericanAcademyofChild&AdolescentPsychiatry,2020,59(8):952-963.[4]牛毅,李振明,樊运晓.基于数据挖掘的高速公路货车交通事故影响因素关联分析研究[J].安全与环境工程,2020,27(4):180-188.[5]JovicA.AReviewofEEGSignalFeaturesandTheirApplicationinDriverDrowsinessDetectionSystems[J].Sensors,2021,21(11),3786.[6]DongBT,LinHY.Anon-boardmonitoringsystemfordrivingfatigueanddistractiondetection[C]//202122ndIEEEInternationalConferenceonIndustrialTechnology(ICIT).IEEE,2021:850-855.[7]MillerKA,FiltnessAJ,AnundA,etal.ContributoryfactorstosleepinessamongstLondonbusdrivers[J].TransportationresearchpartF:trafficpsychologyandbehaviour,2020,73(5):415-424.[8]刘卡,余经历,许利峰.中国民用汽车保有状态及发展趋势分析[J].汽车实用技术,2017(1):67-68.[9]AlbadawiY,TakruriM,AwadM.Areviewofrecentdevelopmentsindriverdrowsinessdetectionsystems[J].Sensors,2022,22(5):534-579.[10]MuneerA,AbduljabbarAS,Al-DahwiAM.AssessingtheEffectofLackofSleeponDriver'sPerformance:ASimulatorStudy[J].EngineeringandTechnologyJournal,2021,39(12):1919-1926[11]HalimW,HaryonoAE.AnalysisofDrowsinesswithKarolinskaSleepinessScaleandHeartRatewhileDrivingwithThreeStageRoadDifficultyUsingDrivingSimulator[J].OPSI,2022,15(1):77-84.[12]MachadoMO,KangN,TaiF,etal.Measuringfatigue:ameta‐review[J].Internationaljournalofdermatology,2021,60(9):1053-1069.[13]DuG,LiT,LiC,etal.Vision-basedfatiguedrivingrecognitionmethodintegratingheartrateandfacialfeatures[J].IEEETransactionsonIntelligentTransportationSystems,2020,参考文献5322(5):3089-3100.[14]YangH,LiuL,MinW,etal.Driveryawningdetectionbasedonsubtlefacialactionrecognition[J].IEEETransactionsonMultimedia,2020,23(3):572-583.[15]LiK,GongY,RenZ.Afatiguedrivingdetectionalgorithmbasedonfacialmulti-featurefusion[J].IEEEAccess,2020,8(15):636-663.[16]LiZ,ChenL,NieL,etal.Anovellearningmodelofdriverfatiguefeaturesrepresentationforsteeringwheelangle[J].IEEETransactionsonVehicularTechnology,2021,71(1):269-281..[17]GuoM,LiS.OnlineDetectionofDriverFatigueBasedonReactionTime:DesigningaMonitoringandEarly-WarningSystem[M]//CICTP2020.2020:3534-3549.[18]KahlL,HofmannUG.RemovalofECGArtifactsAffectsRespiratoryMuscleFatigueDetection—ASimulationStudy[J].Sensors,2021,21(16):56-63.[19]PengY,LinY,FanC,etal.Passengeroverallcomfortinhigh-speedrailwayenvironmentsbasedonEEG:assessmentanddegradationmechanism[J].BuildingandEnvironment,2022,25(3):108-124.[20]ChengB,LuoX,MeiX,etal.Asystematicreviewofeye-trackingstudiesofconstructionsafety[J].FrontiersinNeuroscience,2022,16(3):63-85.[21]WangL,WangH,LiuJ.Discriminationofdriverfatiguebasedondistortionenergydensitytheoryandmultiplephysiologicalsignals[J].IEEEAccess,2021,9(1):151824-151833.[22]ChavarriagaR,UšćumlićM,ZhangH,etal.Decodingneuralcorrelatesofcognitivestatestoenhancedrivingexperience[J].IEEETransactionsonEmergingTopicsinComputationalIntelligence,2018,2(4):288-297.[23]AggarwalS,ChughN.ReviewofmachinelearningtechniquesforEEGbasedbraincomputerinterface[J].ArchivesofComputationalMethodsinEngineering,2022,14(3):1-20.[24]WangF,WanY,LiM,etal.RecentAdvancesinFatigueDetectionAlgorithmBasedonEEG[J].IntelligentAutomation&SoftComputing,2023,35(3):38-51.[25]WangL,JohnsonD,LinY.UsingEEGtodetectdrivingfatiguebasedoncommonspatialpatternandsupportvectormachine[J].TurkishJournalofElectricalEngineeringandComputerSciences,2021,29(3):1429-1444.[26]TuncerT,DoganS,SubasiA.EEG-baseddrivingfatiguedetectionusingmultilevelfeatureextractionanditerativehybridfeatureselection[J].BiomedicalSignalProcessingandControl,2021,68(17):67-89.[27]WangH,LiuX,LiJ,etal.Drivingfatiguerecognitionwithfunctionalconnectivitybasedonphasesynchronization[J].IEEETransactionsonCognitiveandDevelopmentalSystems,2020,13(3):668-678.[28]JingD,LiuD,ZhangS,etal.FatiguedrivingdetectionmethodbasedonEEGanalysisinlow-voltageandhypoxiaplateauenvironment[J].Internationaljournaloftransportationscienceandtechnology,2020,9(4):366-376.[29]BaccourMH,DriewerF,SchäckT,etal.ComparativeAnalysisofVehicle-Basedand参考文献54Driver-BasedFeaturesforDriverDrowsinessMonitoringbySupportVectorMachines[J].IEEETransactionsonIntelligentTransportationSystems,2022,23(12):23164-23178.[30]ZhengY,MaY,CammonJ,etal.AnewfeatureselectionapproachfordrivingfatigueEEGdetectionwithamodifiedmachinelearningalgorithm[J].ComputersinBiologyandMedicine,2022,147(1):165-184.[31]GuoF,HanC,HuZ,etal.Randomforestalgorithm-basedmulti-featurevectoroptimizationforfatiguedrivingvigilancemonitoring[C]//2020Chinesecontrolanddecisionconference(CCDC).IEEE,2020:3113-3118.[32]FangY,HanC,LiuJ,etal.FatigueDrivingVigilanceDetectionUsingConvolutionalNeuralNetworksandScalpEEGSignals[C]//20227thInternationalConferenceonMultimediaandImageProcessing.2022:137-142.[33]MuZ,HuJ,MinJ.Driverfatiguedetectionsystemusingelectroenceph-alographysignalsbasedoncombinedentropyfeatures[J].AppliedSciences,2017,7(2):150-173.[34]SanPP,LingSH,ChaiR,etal.EEG-baseddriverfatiguedetectionusinghybriddeepgenericmodel[C]//201638thAnnualInternationalConferenceoftheIEEEEngineeringinMedicineandBiologySociety(EMBC).IEEE,2016:800-803.[35]ZouS,QiuT,HuangP,etal.Thefunctionalbrainnetworkbasedonthecombinationofshortestpathtreeanditsapplicationinfatiguedrivingstaterecognitionandanalysisoftheneuralmechanismoffatiguedriving[J].BiomedicalSignalProcessingandControl,2020,62(3):242-267.[36]SubasiA,SaikiaA,BagedoK,etal.EEG-baseddriverfatiguedetectionusingFAWTandmultiboostingapproaches[J].IEEETransactionsonIndustrialInformatics,2022,18(10):6602-6609.[37]ChenJ,WangH,HuaC.Assessmentofdriverdrowsinessusingelectroencephalogramsignalsbasedonmultiplefunctionalbrainnetworks[J].InternationalJournalofPsychophysiology,2018,133(18):120-130.[38]ZengH,YangC,ZhangH,etal.AlightGBM-basedEEGanalysismethodfordrivermentalstatesclassification[J].Computationalintelligenceandneuroscience,2019,1(4):1-11.[39]LinCT,ChuangCH,HungYC,etal.Adrivingperformanceforecastingsystembasedonbraindynamicstateanalysisusing4-Dconvolutionalneuralnetworks[J].IEEEtransactionsoncybernetics,2020,51(10):4959-4967.[40]MoraHJ,PinoEJ.SimplifiedPredictionMethodforDetectingtheEmergencyBrakingIntentionUsingEEGandaCNNTrainedwitha2DMatricesTensorArrangement[J].InternationalJournalofHuman–ComputerInteraction,2023,39(3):587-600.[41]TorreyL,ShavlikJ.Transferlearning[M]//Handbookofresearchonmachinelearningapplicationsandtrends:algorithms,methods,andtechniques.IGIglobal,2010:242-264.[42]ZhangK,XuG,ZhengX,etal.ApplicationoftransferlearninginEEGdecodingbasedonbrain-computerinterfaces:areview[J].Sensors,2020,20(21):6321.[43]ZengH,ZhangJ,ZakariaW,etal.InstanceEasyTL:Animprovedtransfer-learningmethodforEEG-basedcross-subjectfatiguedetection[J].Sensors,2020,20(24):61-83.参考文献55[44]LiuY,LanZ,CuiJ,etal.Inter-subjecttransferlearningforEEG-basedmentalfatiguerecognition[J].AdvancedEngineeringInformatics,2020,46(31):351-387.[45]ShalashWM.DriverfatiguedetectionwithsingleEEGchannelusingtransferlearning[C]//2019IEEEInternationalConferenceonImagingSystemsandTechniques(IST).IEEE,2019:1-6.[46]LiuY,LanZ,CuiJ,etal.EEG-basedcross-subjectmentalfatiguerecognition[C]//2019InternationalConferenceonCyberworlds(CW).IEEE,2019:247-252.[47]KamrudA,BorghettiB,SchubertKabbanC.Theeffectsofindividualdifferences,non-stationarity,andtheimportanceofdatapartitioningdecisionsfortrainingandtestingofEEGcross-participantmodels[J].Sensors,2021,21(9):646-673.[48]MoriokaH,KanemuraA,HirayamaJ,etal.Learningacommondictionaryforsubject-transferdecodingwithrestingcalibration[J].NeuroImage,2015,111(3):167-178.[49]RazaH,SamothrakisS.Baggingadversarialneuralnetworksfordomainadaptationinnon-stationaryeeg[C]//2019InternationalJointConferenceonNeuralNetworks(IJCNN).IEEE,2019:1-7.[50]RasoulzadehV,ErkusEC,YogurtTA,etal.AcomparativestationarityanalysisofEEGsignals[J].AnnalsofOperationsResearch,2017,43(8):133-157.[51]DuttaS,NandyA.DataaugmentationforambulatoryEEGbasedcognitivestatetaxonomysystemwithRNN-LSTM[C]//ArtificialIntelligenceXXXVI:39thSGAIInternationalConferenceonArtificialIntelligence,AI2019,Cambridge,UK,December17–19,2019,Proceedings39.SpringerInternationalPublishing,2019:468-473.[52]BrigoF,TrinkaE,LattanziS,etal.Abriefhistoryoftypicalabsenceseizures—Petitmalrevisited[J].Epilepsy&Behavior,2018,34(15):346-353.[53]AcharyaJN,HaniAJ,CheekJ,etal.Americanclinicalneurophysiologysocietyguideline2:guidelinesforstandardelectrodepositionnomenclature[J].TheNeurodiagnosticJournal,2016,56(4):245-252.[54]WanZ,YangR,HuangM,etal.AreviewontransferlearninginEEGsignalanalysis[J].Neurocomputing,2021,26(3):1-14.[55]LotteF,BougrainL,CichockiA,etal.AreviewofclassificationalgorithmsforEEG-basedbrain–computerinterfaces:a10yearupdate[J].Journalofneuralengineering,2018,15(3):031005.[56]WuM,HuS,WeiB,etal.AnoveldeeplearningmodelbasedontheICAandRiemannianmanifoldforEEG-basedemotionrecognition[J].JournalofNeuroscienceMethods,2022,35(8):351-372.[57]NagabushanamP,ThomasGeorgeS,RadhaS.EEGsignalclassificationusingLSTMandimprovedneuralnetworkalgorithms[J].SoftComputing,2020,24(4):981-1003.[58]KhareSK,BajajV,AcharyaUR.SPWVD-CNNforautomateddetectionofschizophreniapatientsusingEEGsignals[J].IEEETransactionsonInstrumentationandMeasurement,2021,70(3):1-9.[59]ÖzdenizciO,WangY,Koike-AkinoT,etal.Transferlearninginbrain-computerinterfaces参考文献56withadversarialvariationalautoencoders[C]//20199thInternationalIEEE/EMBSConferenceonNeuralEngineering(NER).IEEE,2019:207-210.[60]HangW,FengW,DuR,etal.Cross-subjectEEGsignalrecognitionusingdeepdomainadaptationnetwork[J].IEEEAccess,2019,7(3):535-572.[61]ZaniniP,CongedoM,JuttenC,etal.Transferlearning:ARiemanniangeometryframeworkwithapplicationstobrain–computerinterfaces[J].IEEETransactionsonBiomedicalEngineering,2017,65(5):1107-1116.[62]HeH,WuD.Transferlearningforbrain–computerinterfaces:AEuclideanspacedataalignmentapproach[J].IEEETransactionsonBiomedicalEngineering,2019,67(2):399-410.[63]ZhangR,ZongQ,DouL,etal.HybriddeepneuralnetworkusingtransferlearningforEEGmotorimagerydecoding[J].BiomedicalSignalProcessingandControl,2021,63(3):453-481.[64]SchirrmeisterRT,SpringenbergJT,FiedererLDJ,etal.DeeplearningwithconvolutionalneuralnetworksforEEGdecodingandvisualization[J].Humanbrainmapping,2017,38(11):5391-5420.[65]LawhernVJ,SolonAJ,WaytowichNR,etal.EEGNet:acompactconvolutionalneuralnetworkforEEG-basedbrain–computerinterfaces[J].Journalofneuralengineering,2018,15(5):529-582.[66]Santamaria-VazquezE,Martinez-CagigalV,Vaquerizo-VillarF,etal.EEG-inception:AnoveldeepconvolutionalneuralnetworkforassistiveERP-basedbrain-computerinterfaces[J].IEEETransactionsonNeuralSystemsandRehabilitationEngineering,2020,28(12):2773-2782.[67]LiMA,XuDQ.AtransferlearningmethodbasedonVGG-16convolutionalneuralnetworkforMIclassification[C]//202133rdChineseControlandDecisionConference(CCDC).IEEE,2021,41(6):136-173.[68]ZengH,LiX,BorghiniG,etal.AnEEG-basedtransferlearningmethodforcross-subjectfatiguementalstateprediction[J].Sensors,2021,21(7):25-49.