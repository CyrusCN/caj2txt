一种基于 MCSVM 的多特征实时疲劳驾驶识别算法
黄菊，邓荣
（南通科技职业学院，江苏 南通 226007）

摘 要： 针对外部环境发生干扰时，依赖于单疲劳特征的基于 PERCLOS 的方法将可能无法工作的问

题，提出了一种基于 MCSVM 的多特征识别的疲劳驾驶识别算法，同时为了消除潜在的数据冗余，使用

灰色关联分析来选择最有效的疲劳特征，即面部特征和驾驶行为特征，以改善疲劳驾驶识别。通过使用

多类支持向量机 （MCSVM） 的分类器来修改面部特征和驾驶行为特征两个特征源的概率分配，以适应

不同特征源之间的决策冲突。实验结果表明，提出的识别方法优于单疲劳特征方法和基于单源融合的疲

劳驾驶识别方法。

关键词： 疲劳驾驶；MCSVM 识别方法；多特征；实时

DOI:10.16184/j.cnki.comprg.2021.05.050

1 概述

疲劳驾驶是导致道路交通事故的重要原因之一。 通

2 疲劳驾驶识别模型
2.1 问题定义

过 识 别 疲 劳 驾 驶 的 状 态 可 以 改 善 车 辆 行 驶 的 安 全 性 。

为了克服单源信息识别方法的局限性， 提出一种基

目 前 识 别 疲 劳 驾 驶 的 方 法 大 致 分 为 两 类 ： 基 于 视 觉 特

于多源信息的疲劳驾驶识别方法。 通常， 疲劳特征越多

征和基于非视觉特征的方法[1]。 视 觉 特 征 技 术主 要 通 过

越有助于改善疲劳驾驶识别 的准确性 [4]。 然而， 高维特

提 取 面 部 、 眼 睛 和 嘴 巴 等 面 部 特 征 ， 利 用 计 算 机 视 觉

征可能会带来更大的计算负担， 影响疲劳驾驶识别的实

技术通过分析眼睛和嘴巴的 状态来检测是否疲劳驾驶。

时性。 因此选择最有效的特征来实现疲劳驾驶的识别具

但 是 ， 外 部 干 扰 （如 照 明 变 化 ， 突 然 的 头 部 移 动 和 夜

有现实意义。

间 的 黑 暗 ） 会 降 低 识 别 的 精 度 。 基 于 非 视 觉 特 征 的 技

现有的疲劳识别模型主要有基于人工神经网络， 支

术也分为两类： 驾驶员生理分析和驾驶行为参数分析[2]。

持向量机和贝叶斯网络。 这些模型采用单级结构， 同时

非 视 觉 特 征 的 技 术 通 常 是 侵 入 性 的 ， 需 要 驾 驶 员 佩 戴

融合疲劳特征[5]。 然而， 在实际行 驶环境中由于 不 可 预

多 个 不 同 的 传 感 器 ， 而 直 接 接 触 会 给 人 带 来 不 舒 服 的

测的干扰 （例如突然的 光照变化， 缺少传感器信号等）

感 觉 ， 甚 至 干 扰 驾 驶 。 基 于 驾 驶 行 为 参 数 分 析 的 方 法

将导致某些疲劳特征测量的失败， 或者发生无法正常工

通 过 检 测 和 分 析 驾 驶 行 为 如 加 速 、 刹 车 、 换 档 和 转 向

作的情况。 还有一些疲劳识别模型采用基于 Dempster-

的 变 化 信 号 ， 来 识 别 疲 劳 驾 驶 ， 然 而 ， 具 有 模 糊 车 道

Shafer 证 据理论 （D-SET） 的两级融合结构， 然而， 无

标记的行驶环境可能会妨 碍这些方法的适用 性 [3]。 由此

法解决由不可预测的干扰引起的多个证据之间的证据冲

可 见 ， 基 于 单 源 信 息 的 识 别 方 法 在 获 取 可 靠 和 健 壮 的

突。 原因在于两级融合模型中使用的确定性基本概率分

数 据 方 面 具 有 不 可 避 免 的 局 限 性 ， 研 究 采 用 多 源 特 征

配 （BPA） 对于每个特征源都不够准确。 少量样本会降

的疲劳驾驶识别方法对改善疲劳驾驶识别具有十分重要

低疲劳驾驶识别的准确性， 模型不适合长时间在线疲劳

的意义。

驾驶识别。 其次， 在存在外部干扰的证据融合期间， 会

为了解决上述问题， 提出了一种基于 MCSVM 的多

带来证据冲突。 如果没有校正技术来处理证据冲突， 现

特征识别的疲劳驾驶识别方法。 考虑两种疲劳特 征源，

有模型就无法有效地产生能够适应实际行驶环境变化的

即 面 部 特 征 和 驾 驶 行 为 特 征 。 通 过 基 于 灰 色 关 联 分 析

精确的疲劳识别结果[6]。

（GRA） 的特征识别过程来选择最有 效的疲劳 特 征 ， 该

总之， 尽管一些方法应用多源信息来提高疲劳驾驶

特 征 识 别 过 程 减 少 了 计 算 负 担 并 且 排 除 了 潜 在 的 数 据

识别的效率， 但还存在一些限制。 首先， 通过简单地增

冗 余 。 通 过 基 于 多 类 支 持 向 量 机 （MCSVM） 分 类 器 的

修 改 BPA 消 除 潜 在 的 证 据 冲 突 ， 该 分 类 器 具 有 考 虑 冲

基金项目： “江苏省高等职业院校专业带头人高端研修

突证据的校正技术。 在可靠性方面， 尤其在发生外部干

资助项目”

（No.2018GRFX039）； 南通市科技计划项目

扰时， 提出的方法优于基于闭眼百分比 （PERCLOS） 的

“基于视觉行为识别的疲劳驾驶 DSP 监测预警系统的研

方法。

122

2021.5

究与应用”

（No.YYZ17077）。

加疲劳特征的数量， 并不能改善实时疲劳驾驶识别。 疲

劳特征太多会带来更大的计算负 担和数据冗余。 其次，

疲劳识别模型应提高建模灵活性， 以处理由行驶环境变

化引起的干扰而带来的特征之间的证据冲突。

表示第j 个样本数据的疲劳水平值， Xi（j） 表示第 j 个样本
数据的第 i 个疲劳特征值， 其中 X1（j）， X2（j）， ...， X7（j）
和 X8（j） 分别表示第 j 个样本数据的眨眼频率 （BF）， 闭
眼持续时间 （ECD）， 眼 睛 张 开 度 （MEOL）， 打 哈 欠 频

2.2 基于多特征识别和多源信息的疲劳驾驶识别模型

率 （ YF） ， 方 向 盘 下 降 频 率 （ SWF） ， 加 速 变 化 频 率

为了解决上述限制， 提出一种基于多特征识别和多

（ACF）， 加速和离合器匹配度 （ACS） 以及换档时间变

源信息的两级融合的疲劳驾驶识别方法。 考虑两种疲劳

化的百分比 （STC） 的测量值。

特征源， 即面部特征和驾驶行为特征。 通过基于灰色关

（2） 样本数据归一化

联分析 （GRA） 的特征识别过程来选择最有效的疲劳特

对样本数据进行归一化：

征， 该特征识别过程减少了计算负担并排除了潜在的数

据 冗 余 。 然 后 通 过 基 于 多 类 支 持 向 量 机 （MCSVM） 分

类 器 来 修 改 BPA 消 除 潜 在 的 证 据 冲 突 ， 该 分 类 器 具 有

处理证据冲突的校正技术。

2.3 确定疲劳驾驶识别模型的疲劳特征源

使用面部特征和驾驶行为特征来表征驾驶员的疲劳

状态。 考虑的面部特征包括眨眼频率 （BF）， 闭眼持续

时 间 （ ECD） ， 眼 睛 张 开 度 （ MEOL） 和 打 哈 欠 频 率

（ YF） 。 考 虑 的 驾 驶 行 为 特 征 包 括 方 向 盘 下 降 频 率

（SWF）， 加 速 变 化 频 率 （ACF）， 加 速 和 离 合 器 匹 配 度

（ACS） 以及换 档 时 间 变 化 的 百 分 比 （STC）， 将 这 些 特

其中 i = 1,2， ……， M,j = 1,2， ……， N。

（3） X0（j） 和 Xi（j） 之间的灰色关系计算

灰色关系系数计算方法如下：

（1）

（2）

其中 ρ 是 [1] 中的系数， 可以通过实验确定， 用于

更好地区分父数据序列和子数据序列。

（4） 将灰色关系系数转换为灰色关系密度 γj（0， i）

（3）

征作为候选疲劳特征。

j=1,…， N.

3 基于灰色关联分析的疲劳特征识别

（5） 子序列的灰色关系系数的熵 E（i）

执行效率和模型的可靠性是设计实时疲劳驾驶识别

在获得灰色关系密度 γj（0， i） 之后， 可以获得每个

模型的两个不可调和的矛盾。 从执行效率的角度看， 如

子序列的灰色关系系数的熵 E（i）：

果仅包含较少的疲劳特征， 则识别模型可以更快地计算

得出结果。 但是， 从模型可靠性的角度来看， 包含的疲

（4）

劳特征越多识别模型的结果越可靠。 这是因为当传感器

其中

的项表示父序列 X0（j） 和 Xi（j） 子

由于不可预测的干扰而在基于多源的识别系统中出现故

障时， 可以通过基于数据融合算法的其他传感器获得可

靠的识别结果。 所以对所选疲劳特征的数量要做权衡，

选择最有效的疲劳特征作为疲劳识别模型的输入。

为了减少多特征导致的计算负担， 模型中仅采用与

疲劳驾驶高度相关的特征。 GRA 方法与其他方法相比，

具有样本量小， 不受功能形式限制， 不需要独立性或正

态分布， 计算量少等优点 。 因此选用 GRA 方 法 执 行 疲

劳特征和疲劳状态之间的相关性分析， 并选择最有效的

疲劳特征。 具体步骤如下：

序列之间的灰熵， 并且 ln（N） 是最大灰度熵，

。

（6） 灰色关联度 （GRD）

通过将熵 E（i） 与子 序 列 Xi（j） 的 平 均 灰 色 关 系 系

数相乘， 得到灰色关联度 （GRD）：

（5）

其 中 D（i）∈[0,1] 是 子 序 列 和 父 序 列 之 间 的 GRD。

D（i）的值 越 大 表 示 子 序 列 和 父 序 列 之 间 的 相 关 程 度 越

高。 因此， GRD 可用于识别疲劳特征的有效性。
4 基于 MCSVM 的多特征融合研究

（1） 基于疲劳特征测量和疲劳状态评估

一些融合策略被广泛使用于多模态的疲劳驾驶识别

根据前面评估的疲劳状态进一步定义样本数据的疲

模 型 中 ， 例 如 决 策 级 融 合 （ DLF） 和 特 征 级 融 合

劳程度。 将收集的样本视为一组离散数据序列， 用 X0（j）
和 Xi（j） 表示， 其中 i = 1,2， ...， M， j = 1， 2， ...， N， 其
中 X0（j） 表 示 父 数 据 序 列 ， Xi（j） 表 示 子 数 据 序 列 。 这
里 ， M = 8 表 示 前 面 提 出 的 8 个 候 选 疲 劳 特 征 。 X0（j）

（FLF）。 对于 DLF， 来自不同模态的数据在不同的回归

模型中训练， 最终值是从回归模型计算的所有结果中挑

选的最大值。 对于 FLF， 来自不同模态的特征向量被集

中 到 更 大 的 特 征 向 量 中 。 这 些 融 合 策 略 被 证 明 是 有 效

2021.5

123

的。 提出基于多特征识别和多源信息的两级融合的疲劳

此， 提出一种基于基本 SVM 分 类 器 和 “一 对 一 ” 策 略

驾 驶 识 别 方 法 。 模 型 结 构 如 图 1 所 示 。 在 特 征 级 融 合

的新概率分类方法。 具体过程如下：

中， 面部特征和驾驶行为特征分别是两个 MCSVM 分类

1） 给定一个具有 n 个元素的疲劳特征向量的 数 据

器 MCSVM-1， MCSVM-2 的 输 入 ， 为 决 策 级 融 合 实 时

集

，

， 且

是 xi 的 类 标 签 。

生成动态 BPA。 前一时间 t-1 的融合结果作为证据之一

这里， kF 是评估疲劳状态的数量。

输 入 ， 并 使 用 改 进 的 D-S 证 据 组 合 规 则 来 解 决 证 据 冲

突， 得出 t 时刻的融合结果。

t 时 刻

面 部 特 征

驾 驶 行 为 特 征

MCSVM-1

MCSVM-2

MCSVM-1 的
输 出 概 率

MCSVM-2 的
输 出 概 率

BPA-1
证 据 源 1

BPA-2
证 据 源 2

改 进 的 D-S 证 据 组 合 规 则

上 一 时 刻 t-1
的 融 合 结 果

BPA-3
证 据 源 3

BPA 决 策
融 合

t 时 刻 疲 劳
识 别 结 果

下 一 时 刻 t+1
的 融 合

2） 构造 NM 二分类 SVM 分类器， 其中 NM=kF（kF-1）/2。
3） 在 NM SVM 分类器中， 对于为第 i 和第 j 类的样
本数据构造的二类分类器， 属于第 i 类的 x 的后验概率

可以计算为：

4） 对 于 两 种 疲 劳 状 态 的 分 类 ， 属 于 第 i 种 疲 劳 状

态的 x 的最终后验概率可以计算为：

（7）

（8）

5 实验及结果分析
5.1 实验过程

选择最有效的疲劳特征进行实时测量， 然后将这些

最有效的疲劳特征作为输入参数由训练的 MCSVM 分类

器融合， 以产生实时概率输出， 用于下一步的决策级融

合。 最后， 基于最终融合的结果， 使用设定的决策规则

确定驾驶员的疲劳状态， 并验证所提出的方法的有效性。

图 1 疲劳驾驶识别流程图

实验共收集 500 个数据点， 每个数据点包含 8 个疲

支持向量机 （SVM） 是一种基于统计学习理论的模

式识别方法， 与人工神经网络和基于贝叶斯的分类方法

相比， 在解决小样本、 非线性和高维模式识别等问题中

具有显著优势。 基本的 SVM 分类器是一个二分类模型，

但不能实现多类分类。 为了将疲劳特征数据分类为多个

类标签， 提出了一种基于 MCSVM 分类器的特征级融合

方 法。 引入 S 形函数以基于 基 本 SVM 分 类 器 利 用 两 个

劳特征。 训练集包括 350 个数据点用于模型校准， 测试

集包括 150 个数据点用于模型验证。 计算每个疲劳特征

和疲劳驾驶状态之间的 GRD， 根据 GRD 等级 ， 选择具

有较大 GRD 值的疲劳特征作为最有效的疲劳特征。 为了

确定 GRD， 如果样本的疲劳状态是清醒， 则疲劳水平量

化为 1； 如果样本的疲劳状态是疲劳， 则疲劳水平量化

为 3。 从采集的数据点中随机选择 400 个样本数据以进

类标签执行数据的概率分类。 然后， 引入 “一对一” 策

行相关性分析。 8 种疲劳特征的 GRD 值如图 2 所示。

略来计算具有多个类别标签的数据的多类概率分类。

（1） 基于二分类 SVM 的概率分类

使用后验概率来分类疲劳状态。 BPA 由专家根据经

验或者统计结果确定。 往往过于主观， 针对 这个问题，

根 据 实 时 输 出 结 果 为 每 个 证 据 源 分 配 BPA 质 量 函 数 。

为了解决这个问题， 引入一个 sigmoid 函数来计算 后 验

D
R
G

概率

。

（6）

（2） 基于多类 SVM 的概率分类

基于二进制类 SVM 的概 率 分 类 的 方 法 仅 适 用 于 二

分 类 。 对 于 多 类 分 类 问 题 ， 与 “ 一 对 多 ” 策 略 相 比 ，

“一对一” 策略在实践中的训练时间方面表 现更好。 因

0.90

0.88

0.86

0.84

0.82

0.80

0.78

0.76

124

2021.5

有 效 特 征
无 效 特 征

BF

ECD

ACS

YF

ACF

SNF MEOL

STC

疲 劳 特 征

图 2 疲劳特征的 GRD 值

5.2 实验结果

方法也可以通过分解前一时刻的融合结果来正确识别驾

为了验证基于 MCSVM 的多特征识别疲劳驾驶识别

驶员的疲劳状态。

算法的有效性， 将基于 MCSVM 的多特征识别方法与现

6 结语

有的单疲劳特征的基于 PERCLOS 的方法和基于单 源融

为了解决外部环境发生干扰时， 依赖于单疲劳特征

合的疲劳驾驶识别方法进行了比较 。 使 用 Caltech 人 脸

的基于 PERCLOS 的方法将可能无法工作的问题 ， 提出

数据库验证所提方法的有效性。 加州理工学院的人脸数

了 一 种 基 于 MCSVM 的 多 特 征 识 别 的 疲 劳 驾 驶 识 别 方

据库由 25 个人组成的 450 张正 面图像组 成 ， 图 像 多 样

法 。 考 虑 两 种 疲 劳 特 征 源 ， 即 面 部 特 征 和 驾 驶 行 为 特

化的环境， 灯光和面部表情使其具有与实际驾驶类似的

征。 通过基于灰色关联分析 （GRA） 的特征识别过程来

条件。

选择最有效的疲劳特征， 该特征识别过程减少了计算负

在 实 验 中 采 用 改 进 的 D-S 证 据 组 合 规 则 融 合 3 种

担并且排除了潜在的数据冗余， 提高了识别模型的效率

信息， D-S 证据理论的识别框架为： Θ= {清醒， 疲劳}，

和 可 靠 性 。 通 过 基 于 多 类 支 持 向 量 机 （MCSVM） 分 类

证据集为： e= {面部疲劳特征， 驾驶行为特征， 上一时

器的 修 改 BPA 消 除 潜 在 的 证 据 冲 突 ， 该 分 类 器 具 有 考

刻 的融合结果}。 其中， 证 据 源 面 部 特 征 、 驾 驶 行 为 特

虑冲 突 证 据 的 校 正 技 术 。 通 过 修 改 BPA 并 结 合 前 一 时

征的 BPA 质量函数可由公式 （6） 计算获得， 而上一时

间识别的疲劳状态来增强识别模型的可靠性， 优于基于

刻识别状态的质量函数值， 则是由上一时刻多信息融合

闭眼百分比 （PERCLOS） 的方法。

后获取的概率。 然后参照公式 （7） 进行证据组合。 最

参考文献

后 ， 进 行 疲 劳 状 态 决 策 ， 采 用 基 于 BPA 的 决 策 方 式 ，

[1] S. Kaplan, M. A. Guvensan, A. G. Yavuz, and Y. Kar-

面 部 疲 劳 特 征
驾 驶 行 为 特 征
改 进 D-S 融 合

即在进行了证据组合之后进行决策。

1.00

0.95

0.90

0.85

0.80

0.75

0.70

率
别
识
均
平

样 本 1

样 本 2

样 本 3

样 本 4

样 本 5

样 本 6

alurt,

“ Driver behavior analysis for safe driving: A

survey,” IEEE Trans. Intell. Transp. Syst., vol. 16, no.

6, pp. 3017-3032, Dec. 2015.

[2] 林雨培, 陈兰岚, 邹俊忠． 基于粒子群的混合特征

选择在疲劳驾驶中的应用． 计算机工程, 2018.

[3] 张长隆. 一种基于多传感器融合的疲劳驾驶检测方

法 [J] . 汽车实用技术, 2018,

(24) : 131-134.

[4] 郭慧利, 王恁, 郭浩. 基于面部多特征的疲劳驾驶

预 警 系 统 的 研 究 [J]

. 通 信 学 报, 2018, 39 (S1)

:

22-29.

[5] 毛须伟, 景文博, 王晓曼, 刘学, 张姗姗, 张茂桢.

一种基于眼部状态的疲劳驾驶检测方法 [J] . 长春

理 工 大 学 学 报 ( 自 然 科 学 版 ), 2016, 39 ( 02)

:

样 本 数 据

125-130+136.

图 3 改进的 D-S 多源融合与单源疲劳状态识别对比

[6] 祁亚茹. 基于面部特征融合的驾驶员疲劳识别算法

实验结果表明， 如图 3 所示， 将上一时刻的疲劳识

研究 [D] . 华南理工大学, 2019.

别结果、 面部疲劳特征及驾驶行为特征融合， 平均识别

率明显提高。 融合算法不仅避免单个证据判别的局限及

易受其他因子造成误判， 而且即使当来自不同特征源的

疲劳特征测量值由于外部环境的突然变化而失效时， 该

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
(上接第 113 页)
能， 规范了计帐流程， 为机具管理人员提供了统一帐务

[2] 尚品科技. Excel VBA 编程实战宝典. 清 华 大 学 出

社, 2019.

管理， 在实际工作中得到了应用。

版社, 2020.

[1] 宋阳. Excel 2016 VBA 入门与应用. 清华大学出版

参考文献

2021.5

125

