硕  士  学  位  论  文 

题   目: 基于多源特征融合的疲劳驾驶检测方法研究 

    研 究 生                       胡校飞                         

    专    业                 电子与通信工程                 

    指导教师                  陈龙  教授                      

    企业导师                                                          

完成日期     2022 年 05 月    

 
 
 
 
 
 
 
 
 
             
 
 
 
 
 
 
 
 
 
 
杭州电子科技大学硕士学位论文 

基于多源特征融合的疲劳 

驾驶检测方法研究 

                                          研  究  生：胡校飞 

                                          指导教师：陈 龙  教授 

 2022 年 05 月 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Dissertation Submitted to Hangzhou Dianzi  

University for the Degree of Master 

Research on fatigue driving detection  
methods based on multi-source  
characteristics fusion 

                Candidate:  XiaoFei Hu 

                Supervisor:  P. Long Chen 

May, 2022 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
杭州电子科技大学硕士学位论文 

摘  要 

错综复杂的道路环境导致频繁的交通事故，而疲劳驾驶一直是交通事故的主要原因，疲

劳驾驶检测因其在交通事故预防方面的广阔发展前景而受到科技人员的广泛关注。驾驶员的

疲劳状态极易受到自身因素和外部环境的干扰，造成疲劳驾驶检测实时性差、可靠性弱等诸

多问题。采用驾驶员生理信息、面部动态信息和车辆运动信息等多信息源融合的非接触式检

测方法能提高检测准确性和可靠性。因此，研究非接触式多信息源融合的疲劳驾驶检测方法

可以及时预防交通事故。 

本文设计了基于生理信息和面部动态信息融合的非接触式疲劳驾驶检测方法，主要包括

疲劳驾驶数据采集、疲劳特征提取和疲劳状态识别模型设计三个部分。文中首先以模拟驾驶

实验平台为基础，设计非接触式疲劳驾驶数据采集系统，利用多普勒雷达探测人体胸腔变化

获取生理信号，采用 Dlib 搭建人脸检测环境采集驾驶员脸部 68 点特征信息。其次设计零相

位 IIR 滤波器从雷达信号中分离呼吸信号和心跳信号，提取生理信号特征，同时提出眼睑纵

横比、嘴部纵横比和头部姿态估计对 Dlib 人脸特征信息分析，提取面部疲劳特征，根据疲

劳驾驶等级评判机制建立多信息源疲劳驾驶数据集。然后在 RELM（Regularized  Extreme 

Learning  Machine，RELM）基础上引入 ROS-ELM（Regularized  Online  Sequential  Extreme 

Learning  Machine，ROS-ELM）网络，由于 ROS-ELM 存在参数随机选取和模型泛化能力弱

的 问 题 ， 通 过 自 适 应 权 重 粒 子 群 优 化 （ Adaptive  Weight  Particle  Swarm  Optimization ，

AWPSO）算法对 ROS-ELM 进行改进，构建性能更优的 AWPSO-ROS-ELM 疲劳状态识别模

型。最后为改善多源特征数据冗杂重叠的现象，将 LDA（Linear  Discriminant  Analysis）特

征融合技术与 AWPSO-ROS-ELM 结合，设计多源特征融合的疲劳状态识别模型。 

通过多种极限学习机模型对疲劳驾驶数据样本训练测试，结论得出 AWPSO-ROS-ELM

较 ROS-ELM 识别率提升 5.42%，验证了本文所设计分类模型的可行性。为验证多源特征融

合对 AWPSO-ROS-ELM 的增益效果，文中分析对比分类算法 SVM（Support  Vector  Machine，

SVM）和 BPNN（Back  Propagation  Neural  Network，BPNN）。AWPSO-ROS-ELM 训练速度

和识别精度表现最佳，在特征融合后识别准确率达到 95.42%，提升 13.5%。同时表明，本

文非接触式多源特征融合的疲劳驾驶检测方法能够有效地对驾驶员疲劳状态做出实时检测。 

关键字：疲劳驾驶检测，非接触式，多信息源，AWPSO-ROS-ELM，特征融合 

I 

 
 
杭州电子科技大学硕士学位论文 

ABSTRACT 

The  intricate  road  environment  leads  to  frequent  traffic  accidents,  and  fatigue  driving  has 

always been the  main cause of  traffic accidents. Fatigue driving detection has  attracted extensive 

attention of scientific and technological personnel due to its broad development prospects in traffic 

accident prevention. The driver's fatigue state is easily disturbed by its own factors and the external 

environment, resulting in many problems such as poor real-time performance and weak reliability 

of  fatigue  driving  detection.  The  non-contact  detection  method  using  the  fusion  of  multiple 

information  sources  such  as  driver's  physiological  information,  facial  dynamic  information  and 

vehicle motion information can improve the detection accuracy and reliability. Therefore, the study 

of  non-contact  multi-information  source  fusion  fatigue  driving  detection  method  can  promptly 

prevent traffic accidents. 

This  thesis  designs  a  non-contact  fatigue  driving  detection  method  based  on  the  fusion  of 

physiological  information  and  facial  dynamic  information,  which  mainly  includes  three  parts: 

fatigue driving data collection, fatigue feature extraction and fatigue state recognition model design. 

In this thesis, based on the simulated driving experimental platform, a non-contact fatigue driving 

data acquisition system is designed. Doppler radar is used to detect changes in the human thorax to 

obtain physiological signals, and Dlib is used to build a face detection environment to collect 68-

point  feature  information  of  the  driver's  face.  Secondly,  a  zero-phase  IIR  filter  is  designed  to 

separate the breathing signal and the heartbeat signal from the radar signal, and the physiological 

signal features are extracted. At the same time, the eyelid aspect ratio, mouth aspect ratio and head 

pose estimation are proposed to analyze the face feature information of Dlib, and the facial fatigue 

feature is extracted. , and establish a multi-information source fatigue driving data set according to 

the  fatigue  driving  level  evaluation  mechanism.  Then,  the  ROS-ELM  (Regularized  Online 

Sequential Extreme  Learning  Machine,  ROS-ELM)  network  is  introduced  on  the  basis  of  RELM 

(Regularized  Extreme  Learning  Machine,  RELM).  Due  to  the  problems  of  random  parameter 

selection and weak model generalization ability of ROS-ELM, the automatic The adaptive weight 

particle  swarm  optimization  (Adaptive  Weight  Particle  Swarm  Optimization,  AWPSO)  algorithm 

improves ROS-ELM and builds a better performance AWPSO-ROS-ELM fatigue state recognition 

model.  Finally,  in  order  to  improve  the  phenomenon  of  redundant  and  overlapping  multi-source 

feature data, the LDA (Linear Discriminant Analysis) feature fusion technology is combined with 

II 

AWPSO-ROS-ELM  to  design  a  fatigue  state  recognition  model  based  on  multi-source  feature 

杭州电子科技大学硕士学位论文 

fusion. 

Through training and testing of fatigue driving data samples through various extreme learning 

machine  models,  it  is  concluded  that  the  recognition  rate  of  AWPSO-ROS-ELM  is  improved  by 

5.42% compared with ROS-ELM, which verifies the feasibility of the classification model designed 

in  this  thesis.  In  order  to  verify  the  gain  effect  of  multi-source  feature  fusion  on  AWPSO-ROS-

ELM,  this  thesis  analyzes  and  compares  the  classification  algorithms  SVM  (Support  Vector 

Machine,  SVM)  and  BPNN  (Back  Propagation  Neural  Network,  BPNN).  AWPSO-ROS-ELM 

performs  the  best  in  terms  of  training  speed  and  recognition  accuracy.  After  feature  fusion,  the 

recognition accuracy reaches 95.42%, an increase of 13.5%. At the same time, it is shown that the 

non-contact multi-source feature fusion fatigue driving detection method studied in this thesis can 

effectively detect the driver's fatigue state in real time. 

Keywords: Fatigue driving detection, Non-contact, Multi-information source, AWPSO-ROS-ELM, 

Feature fusion  

III 

 
杭州电子科技大学硕士学位论文 

目 录 

摘  要 ..................................................................................................................................................... I 

ABSTRACT ....................................................................................................................................... II 

第 1 章 绪论 ......................................................................................................................................... 1 

1.1 研究背景及意义 .................................................................................................................... 1 

1.2 国内外关于疲劳驾驶检测的研究现状及分析 .................................................................... 2 

1.2.1 基于驾驶员生理信息的检测方法 ............................................................................. 2 

1.2.2 基于驾驶员面部动态信息的检测方法 ..................................................................... 3 

1.2.3 基于车辆运动信息的检测方法 ................................................................................. 4 

1.2.4 疲劳驾驶检测技术研究动态分析 ............................................................................. 5 

1.3 主要研究内容与目标 ............................................................................................................ 6 

1.4 本文结构 ................................................................................................................................ 7 

第 2 章 疲劳驾驶实验平台搭建及信息采集 ..................................................................................... 9 

2.1 模拟驾驶系统设计 ................................................................................................................ 9 

2.2 疲劳驾驶数据采集系统设计 .............................................................................................. 10 

2.2.1 生理信号采集模块设计 ........................................................................................... 10 

2.2.2 面部动态特征采集模块设计 ................................................................................... 11 

2.3 疲劳驾驶数据采集系统调试 .............................................................................................. 13 

2.3.1 生理信号采集模块调试 ........................................................................................... 13 

2.3.2 面部动态特征采集模块调试 ................................................................................... 14 

2.4 驾驶员疲劳状态信息采集 .................................................................................................. 15 

2.5 本章小结 .............................................................................................................................. 15 

第 3 章 疲劳特征提取与数据集建立 ............................................................................................... 16 

3.1 基于驾驶员生理信息的疲劳特征提取 .............................................................................. 16 

3.1.1 IIR 滤波器 ................................................................................................................ 16 

3.1.2 零相位 IIR 滤波器设计 ........................................................................................... 17 

3.1.3 零相位 IIR 滤波器仿真效果 ................................................................................... 18 

3.1.4 生理信号特征提取 ................................................................................................... 19 

3.2 基于驾驶员面部动态信息的疲劳特征提取 ...................................................................... 19 

3.2.1 眼部运动特征提取 ................................................................................................... 19 

3.2.2 嘴部表情特征提取 ................................................................................................... 21 

3.2.3 头部姿态特征提取 ................................................................................................... 23 

3.3 疲劳驾驶数据集的建立 ...................................................................................................... 26 

IV 

杭州电子科技大学硕士学位论文 

3.3.1 疲劳驾驶等级评判 ................................................................................................... 26 

3.3.2 建立疲劳驾驶数据集 ............................................................................................... 26 

3.4 本章小结 .............................................................................................................................. 27 

第 4 章 基于 AWPSO-ROS-ELM 的驾驶员疲劳状态检测 ............................................................ 28 

4.1 正则在线序贯极限学习机 .................................................................................................. 28 

4.1.1 极限学习机理论 ....................................................................................................... 28 

4.1.2 正则化极限学习机 ................................................................................................... 31 

4.1.3 正则在线序贯极限学习机 ....................................................................................... 32 

4.2 自适应权重粒子群优化算法 .............................................................................................. 34 

4.2.1 经典粒子群优化算法 ............................................................................................... 34 

4.2.2 自适应惯性权重优化 PSO ...................................................................................... 36 

4.3 构建 AWPSO-ROS-ELM 疲劳状态识别模型 ................................................................... 37 

4.4 实验结果与分析 .................................................................................................................. 38 

4.4.1 实验环境与性能评价指标 ....................................................................................... 39 

4.4.2 实验结果分析 ........................................................................................................... 39 

4.5 本章小结 .............................................................................................................................. 44 

第 5 章 基于多源特征融合的驾驶员疲劳状态检测 ....................................................................... 45 

5.1 多源特征融合 ...................................................................................................................... 45 

5.1.1 信息融合理论 ........................................................................................................... 45 

5.1.2 LDA 特征融合技术 .................................................................................................. 46 

5.2 构建多源特征融合的疲劳状态识别模型 .......................................................................... 50 

5.3 实验结果与分析 .................................................................................................................. 51 

5.3.1 比较模型 ................................................................................................................... 51 

5.3.2 实验结果分析 ........................................................................................................... 51 

5.4 本章小结 .............................................................................................................................. 55 

第 6 章 总结与展望 ........................................................................................................................... 56 

6.1 工作总结及创新点 .............................................................................................................. 56 

6.2 研究展望 .............................................................................................................................. 57 

致  谢 .................................................................................................................................................. 58 

参 考 文 献 ......................................................................................................................................... 59 

附 录 ................................................................................................................................................... 64 

V 

 
杭州电子科技大学硕士学位论文 

第 1 章 绪论 

1.1 研究背景及意义 

随着国家生产力水平的不断发展，人们对出行工具的选择也逐渐增多，汽车技术迅猛发

展的背后表现出人们对幸福生活的追求，汽车已经成为人们出行工具的首选。汽车出行使得

人们日常生活更加便捷，川流不息的车辆同时也带来频繁的道路安全事故，超高的交通事故

发生率已经严重威胁到人类生命财产安全。根据世界卫生组织过去十年发布的交通安全报告，

在全球每年都会有一百万以上的人由于车祸而丢掉了生命，另外上百万人在各类交通事故中

身心上遭受了各种程度的影响损失[1]。随着车祸事故数量日益增加，其问题的严重性也开始

受到了社会各界的广泛关注。车祸事故已经成为道路交通安全的重要问题，如何避免减少道

路交通事故保证安全道路行驶已经成为人类急需解决的问题之一[2]。 

驾驶员是行车驾驶中的主角，同样驾驶员的状态时刻影响车辆行驶，在众多交通事故中，

疲劳驾驶是引起驾驶员发生车祸伤亡的重要原因[3]。Klauer 等人研究证实，汽车司机在疲劳
状态时更易发生车祸，发生的几率是正常开车时的三倍以上[4]。根据相关统计资料表明，全

美每年有十万起以上车祸是由于疲劳驾驶的因素所造成的；法国每年有超过三分之一的人因

为疲劳驾驶而出现车祸，其中 14.9%出现个人伤害严重事故，有 20.6%造成个人重大伤亡；

而在中国，平均每年在疲劳驾驶上出现的车祸约占所发生数量的 20%以上，特大车祸更达

到了 40%以上，而死亡率约为普通车祸的 83%[5]。这些数据让人触目惊心，因为人的习惯让

疲劳驾驶慢慢变成了道路驾驶时频发问题，绝大部分驾驶员已经认识到疲劳驾驶的危害性。

驾驶员在疲劳时会出现注意力不同程度的下降，大脑反应也会明显变慢，经常表现出肢体动

作不协调的现象，面对复杂的道路车辆情况，无法对突发事件做出迅速动作反应，如果没有

采取有效的安全措施时，交通事故也就随之而来[6]。随着专家学者对疲劳驾驶课题展开了深

入研究，为了得出具体的解决方案，越来越多的人逐渐关注疲劳驾驶，避免疲劳驾驶成为当

下热门话题。 

当下，驾驶员疲劳驾驶是一种广泛关注的社会性问题，不但威胁驾驶员自身安全，还会

对别的车辆行人的安全造成危害。目前迫切的需要有效的检测方法，进而防止驾驶员疲劳驾

驶。各国为了采取相应措施减少疲劳驾驶事故，颁布法律法规去限制驾驶员的正常行车驾驶

时长。我国道路交通安全法中明文规定，汽车司机长时间的行车驾驶不能超过四个小时，要

求超出四个小时的应当停止休息二十分钟以上[7]。当前对于法律法规的实施主要依靠交警查

询等方法，但在实际操作过程中相比于酒后驾驶检测，疲劳驾驶的状态更难肉眼甄别，很多

规定失去了原有应该达到的效果。不同驾驶员的由于身体状况、行为习惯等各方面的不同，

1 

杭州电子科技大学硕士学位论文 

在不同环境由于各种因素的影响，安全行车时间也不一样。使用单一行车时间作为控制疲劳

驾驶的措施，极易引起社会争议，并为法律法规的贯彻和实施造成了障碍。 

因此，设计一套比较完善的疲劳检测设备，通过对疲劳驾驶检测方法进行研究，实时检

测司机疲劳状况，能进行警示提醒司机停车休息，并可通过网络将驾驶员的状况发送到监控

中心。这对于有效降低乃至防止因疲劳驾车所引发的道路交通事故、提高当前道路安全状态

有着重大意义。 

1.2 国内外关于疲劳驾驶检测的研究现状及分析 

疲劳驾驶检测技术在交通事故预防方面因其巨大前景而受到许多研究人员的重视。近年

来由于计算机信息技术的飞速发展，各类传感器检测技术被广泛的用于疲劳驾驶检测领域，

通过不断创新实践，一些国内外相关研究课题已取得巨大的研究成果。从目前研究方法分析，

疲劳驾驶检测的主要方法有三类：基于驾驶员生理信息检测、基于驾驶员面部动态信息检测

和基于车辆运动信息检测，如图 1.1 所示。 

疲劳驾驶检测方法

基于驾驶员生理信息

基于驾驶员面部动态信息

基于车辆运动信息

脑电图、
心电图、
眼电图、
皮肤电活动等

眼动特征、
打哈欠信息、
头部运动信息等

方向盘转角、
车道偏移、
方向盘握力等

1.2.1 基于驾驶员生理信息的检测方法 

图 1.1 疲劳驾驶检测主要方法 

生物医学研究已经证实，人在疲劳时所测量出的脑电图（electroencephalogram，EEG）、

心电图（electrocardiogram，ECG）、眼电图（electrooculogram ，EOG）以及皮肤电活动
（electrodermal  activity，EDA）等生理信息有明显变化特征[8]。生理信号检测主要使用传感

器直接采集到生理信息，通过生理特征变化检测驾驶员的疲劳程度。这种检测方式可靠性高，

是疲劳驾驶检测中最有效的方法。 

（1）基于脑电图（EEG）的疲劳检测方法 

生理信号中，EEG 是表示睡眠信号的最常用手段，有多种频带可以疲劳状态相关，其

中𝜃频段表示对应的困倦状态，𝛿频段表示对应的睡眠状态，𝛼频段和𝛽频段表示处于正常清

醒状态。在驾车行驶的过程中，驾驶员的注意力下降或者反应变迟缓会引起脑电波信号的波

2 

 
杭州电子科技大学硕士学位论文 

动，根据 EEG 频段的变化，可以判别驾驶员是否进入疲劳状态[9]。Chuang 等提出利用脑电

波谱特征经过感知整合，识别驾驶员是否发生疲劳驾驶[10]。Jing 等人为了研究低压低氧环境

下对驾驶员疲劳程度的影响，实时检测驾驶员行车时脑电信息分析脑电频段功率密度，以

(𝛼 + 𝜃)/𝛽和(𝑎 + 𝛽)/𝜃的值作为疲劳检测指标[11]。 

（2）基于心电图（ECG）的疲劳检测方法 

心电信号采集是通过使用电极片放置在驾驶员靠近心脏部位。由于不同疲劳状态下心率

会有突出的变化，利用心率异变性变化检测驾驶员疲劳程度，通过对心率的 R-R 区间逐拍

分析，一般心率的变化在 0.04Hz 到 0.4Hz，驾驶员从清醒到疲劳疲惫对应 ECG 中低频段与

高频段比率逐渐减小[12]。徐等人采集一段时间内的心电图信息作为疲劳特征，结合机器学

习算法进行疲劳状态分类[13]。  

（3）基于皮肤电活动（EDA）的疲劳检测方法 

皮肤电活动是采集人体皮肤表面在收缩变化时电流信号，主要是使用两片正负电极传感

器分别附着在左手的两个手指上，将电流信号转换为生理信号，进行频谱分析，得到皮肤电

积分值、平均皮肤电流值、皮肤电中位频率以及平均功率。目前已有研究人员在检查皮肤电

信号检测疲劳程度判定过程中，通过相关研究取得了良好的检测效果[14]。 

（4）基于呼吸信号的疲劳检测方法 

根据研究发现驾驶员在疲劳驾驶时胸腔容量会逐渐下降，从而导致呼吸肺部呼吸信号的

频率和幅值出现不同程度的减弱。人体呼吸的最小频率为 0.02Hz，可以对呼吸信号利用傅

里叶变换进行频谱分析。曹等人设计了 PVDF（polyvinylidene difluoride）压电薄膜，构建疲

劳状态识别硬件电路系统，实现了汽车驾驶员呼吸率检测[15]。 

驾驶员的生理信息最能客观地反映驾驶员的真实情况，这类检测方法采用高性能传感器

抗干扰能力强、准确性高。但在实际检测的过程中，驾驶员时刻需要佩戴传感器，与皮肤长

时间接触，容易引起身体上的不适，会给驾驶员带主观消极情绪，导致身体抵触，并且传感

器成本高。最重要的是让驾驶员长期接触电极干扰正常驾驶，实际应用需要改进创新。 

1.2.2 基于驾驶员面部动态信息的检测方法 

驾驶员在行车处于疲劳状态时，会出现很多面部动态表情特征，包括眨眼变快、打哈欠

以及头部晃动，因此采集驾驶员面部动态特征通过机器视觉分析来处理结果，这种检测方案

已经被广泛应用于驾驶员疲劳状态检测。这类检测方法是基于图像处理领域的机器视觉技术

来检测驾驶员疲劳状态，按照身体部位，一般有基于眼部特征检测、基于面部表情检测和基

于头部姿态检测。 

（1）基于驾驶员眼部运动的检测方法 

人的眼睛能反映自身的精神状态，如眼部动作以及眼睛凝视情况等，通过摄像头获取眼

部信息并跟踪，取出相关的疲劳信号参数作为眼部运动的特征值，进行疲劳程度分析。驾驶

3 

杭州电子科技大学硕士学位论文 

员在道路行驶时随着越来越疲惫，意识出现模糊，眨眼频率会出现明显变化，当眨眼频率为

0 时，即表明进入了沉睡状态。Chen 等人通过人眼状态识别来检测驾驶员的疲劳状态，该
方法主要使用的 YcbCr 的图像空间处理技术，分析眼睑张合得出疲劳检测结果[16]。 

（2）基于驾驶员面部表情的检测方法 

由于人在打哈欠时会多种面部表情，最突出的是嘴部状态。各个疲劳状态嘴的张合度都

是不同的，所以可通过区分嘴巴张合程度判定是否打哈欠，从而获取驾驶员的疲劳特征。

Zhang 等人设计了一种打哈欠检测器，通过深度学习算法和卡尔曼滤波器来对嘴巴进行跟踪，

在动态条件下开展疲劳运动特征检测[17]。 

（3）基于驾驶员头部姿态的检测方法 

驾驶员在疲倦瞌睡时，面部姿势会频繁改变，头部也会出现快速晃动。通过面部或头部

姿势可以分析驾驶员的注意力情况、眼睛凝视方向和瞌睡状态，进而分析驾驶员在一段时间

内是处于正常清醒状态还是处于疲劳困倦状态[18]。冯等人通过摄像头提取头部姿态特征，

结合罗德里格斯旋转矩阵对头部姿态检测，设计了一种自适应融合疲劳检测算法，具在多种

场景下具有较高的准确度[19]。 

当前基于驾驶员面部动态信息的检测，利用计算机视觉技术实现非接触式检测驾驶员眼

部特征、头部姿态以及面部表情，方便高效，但可靠性低。对驾驶员视频采集的过程中易受

光照、遮挡物等外界环境影响，并且检测时需要使用人脸检测对五官进行精准定位。算法计

算复杂，无法保证实时性检测，对驾驶员行车驾驶姿势要求较高。如果驾驶员头部或者脸部

不在检测范围内，就会失去面部动态信息，导致检测无法得出结果，因此这类检测方法很少

作为疲劳状态检测的唯一依据[20]。 

1.2.3 基于车辆运动信息的检测方法 

基于车辆运动信息的检测方法是间接对方向盘、踏板、车辆行驶轨迹等车辆信息进行分

析判断驾驶员疲劳驾驶行为。这种方法需要在车窗内安置传感器测量方向盘、踏板等车辆运

动信息，传感器采集的信息经过处理得出可以检测疲劳驾驶的特征值，通过设定阈值的策略

作为评判依据，利用算法分析判别驾驶员的疲劳程度。根据安装传感器测量的目标，可以有

基于方向盘检测、基于车道偏移等检测角度。 

（1）基于方向盘旋转角度的检测方法 

方向盘转角测量比较广泛的用于检测驾驶员疲劳状态，通过安装旋转角度传感器测量方

向盘变化角度。研究人员发现通常驾驶员为了保持车辆稳定前行会为方向盘，当驾驶员疲劳

困倦时方向盘转动的角度比正常驾驶时要明显很多，并且在只考虑方向盘转动幅度的情况下，

正常驾驶员转动的次数较少[21]。Mortazavi 和 Eskandarian 等人研究表明，汽车司机可以在正

常驾驶时使用稳定调节方向盘保持在行驶车道内，通过统计方向盘转动的角度数据，检测是

否发生疲劳现象[22]。 

4 

（2）基于车道偏移的检测方法 

杭州电子科技大学硕士学位论文 

作为车辆运动的重要参数，通过车道检测车辆偏移度，当驾驶员在行车途中进入疲劳状

态时，意识模糊导致控制车辆的能力变弱，行驶过程中的车道偏移数据较清醒状态驾车数据

相比有较大偏差。因此相关研究人员把车辆轨迹偏数据应用于疲劳驾驶领域。国内成等人把

驾驶员进入疲劳的状态记录下来，把这段时间内的车辆偏向数据绘制成不同的波形图，结合

Fisher 判别准则，通过分析修正的频数建立实时疲劳驾驶检测模型[23]。 

基于车辆运动信息的检测方法也有着非接触的优点，是一种间接的检测手段，信息容易

获取，而且不会干扰驾驶员正常行车。这种手段在检测时，需要对大量的数据进行实时处理，

且需要强大硬件设施和计算能力支持，成本高昂。若遭遇气候、机动车特性及路面情况等、

外部环境各种因素的影响，具有一定的限制，在车辆轨迹检测时可能发生在图像数据进行捕

捉时无法到达实时同步，造成获取的数据不能适用，影响最终的疲劳状态检测识别率[24]。

这类检测方法健壮性偏弱，通常用后期疲劳驾驶检测，一般可用来作为辅助检测方法[25]。 

1.2.4 疲劳驾驶检测技术研究动态分析 

通过对国内外研究现状的分析，目前疲劳驾驶检测方法多种多样，从不同方向多种角度

对驾驶员行车过程中的疲劳状态进行检测。这些方法一定程度上促进了疲劳驾驶检测领域的

发展，然而实际驾驶环境中，造成疲劳驾驶的因素非常复杂，进而导致这些方法存在的问题

也比较明显。 

现有疲劳驾驶检测多是基于单一信息源的检测方法，无法消除空间、光照、天气等外界

环境变化因素对疲劳状态检测识别率的影响。采用驾驶员生理信息、面部动态信息和车辆运

动信息等多信息源的无接触探测方式将提高检测结果准确性和可靠性，一定程度上克服了单

一信号源检测准确度低的问题。基于驾驶员生理信息检测疲劳驾驶准确度最高，可以实现驾

驶疲劳程度的检测，现有生理检测手段往往需要驾驶员佩戴或者穿戴检测设备，一定程度影

响驾驶员操作行为，影响正常行车驾驶[26]。为克服接触式生理检测装置的佩戴问题，研究

非接触式生理检测方法确保检测准确度的同时，不影响驾驶员驾驶舒适度。 

通过信息采集获得疲劳特征数据后，需要对这些数据进行处理识别，进而更精确地对驾

驶员的疲劳程度做出检测。当前研究人员提出一种主流方案，即将驾驶员的疲劳状态检测问

题转化为疲劳程度分类问题来解决。支持向量机（Support  Vector  Machines，SVM）是一种

基于监督学习的模式识别算法，利用超平面分割原理以间隔最大化寻找一个最佳超平面[27]。

Hu 等学者从 EOG 中分析与眼部运动状态关联的信息，提取眼部疲劳特征，并将疲劳程度分
为三类：清醒、疲惫与非常疲惫，通过 SVM 识别驾驶员的疲劳程度[28]。SVM 只能解决二

分类问题，对于多分类问题，虽然可以采用组合多个二分类的形式来处理，这样却大大增加

了模型的在线训练时间。反向传播神经网络（Back  Propagation  Neural  Network，BPNN）主

要研究前馈神经网络学习训练的误差后向传播过程，BPNN 模型在疲劳驾驶检测领域被广泛

5 

杭州电子科技大学硕士学位论文 

应用于疲劳程度分类[29]。Ying 等学者利用摄像头采集驾驶员的面部动态信息，提取眼部与

嘴部的疲劳特征建立数据集样本，最后设计基于 BPNN 的疲劳状态识别模型  [30]。然而，

BPNN 需要消耗大量时间进行反复迭代训练才能达到收敛状态，无法对新增样本进行实时高

效率训练，并且网络参数调节复杂，容易陷入局部解空间，难以快速对疲劳程度的做出准确

的判别。 

正则在线序贯极限学习机（Regularized  Online  Sequential  ELM，ROS-ELM）算法具有

快速学习的优势，其训练速率很快，支持序贯学习，非常适用于疲劳驾驶检测领域，在离线

阶段初始化网络模型隐藏层神经元的个数后，会随机选定隐藏层输入权值以及输出偏置，最

后能够产生唯一的解[31]。但是，由于正则在线序贯极限学习机的在线学习阶段是对离线阶

段训练模型的迭代更新并且依赖于离线阶段，而在离线阶段的网络参数是随机生成的，很大

程度影响模型的预测精度，无法训练出最佳的网络模型。自适应权重粒子群优化（Adaptive 

Weight  Particle  Swarm  Optimization，AWPSO）算法通俗易懂，容易实现，收敛能力强以及

优化效果稳定等优势。引入 AWPSO 算法，更加有利于正则在线序贯极限学习机参数优化问

题的求解，提高模型的泛化能力和鲁棒性。 

综上所述，目前有关驾驶员疲劳检测的解决方案还有待完善，现已有的各种检测方法也

拥有一定的约束性，在疲劳驾驶检测可靠性和实时性等方面存在诸多问题。针对现有疲劳驾

驶检测方法中存在的问题，研究多信息源非接触式数据采集和优化正则在线序贯极限学习机

的检测方案很有必要。通过建立客观真实的疲劳状态区分度标准，以半实物仿真模型和模拟

驾驶实验为手段，根据驾驶员生理信号和面部动态信息提取疲劳状态相关性特征，将特征融

合方法和优化极限学习机方法相结合，可以有效提升疲劳检测的识别效果，减少疲劳驾驶造

成的危害。 

1.3 主要研究内容与目标 

本文研究的疲劳驾驶检测方法如图 1.2 所示，主要研究基于生理特征与面部特征融合的

疲劳驾驶检测方法，包括疲劳驾驶数据采集、疲劳特征提取和疲劳状态识别模型设计三个部

分。文中首先以模拟驾驶仿真平台为基础，搭建非接触式疲劳驾驶数据采集系统，包括基于

多普勒雷达的生理信号采集模块和基于 Dlib 的面部动态特征采集模块，并对系统进行调试

和驾驶员信息采集流程。其次设计一种滤波算法从雷达信号中分离生理信息，提取生理信号

特征，对面部动态进行疲劳特征处理，引入眼睑纵横比、嘴部纵横比和头部姿态估计提取合

适的面部特征，根据疲劳驾驶等级评判机制建立疲劳驾驶数据集。然后利用自适应权重粒子

群算法优化正则在线序贯极限学习机初始阶段隐藏层参数，构建自适应权重粒子群优化算法

优化在线序贯极限学习机（AWPSO-ROS-ELM）的疲劳状态识别模型，验证模型的改进效

果和可行性。最后使用特征融合技术，设计多源特征融合的疲劳状态识别模型，并将设计的

模型与传统模型进行实验结果对比分析，验证本文所设计疲劳驾驶检测方法的检测效果。 

6 

杭州电子科技大学硕士学位论文 

疲劳驾驶数据采集

驾驶员模拟疲劳驾驶

多普勒雷达模块采集生理信号

Dlib模块采集人脸68点特征

疲劳特征提取

生理信号特征值提取

面部动态特征值提取

通过疲劳驾驶等级评判建立数据集

疲劳状态识别模型设计

设计疲劳状态识别模型

设计多源特征融合的疲劳状态识别模型

图 1.2 基于多源特征融合的疲劳驾驶检测方法 

1.4 本文结构 

本文的结构分为六个章节，每章节的具体内容概括如下： 

第一章主要论述疲劳驾驶检测技术研究意义以及主流研究方法，分析疲劳驾驶检测领域

国内外现状以及存在的优缺点，进而确立论文的主要内容与研究目标。 

第二章主要介绍模拟驾驶实验平台，设计疲劳驾驶数据采集系统，包括基于多普雷的生

理信号采集模块和基于 Dlib 的面部动态特征采集模块，并对系统进行了调试，给出疲劳信

息采集流程。 

第三章主要介绍特征提取的过程。通过设计滤波器对原始雷达信号进行滤波，从生理信

息中分离出呼吸信号与心跳信号，进行频谱分析后提取生理信号特征值。对基于 Dlib 模块

采集的人脸信息进行面部动态分析，引入眼睑纵横比、嘴部张合度和头部姿态估计提取面部

疲劳特征。最后采面部专家评判法与主观评判法相结合建立疲劳驾驶等级评判制度，建立疲

劳驾驶数据集。 

第四章设计基于 AWPSO-ROS-ELM 的疲劳状态识别模型，首先介绍 ROS-ELM 网络，

然后使用自适应权重粒子群优化算法对 ROS-ELM 进行优化，构建 AWPSO-ROS-ELM 分类

模型，通过对比实验，验证所设计模型的可行性。 

7 

 
杭州电子科技大学硕士学位论文 

第五章主要针对第四章发现的特征数据问题，将原始特征进行特征融合，并且把设计的

AWPSO-ROS-ELM 模型与 SVM、BPNN 进行实验对比分析，验证本文所设计疲劳状态识别

模型的优越性。 

第六章主要总结全文研究内容以及主要创新点，并且说明研究的方法不足以及可优化完

善的地方，同时对本文做出未来展望与发展方向。 

8 

 
杭州电子科技大学硕士学位论文 

第 2 章 疲劳驾驶实验平台搭建及信息采集 

由于现实交通道路中对驾驶员进行数据采集具有极大的危险和挑战，为实现本文的研究

目标，需要搭建真实多场景的模拟驾驶环境，进而采集准确可靠的信号，完成对司机的疲劳

程度做出实时检测。相关研究表明，随着模拟仿真技术的高速发展，模拟驾驶与真实驾驶之

间的体验有着良好的一致性，已被广泛应用于实验测试过程中[32]。本文选择模拟驾驶环境

代替实际场景，通过模拟真实的驾驶环境采集司机在驾驶过程中的疲劳信息数据，使得实验

过程更加简易可控。 

如图 2.1 所示，该实验平台采用模拟驾驶半实物仿真平台，包含多个模块，通过计算机

实时 3D 成像、自动化控制、数字仿真等先进技术手段，模拟实际的车辆操作过程和运行效

果，由易驾兴模拟驾驶系统和疲劳驾驶数据采集系统共同构成。 

摄像头

模拟驾驶环境

摄像头

上位机显示

多普勒雷达模块

模拟驾驶平台

2.1 模拟驾驶系统设计 

图 2.1 疲劳驾驶仿真实验平台 

模拟驾驶系统包括模拟驾驶器装置和模拟驾驶环境重现软件。模拟驾驶系统提供的仿真

场景涉及城市道路、乡村路面、居民区路况等多个交通场景，最大程度地给实验驾驶员模拟

各种逼真的驾驶场景。 

9 

 
杭州电子科技大学硕士学位论文 

如图 2.2 所示，该实验采用易驾兴的模拟驾驶器，具备实际驾驶所具有的转向杆、方向

盘、手动档位、油门、刹车和离合等车辆部件。同时方向盘具有防滑特性和电机组力反馈，

模拟驾驶与真实车辆驾驶手感、体验几乎等同，保证了对驾驶数据的精准采集。 

图 2.2 模拟驾驶器系统                                               图 2.3 模拟雨雪驾驶环境 

模拟驾驶环境重现软件采用易驾兴驾驶器提供的仿真行驶训练软件系统，该软件系统可

通过个人计算机显示多种行驶场景，包括山区道路、高速公路行驶、雨雪天气驾驶、夜间市

区等复杂场景，保证接近实际驾驶环境。所有模拟场景均取自于现实环境拍摄画面，使用

3D 显示技术真实呈现画面。其中雨雪天气环境如上图 2.3 所示，模拟驾驶屏幕前方显示天

气状况、当前道路状况等模拟仿真场景，并在屏幕下方显示汽车的方向盘、各种仪表盘、后

视镜以及油门离合的显示条。该系统还佩带智能语音自动提示，驾驶员可以语言提示进行正

确地模拟驾驶，当出现车辆事故时，系统会提醒故障报错并重启系统。 

2.2 疲劳驾驶数据采集系统设计 

疲劳驾驶数据采集系统包含多普勒雷达模块和摄像头模块，雷达模块位于驾驶员前方，

用于采集驾驶员的生理信息，并进行信息的预处理。摄像头模块采用双路获取视频流数据，

其中一路用于获取驾驶员的面部动态信息。另一路用来拍摄驾驶员模拟驾驶时的身体行为，

用于疲劳程度评判依据。生理信号和视频数据同步采集，方便对数据集打标签，确保驾驶疲

劳状态数据一致性。 

2.2.1 生理信号采集模块设计 

多普勒雷达是一种基于多普勒效应的目标测量工具，当物体在运动时，雷达发射的微波

可以探测此时物体的变化，进而可以获取有用信息。通常情况下，雷达会向周围发射某一频

率的脉冲波进行动态扫描，如果检测到运动目标，往返接受的脉冲波会出现频移[33]。根据

雷达波频移大小和时间差可以测量出目标物体相对移动速度与相对移动距离，通过频率过滤

的手段，消除干扰的频谱，从杂乱的雷达波中获取目标信息。 

如图 2.4 所示，多普勒雷达连续发射微波信号，达到人体胸腔后反射，由于人体呼吸心

10 

                     
 
杭州电子科技大学硕士学位论文 

跳时具有起伏的特征变化，会使反射的微波频率产生一个偏移。根据这种运动性质可以得到

反应驾驶员的呼吸心跳信号。但在实际应用中，当驾驶员发生胸腔运动时会有外界噪声干扰，

导致雷达接受返回的信号是冗余的数据，无法直接得到心肺信号特征，需要对采集到的信号

做滤波处理，分离出呼吸心跳信号，保证数据的可靠性。 

多普勒雷达

d

x

图 2.4 多普勒雷达检测示意图 

基于多普勒雷达的非接触式采集方式，比其他皮肤接触式传感器更加方便舒适，避免检

测装置与驾驶员之间的直接接触，可以长时间检测而不影响正常肢体动作行为，测量结果更

加真实有效。并且多普勒雷达采集模块具有消耗功率低等优点，在保证续航的能力下可持续

进行生理信号采集，与驾驶员配合简单。驾驶员的生理参数变化可以通过同步采集的雷达信

号进行描述，雷达信号包括驾驶员的呼吸、心跳信号和噪声干扰信号。 

如图 2.5 所示，本文将选取的微波多普勒雷达模块以 HB100 探测器为核心部分，频率

为 10.5Hz，可同步采集驾驶员的生理信息。雷达信息中包括有关呼吸和心跳的生理信号和

外界噪声信号，包含的信息比较冗杂，可以选择对雷达信号进行滤波分离。 

2.2.2 面部动态特征采集模块设计 

图 2.5 微波多普勒雷达模块 

人脸识别技术大致可分为三类：基于几何的识别方法，这是传统的面部识别方式，通过

人脸五官的几何形态找出一些关键点加以刻画，经过学习得到人脸模型，然后通过模型执行

关键点搜索，实现人脸识别。基于匹配的识别方法，先设定一个普适人脸模式，然后对输入

的图像进行相关系数分析运算，将得到的几个与设定的阈值比较。基于特征的识别算法，人

11 

 
 
杭州电子科技大学硕士学位论文 

脸皮肤具有特定的部位与形态，可以很方便地把脸部皮肤特征过滤出来，并根据面部形态与

几何关系、皮肤颜色等特征进行检测。 

Dlib 是一个出色的跨平台开放的人脸识别工具库，具有卓越的特性。Dlib 库实现的功能

非常丰富，涉及线性代数、图像处理、机器学习、网络安全以及最优化计算等诸多功能。其

核心原理利用了图象的 Hog 特性来描述人脸特征，与其他图象数据提取算子一样，它对图
象的几何和光学特征的变化都可以保证非常好的不变形[34]。该特性和 LBP 特性以及 Harr 特

性一起成为了三种最典型的图像特性，提取算子一般应用于物体检测场合。如图 2.6 所示，

Dlib 人脸检测在不同的人群中具有良好的检测效果，适应多种环境下的人脸特征检测。 

图 2.6 Dlib 人脸检测 

根据前文所述，整个数据采集系统有两路摄像头，其中一路用于视频采集并对人脸进行

检测。因为人在疲劳困倦时产生三种疲劳状态：眨眼、打哈欠、瞌睡点头。正常人眼睑每分

钟大概要眨动 10-15 次，每次眨动时间大概 0.2-0.4 秒，但在疲劳程度加深时眨眼次数会增

加，速率会逐渐变慢[35]。此时的嘴巴通常会张大而且会处于短暂的保持状态，通过俯仰角

度记录是否点头瞌睡。因此检测一个人的疲劳状态可以从眨眼、打哈欠以及点头来综合分析。

shape_predictor_68_face_landmarks.dat 是 Dlib 中用于人脸 68 个关键点检测的 dat 模型库，通

过这个模型库能够非常便捷地完成人脸检测[36]。如图 2.7 所示，基于 Dlib 的人脸检测系统

在通过人脸测试之后可以得到人脸检测的定位信息，然后再通过人脸框的关键点检测，可以

获取出人脸每个部分的正确定位，然后循环脸部信息，提取面部动态特征。 

如图 2.8 所示，本文将采用 800 万像素的 DS-U68 摄像头，用于获取驾驶员面部视频。

通过 Dlib 人脸识别 68 特征点检测，得到人脸标记的索引，并利用 OpenCV 对视频流经过灰

度化处理过程，可以检测出驾驶员眼睛、嘴巴和脸部偏移的特征信息。计算眼睑纵横比、嘴

12 

 
巴纵横比和头部姿态这些数据，实时地记录驾驶员面部动态信息。 

杭州电子科技大学硕士学位论文 

图 2.7 基于 Dlib 人脸检测的 68 个关键点                                    图 2.8 DS-U68 摄像头 

2.3 疲劳驾驶数据采集系统调试 

在搭建好实验平台后，需要做进一步平台调试，主要针对数据采集系统，确保驾驶员的

生理信息和面部动态信息能被疲劳驾驶数据采集系统成功采集。只有保证该模块采集数据的

有效性，才能进行后续疲劳状态检测，为建立数据集提供基础。 

2.3.1 生理信号采集模块调试 

将雷达模块供电后连接到计算机，使用上位机软件实时处理数据，绘制不同时刻的雷达

信号波形，确保模拟驾驶实验采集的信息为有效输出信号。通过显示的波形是否稳定有效确

定雷达模块是否正常工作。若没有显示稳定的输出信号，需要不断调试，观测的信号显示正

常后方能后续实验数据采集。  

无驾驶员在模拟行驶时，所观测到雷达信号如下图 2.9 所示。可以看出，当无人进行驾

驶操作时，波形平稳，且除去少数噪音以外，采集信息基本上为有效信息输出。表明在无人

驾驶员工作的状况下，雷达采集模块能够正常工作，而且能够收集到稳定输出的信息。 

当有驾驶员在进行模拟驾驶时，观察到雷达信号如图 2.10 所示，雷达输出信号呈现周

图 2.9 无驾驶员时的雷达信号 

13 

   
 
 
杭州电子科技大学硕士学位论文 

期性变化，由于噪声信号存在，导致波形有一定的失真。大体上能够体现正常人体心肺规律，

从波形上反应雷达模块可以正常工作，可用于生理信号采集。 

图 2.10 驾驶员模拟驾驶时的雷达信号 

通过调试可以看出多普雷达模块能成功采集驾驶员在模拟驾驶中的生理信号，由于实验

环境中存在的噪声不可避免，进而需要对采集到的雷达信号做后续滤波处理，对呼吸心跳信

号分离，并提取疲劳驾驶特征值。 

2.3.2 面部动态特征采集模块调试 

将摄像头接入 PC，使用 Python3.6+OpenCV+Dlib19.7 的开发环境，Python 运行环境使

用 Anaconda。利用 Dlib 官方训练好的人脸识别模型“shape_predictor_68_face_landmarks.dat”

进行面部定位检测，获得人脸的 68 点标定，并存入 68 个点位置坐标，利用 OpenCV 技术进

行全像素化处理，最终在驾驶员面部画出 68 个点。 

当有驾驶员进行驾驶疲劳检测时，通过高清摄像头进行同时录制驾驶员模拟驾驶行车状

态，并提取司机的面部动作视频流，对视频流循环进行帧读取。其调试效果如图 2.11 所示，

可以看出，视频画面流畅清晰，使用 68 个定位点准确的描述了人脸关键点信息，验证了摄

像头模块采集驾驶员面部动态数据的有效性。 

图 2.11 驾驶员模拟驾驶时采集的面部动态信息 

通过调试可以看出基于 Dlib 的人脸特征采集模块能成功采集驾驶员在模拟驾驶中的面

部动态信息，当然这种信息无法直接用于疲劳驾驶检测特征，需要根据采集的信息进一步疲

劳行为分析，从而得到可以作为本文疲劳驾驶检测方法中的面部特征值。 

14 

 
  
 
2.4 驾驶员疲劳状态信息采集 

杭州电子科技大学硕士学位论文 

研究发现，驾驶员在简单道路环境下更容易出现疲劳驾驶现象[37]。因此，在模拟驾驶

实验时模拟驾驶环境选择单一雨雪天气道路环境，该驾驶场景道路场景简单、路面宽阔，没

有障碍物干扰，减少了客观环境对驾驶员模拟驾驶的影响。仿真道路线路如图 2.12 所示，

行驶路线为近似的椭圆形。为提高仿真驾驶试验数据的可信度，实验课题组招募了多名不同

年龄段具有代表性的驾驶员作为模拟驾驶实验测试对象，且每一位测试者身体健康、听力视

力正常、有相关的驾驶经验。在实验之前，确保每位测试者睡眠充足，精神充沛，积极配合

模拟实验。 

一般人进入疲劳时期有个渐进的过程，并且实际驾驶时，驾驶员长期驾驶是导致疲劳驾

驶的主要因素，因此测试人员在测试时需要进行长时间检测，这样才能保证采集数据真实有

效[38]。根据分析，本文实验时间选择饭后时间，驾驶员中午 13 点左右或者晚上 19 点容易

疲劳瞌睡，有利于采集到不同疲劳程度的信息，并且选择不低于三个小时的模拟驾驶时间。

实验之前，测试人员调整坐姿，点头示意开始，然后打开模拟驾驶系统和信息采集平台，雷

达模块与摄像头模块同步开始采集疲劳驾驶检测数据。模拟驾驶的过程中，必须处于无人干

扰的环境，测试人员头部左右转动的幅度不要过大，避免摄像头无法采集面部动态信息。 

在对数据采集时，上位机实时保存采集数据信息，需要将采集到的原始信息在时间序列

上进行分割。如下图 2.13 所示，分割的窗口大小为 T，一般 T 取 60s，去除无效数据，以视

频 60s 分割为数据片段，确保数据丰富，包含多种不同的疲劳状态。 

图 2.12 模拟驾驶道路线路                             图 2.13 序列窗口分割示意图 

2.5 本章小结 

本章主要详细阐述搭建的模拟驾驶半实物仿真实验平台，说明了该平台的组成部分以及

具体的模块设计。设计测试实验分部验证了疲劳驾驶数据采集系统的可行性，通过调试可以

看出多普雷达模块能成功采集驾驶员在模拟驾驶中的生理信号，基于 Dlib 的人脸识别模块

能够实时检测人脸特征，说明该采集系统保证了数据采集的有效性。由采集的数据冗杂，无

法进行数据分析，接下来将会对数据进行处理，得到有效的疲劳驾驶检测特征。

15 

 
杭州电子科技大学硕士学位论文 

第 3 章 疲劳特征提取与数据集建立 

在第二章对实验平台进行了搭建和信息采集，最终获得了基于多普勒雷达的生理信号和

基于 Dlib 的面部 68 点特征数据。这些信息过与杂乱，没有清晰的描述，无法直接作为疲劳

状态检测的分类数据，需要对这些信息进行处理以及整合。首先是对生理信号进行滤波，分

离出呼吸、心跳信号，提取生理信号特征，对于已有的面部动态信息，需要特征处理才能作

为疲劳特征，然后选取合适的面部动态特征值，最终根据疲劳状态等级评判标准建立疲劳驾

驶数据集。 

3.1 基于驾驶员生理信息的疲劳特征提取 

通过多普勒雷达所获取的生理信号包含了呼吸信号、心跳信号和噪声信号，由于心跳信

号比呼吸信号更微弱，并且容易受外界因素的干扰，导致信号本身无法区分。因为一般都是

利用胸腔运动进行检测的，可能会造成频域交叉干扰，所以需要通过选择滤波算法精确地分

离出呼吸信号和心跳等信号，提取合适的疲劳特征。 

3.1.1 IIR 滤波器 

人体生理信号包括呼吸、心跳等信号，正常人体的呼吸频率处于 0.02Hz-0.5Hz 范围内，

心跳频率处于 0.7Hz-4Hz 范围内[39]。考虑到采集生理信息的频率低以及窄带宽，相对于心跳

信号，呼吸心跳相对微弱。为了降低呼吸信号对心跳信号的影响，在设计滤波器时心跳信号

的低频截止频率应该高于呼吸信号的高频截止频率，数字滤波器具体参数设计如下表 3.1 所

示。 

表 3.1 滤波器各项参数指标 

生理信号 

呼吸信号 

心跳信号 

𝑓(cid:3046) 

50Hz 

50Hz 

𝜔(cid:3046) 

0.2Hz 

0.7Hz 

𝜔(cid:3043) 

0.5Hz 

4Hz 

𝛿(cid:3043) 

1dB 

1dB 

𝛿(cid:3046) 

40dB 

40dB 

表中，𝑓(cid:3046)表示生理信号的模拟采样频率，𝜔(cid:3046)和𝜔(cid:3043)分别为数字滤波器的通带频率参数与阻带
截止频率参数，𝛿(cid:3043)和𝛿(cid:3046)分别表示通带增益和阻带增益。 

IIR 滤波器属于递归结构的滤波器，带有反馈网络，其相位随截止频率变化而改变，并

通过历史的输出实现反馈，因此亦称为无限脉冲响应滤波器[40]。研究结果表明，当滤波器

阶数相同时，IIR 滤波器比 FIR 滤波器的滤波效果更有优势[41]。考虑到对生理信号滤波时，

实时性要求较高，不能对信号的同步输出产生太大影响。因此在疲劳状态检测的过程中，由

于信号持续输入，应该选择 IIR 滤波器，减少信号延时，可以对信号不间断处理。 

16 

对于 IIR 滤波器的阶数𝑁，可以利用 MATLAB 函数工具的𝑒𝑙𝑙𝑖𝑝𝑜𝑟𝑑函数进行计算求解，

杭州电子科技大学硕士学位论文 

具体公式计算如下： 

,

(cid:4680)𝑁,

2𝜋
𝜔(cid:3043)

(cid:4681) = 𝑒𝑙𝑙𝑖𝑝𝑜𝑟𝑑 (cid:4678)

2𝜋
𝜔(cid:3043)
2𝜋
𝜔(cid:3043)
2𝜋
𝜔(cid:3046)
根据表 3.1 中的滤波器参数代入公式计算可以得到，呼吸信号滤波器和心跳信号滤波器

, 𝛿(cid:3043), 𝛿(cid:3046) (cid:4679)

2𝜋
𝜔(cid:3046)

𝛺(cid:3043) =

𝛺(cid:3046) =

(3.1) 

的最小阶数分别为 8 阶与 14 阶。IIR 滤波器设计通常把各种性能技术指标转化为模拟滤波器

技术指标，并且选择合适的模拟滤波器，之后再通过相应的映射方式变换为符合特性的数字

滤波器。 

3.1.2 零相位 IIR 滤波器设计 

由于 IIR 滤波后的呼吸信号存在相位偏移，因此具有一定的相位失真问题。针对这种情

况，本节将在 IIR 滤波器的基础上设计零相位偏移的 IIR 滤波器，利用相移相互抵消实现滤

波后零相移效果，从而有效克服相位失真。具体做法为：首先将生理信号输入到滤波器后，

对第一次滤波信号进行时域翻转；然后将翻转信号输入到同一滤波器中进行二次滤波，将二

次滤波后的信号进行二次时域翻转。生理信号经过两次滤波和两次翻转实现了相移抵消，实

现输出信号零相位移动，消除失真信号。零相位滤波可以在时域表现为： 

𝑦(cid:2869)(𝑛) = 𝑥(𝑁 − 1 − 𝑛)  
𝑦(cid:2870)(𝑛) = 𝑦(cid:2869)(𝑛) ∗ ℎ(𝑛)   
𝑦(cid:2871)(𝑛) = 𝑦(cid:2870)(𝑁 − 1 − 𝑛)
𝑦(cid:2872)(𝑛) = 𝑦(cid:2871)(𝑛) ∗ ℎ(𝑛)    
其中，𝑥(𝑛)为信号输入序列，𝑦(𝑛)为信号输出序列，ℎ(𝑛)为脉冲响应序列，𝑁为信号序列长

(3.2) 

度。对式（3.2）进行傅里叶变换，即可推导出相应的频域表达式为： 

𝑌(cid:2869)(cid:3435)𝑒(cid:3037)(cid:3050)(cid:3439) = 𝑋(cid:3435)𝑒(cid:3037)(cid:3050)(cid:3439)𝐻(cid:3435)𝑒(cid:3037)(cid:3050)(cid:3439)       
𝑌(cid:2870)(cid:3435)𝑒(cid:3037)(cid:3050)(cid:3439) = 𝑒(cid:2879)(cid:3037)(cid:3050)((cid:3015)(cid:2879)(cid:2869))𝑌(cid:2869)(cid:3435)𝑒(cid:2879)(cid:3037)(cid:3050)(cid:3439)
𝑌(cid:2871)(cid:3435)𝑒(cid:3037)(cid:3050)(cid:3439) = 𝑌(cid:2870)(cid:3435)𝑒(cid:3037)(cid:3050)(cid:3439)𝐻(cid:3435)𝑒(cid:3037)(cid:3050)(cid:3439)       
𝑌(cid:2872)(cid:3435)𝑒(cid:3037)(cid:3050)(cid:3439) = 𝑒(cid:2879)(cid:3037)(cid:3050)((cid:3015)(cid:2879)(cid:2869))𝑌(cid:2871)(cid:3435)𝑒(cid:2879)(cid:3037)(cid:3050)(cid:3439)

由式（3.3）最终推导出零相位 IIR 滤波器输入信号与输出信号之间的关系为： 

(cid:2870)
𝑌(cid:3435)𝑒(cid:3037)(cid:3050)(cid:3439) = 𝑋(cid:3435)𝑒(cid:3037)(cid:3050)(cid:3439)(cid:3627)𝐻(cid:3435)𝑒(cid:3037)(cid:3050)(cid:3439)(cid:3627)

(3.3) 

(3.4) 

通过上述公式可以得出，在对生理信号进行滤波处理后，输出信号𝑌(cid:3435)𝑒(cid:3037)(cid:3050)(cid:3439)为输入信号

(cid:2870)
𝑋(cid:3435)𝑒(cid:3037)(cid:3050)(cid:3439)经过(cid:3627)𝐻(cid:3435)𝑒(cid:3037)(cid:3050)(cid:3439)(cid:3627)

大小的比例缩放得到的，不存在相位移动。由此可知，本文设计的零

相位滤波器可以达到预期滤波效果。 

17 

3.1.3 零相位 IIR 滤波器仿真效果 

杭州电子科技大学硕士学位论文 

零相位 IIR 滤波器设计完成后，接下来主要验证分析滤波器对雷达信号的滤波性能。当

有人在模拟驾驶时，从采集的雷达信号样本库中随机抽取一段样本，使用 MATLAB 绘制的

时域波形图如图 3.1（a）所示，纵坐标表示经过放大的电压量，通过傅里叶变换所绘制的雷

达信号频谱如图 3.1（b）所示。频谱特性图中能够明显发现有两处幅度比较突出的频率点，

根据对呼吸速率和心率的认知，可以确定这两点分别对应驾驶员的呼吸频率和心跳频率。 

4

3.5

3

2.5

2

1.5

1

0.5

0

-0.5

-1

0

原始信号

原始信号频谱

0.6

0.5

0.4

0.3

0.2

0.1

10

20

30
时间（s）

40

50

60

0

0

1

2
3
频率（Hz）

4

5

（a）雷达信号时域波形图                                             （b）雷达信号频谱图 

图 3.1 雷达信号样本 

通过所设计的滤波器对雷达进行滤波，成功得到输出信号的时域波形图，如图 3.2 所示，

滤波分离得到呼吸心跳时域波形，然后利用傅里叶变换分别得到两类信号的频域波形如图

3.3 所示。从频谱图中可以发现呼吸幅度与心跳幅度经过滤波后都有少量衰减，符合预期给

定的效果，成功分离本文所需的生理疲劳特征信息。可见采集的生理信号经过滤波处理后被

完整分离，分别提取到呼吸信号和心跳信号，便于后续进一步做疲劳驾驶检测研究。 

1.5

1

0.5

0

-0.5

-1

-1.5

0

呼吸信号

10

20

30
时间（s）

40

50

60

1.5

1

0.5

0

-0.5

-1

-1.5

0

心跳信号

10

20

30
时间（s）

40

50

60

（a）时域呼吸信号                                                        （b）时域心跳信号 

图 3.2 零相位 IIR 滤波器分离得到的呼吸心跳时域图 

18 

 
 
杭州电子科技大学硕士学位论文 

呼吸信号频谱

0.6

0.5

0.4

0.3

0.2

0.1

0.6

0.5

0.4

0.3

0.2

0.1

心跳信号频谱

0

0

1

2
3
频率（Hz）

4

5

0

0

1

2
3
频率（Hz）

4

5

（a）频域呼吸信号                                                       （b）频域心跳信号 

图 3.3 零相位 IIR 滤波器分离得到的呼吸心跳频域图 

3.1.4 生理信号特征提取 

多普勒雷达采集的生理信号经过滤波后分离出呼吸、心跳信号，经过频谱特性分析后，

可计算得到一段信号的平均幅值和平均频率。大量研究证实，驾驶员的呼吸与心跳的幅度、

频率会随着疲劳状态的加深而逐渐衰弱[42]。人的疲劳状态与肺部呼吸的深度紧密相关，呼

吸幅值和呼吸周期均有较为显著的改变；而心跳信号幅度非常小，容易受外界噪声影响，对

于疲劳状态不敏感。因此，本文将采用𝐵ℎ、𝐵(cid:3033)、𝐻(cid:3033)作为反映疲劳程度的生理信号特征值，
其中𝐵ℎ表示呼吸信号的幅值，𝐵(cid:3033)表示呼吸信号的频率，𝐻(cid:3033)表示心跳信号频率。 
3.2 基于驾驶员面部动态信息的疲劳特征提取 

驾驶员在行车过程中进入疲劳状态时，面部会出现明显的动态变化，具体表现为眨眼睛、

打哈欠以及点头动作。接下来以基于 Dlib 人脸检测的结果为出发点，分析驾驶员疲劳时，

对眼部运动、嘴部表情以及头部姿态进行分析，得到合适的面部动态特征值。 

3.2.1 眼部运动特征提取 

在清醒情况下，人每分钟眨眼次数大约为 15 次，当产生疲劳时，一定时间内眨眼频率
会出现波动变化[43]。根据基于 Dlib 人脸检测特征点定位人脸眼睑部位，即左眼从 36 点到

41 点，右眼从 42 点到 47 点。参考 PERCLOS 疲劳指标，驾驶员在单位时间内的睁眼与闭眼

的间隔时长可以侧面表现出驾驶员此时的身体疲劳状态。PERCLOS 以单位时间内眼睛闭合

帧数时长占检测总帧数时长的比例为计算公式，具体表达式如下： 

PERCLOS =

眼睛闭合帧数

检测时间总帧数

× 100%

(3.5) 

其中，PERCLOS 将眼睑闭合面积与眼部总面积的比值作为参考标准，比值达到 50%、70%

和 80%和分别代表 EM、P70 和 P80 三类标准。 

19 

 
 
杭州电子科技大学硕士学位论文 

本文引入眼睑纵横比（Eye Aspect Ratio，EAR）来分析眨眼动作，眼睛纵横比即眼眼睑

高度与宽度的比值。其原理是人在睁眼时，眼睑纵横比是个相对稳定的值，而眨眼闭合时，

眼睑的高度会急剧变小，相应的眼睑纵横比值会发生变化。如图 3.4 所示，每只眼睛由 6 个

坐标 p1-p6 点标定，以左眼为例，围绕着眼部区域顺时针标定。 

图 3.4 眼部特征点 

根据坐标高度与宽度之间的关系可得 EAR 计算公式为： 
‖𝑝2 − 𝑝6‖ + ‖𝑝3 − 𝑝5‖
2 × ‖𝑝1 − 𝑝4‖

EAR =

(3.6) 

其中分子表示计算点坐标之间的纵向欧式距离，分母计算点坐标之间的横向欧式距离。纵向

点之间进行加权，确保距离不同的坐标使用不同的比列因子，计算得到 EAR 值有相同尺度，

然后计算出右眼的 EAR 值，取左右眼张合程度的平均值。 

检测眼睛是否闭合，使用阈值来定义一次眨眼过程。结合 PERCLOS 的 P80 标准给

EAR 值设定阈值，当 EAR 值小于 0.2 时设定闭眼状态，当 EAR 值大于 0.2 则认为驾驶员处

于睁眼状态。一段时间内 EAR 值随帧序列的变化曲线如图 3.5 所示，在正常状态下睁开眼

睛时，EAR 值会基本保持在 0.25-0.3 区间内，局部会有小范围波动，总体保持稳定。在眨眼

闭合的瞬间，EAR 值会出现急剧下降，下降到一个最低点后又会迅速恢复到之前的稳定区

间。根据 Soukupova 的研究，如果连续 3 帧 EAR 值低于 0.2 则发生一次眨眼，可以判断产生
了眨眼动作[44]。 

眼睛纵横比曲线

值
R
A
E

0.35

0.3

0.25

0.2

0.15

0.1

0.05

0

眨眼

眨眼

眨眼

1

6

11

16

21

26

31

36

41

46

帧序列

图 3.5 EAR 值变化图 

20 

  
 
 
杭州电子科技大学硕士学位论文 

通过分析眼睛纵横比曲线，对视频帧中低于 0.2 的 EAR 值进行帧计数，若视频帧计数

大于等于 3 则认为眨眼一次，若出现 EAR 值大于 0.2 进行帧计数清零。眼部运动检测效果

如图 3.6 所示，根据采集的面部视频片段可以计算出驾驶员眨眼次数𝑁，那么对于𝑇 = 60𝑠时
间内眨眼频率𝐸(cid:3033)可以定义为： 

𝐸(cid:3033) =

𝑁
𝑇

(3.7) 

（a）闭眼状态                                                                    （b）睁眼状态 

图 3.6 基于 DLib 的眼部运动特征提取 

因此，本论文中基于 Dlib 人脸检测特征点识别，对眼部关键点特征进行分析后，选取

眨眼频率𝐸(cid:3033)作为眼部疲劳特征。 

3.2.2 嘴部表情特征提取 

当驾驶员在开车劳累时，嘴部也会产生较为明显的疲惫特征，最突出的现象就是经常会

打哈欠。并且疲劳时打哈欠的频率会变多，嘴巴张开的程度比清醒状态大得多，会持续一段

时间[45]。由此可见，嘴部表情特征可通过对哈欠动作分析，得出打哈欠频率。如图 3.7 所示，

通过嘴部状态有三种状态：闭嘴、说话和打哈欠，并且打哈欠时嘴巴张开的程度最大，比其

他两种状态大多。 

图 3.7 嘴部三种状态 

本文基于 Dlib 人脸检测特征点定位人脸嘴巴部位，嘴部区域标注点是点 p48-p67，其中

点 p48-p59 构成嘴巴的外轮廓，点 p60-p67 构成嘴巴的内轮廓。根据眼部纵横比 EAR 的类

比思想，引入嘴部纵横比 MAR（Mouth  Aspect  Ratio，MAR）来描述嘴巴张合程度，MAR

值在不同阈值范围内表示不同状态，然后需要根据采集的嘴部标注特征点计算 MAR 值。驾

21 

  
 
 
 
 
杭州电子科技大学硕士学位论文 

驶员在打哈欠时嘴巴形状轮廓会发生显著变化，为了减少嘴唇形状对提取结果的影响，这里

采取内轮廓来表示 MAR 值。嘴部闭合和张开两种情况的内轮廓关键点分布如图 3.8 所示。 

根据坐标高度与宽度之间的关系可得 MAR 计算公式为： 

图 3.8 嘴部特征点 

MAR =

‖𝑝2 − 𝑝8‖ + ‖𝑝3 − 𝑝7‖ + ‖𝑝4 − 𝑝6‖
3 × ‖𝑝1 − 𝑝5‖

(3.8) 

其中分子表示计算点坐标之间的纵向欧式距离，分母计算点坐标之间的横向欧式距离。纵向

点之间进行加权，确保距离不同的坐标使用不同的比列因子，计算得到 MAR 值具有相同尺

度。通常驾驶员在模拟行驶车辆过程中，可能出现会与他人说话的情况。对于嘴部表情而言，

嘴部轮廓会随着日常说话与打哈欠而产生变化，进而使得 MAR 值发生改变。因此，通过实

验对比分析驾驶员嘴部闭合、说话以及打哈欠三个状态的 MAR 值变化，从实验结果中取出

一组数据如表 3.2 所示。 

表 3.2 嘴部表情分析表 

纵向高度和ℎ

横向加权宽度𝑙

（mm） 

（mm） 

24 

84 

136 

162 

156 

141 

嘴部表情 

闭合 

说话 

打哈欠 

MAR 

0.15 

0.54 

0.96 

从表中可知，当驾驶员打哈欠时，MAR 值明显大于说话和闭合状态。Gallup 等人大量

研究发现，人正常打哈欠时 MAR 值大于 0.8，当检测到 MAR 值在连续 5 帧大于 0.8 则认为

出现打哈欠行为，即判定为一次打哈欠[46]。因此，依照本文设计疲劳信息采集方法，设置

打哈欠阈值为 0.8，对视频帧中大于 0.8 的 MAR 值进行帧计数，若视频帧计数大于等于 5 则

认为打哈欠一次，若出现 MAR 值小于 0.8 进行帧计数清零。嘴部状态检测效果如图 3.9 所

示，根据采集的面部视频片段可以计算出驾驶员打哈欠次数𝑐𝑜𝑢𝑛𝑡，那么对于𝑇 = 60𝑠时间
内打哈欠频率𝑌(cid:3033)可以定义为：  

𝑌(cid:3033) =

𝑐𝑜𝑢𝑛𝑡
𝑇

22 

(3.9) 

  
 
杭州电子科技大学硕士学位论文 

（a）正常闭嘴状态                                                        （b）说话状态 

（c）打哈欠状态 

图 3.9 基于 DLib 的嘴部表情特征提取 

本文基于 Dlib 人脸检测特征点识别对嘴部关键点特征进行表情分析后，最终选取打哈

欠频率𝑌(cid:3033)作为嘴部疲劳特征。 

3.2.3 头部姿态特征提取 

当驾驶员处于疲劳状态时不仅眼部和嘴部有不同状态，头部也会发生不同姿态。随着头

部肌肉会慢慢放松，驾驶员整个面部则会不自主地产生点头、后仰等瞌睡动作。由此可见，

头部疲劳特征可通过头部姿态估计，检测驾驶员是否产生疲劳现象。头部姿态估计是通过摄

像头拍摄的二维图像映射到真实世界的三维图像，得到人脸姿态的朝向[47]。如图 3.10 所示，

判断人脸朝向的参数是三个欧拉角，分别为 pitch（俯仰角），yaw（偏航角）和 roll（滚转

角），代表了点头、摇头和转头三个动作[48]。经典的头部姿态估计一般需完成如下步骤：（1）

2D 人脸关键点定位；（2）建立 3D 人脸模型进行人脸匹配；（3）计算 3D 点和对应 2D 的转

换关系；（4）根据旋转矩阵求解姿态欧拉角。 

23 

 
 
 
 
杭州电子科技大学硕士学位论文 

图 3.10 三种头部姿态转动角度 

本文在基于 Dlib 的人脸特征采集模块的基础上首先进行面部轮廓定位，识别 2D 人脸

68 个关键点信息。然后通过 Huber 等提出的 3DMM（3D  Morphable  Face  Model）方法，构
建人脸 3D 向量空间，实现人脸模型匹配[49]。对于从 3D 到 2D 维度转换，是从驾驶员真实

的世界坐标系到视频帧的像素坐标系变换过程，具体过程如图 3.11 所示，头部的三维姿态
到图像二维坐标会经过三次坐标变换。假设世界坐标系中有一点𝑃(𝑋(cid:2907), 𝑌(cid:2907), 𝑍(cid:2907))，第一次经
过世界坐标系到相机坐标系变换得到𝑃(𝑋(cid:2887), 𝑌(cid:2887), 𝑍(cid:2887))，第二次经过相机坐标系到像平面坐标系
变换得到𝑝(𝑥, 𝑦)，第三次经过像平面到像素坐标系变换得到𝑝(𝑢, 𝑣)。 

通过 Dlib 模块获取整个头部姿态后，根据针孔模型[50]可以得到坐标系转换关系为： 

图 3.11 世界坐标系到像素坐标系的变换过程 

𝜆 (cid:4680)

𝑢
𝑣
1

(cid:4681) = (cid:3429)

𝑓(cid:3051)
0
0

0
𝑢(cid:2868)
𝑓(cid:3052) 𝑣(cid:2868)
1
0

(cid:3433) (cid:4670)𝑅|𝑇(cid:4671) (cid:3430)

𝑋(cid:2907)
𝑌(cid:2907)
𝑍(cid:2907)
1

(cid:3434)

24 

(3.10) 

 
 
杭州电子科技大学硕士学位论文 

其中𝑓(cid:3051) = 653.678 、𝑓(cid:3052) = 653.083 、𝑢(cid:2868) = 319.5 、𝑣(cid:2868) = 239.5 是相机内参矩阵系数，𝑅为旋
转矩阵，过人脸模型匹配可以确定姿态旋转矩阵，𝑇为平移矩阵。由于像素坐标比例𝜆和平

移矩阵都为已知参数，根据 DLT（Direct  Linear  Transform，DLT）算法可求得解旋转矩阵𝑅
与欧拉角的关系[51]，具体公式表示如下： 

(cid:3433)  

𝑟(cid:2868)(cid:2868) 𝑟(cid:2868)(cid:2869) 𝑟(cid:2868)(cid:2870)
𝑟(cid:2869)(cid:2868) 𝑟(cid:2869)(cid:2869) 𝑟(cid:2869)(cid:2870)
𝑟(cid:2870)(cid:2868) 𝑟(cid:2870)(cid:2869) 𝑟(cid:2870)(cid:2870)
𝑐𝑜𝑠𝜃(cid:3043)𝑐𝑜𝑠𝜃(cid:3052) 𝑠𝑖𝑛𝜃(cid:3045)𝑠𝑖𝑛𝜃(cid:3052)𝑐𝑜𝑠𝜃(cid:3043) − 𝑐𝑜𝑠𝛾𝑠𝑖𝑛𝜃(cid:3043) 𝑐𝑜𝑠𝛾𝑠𝑖𝑛𝜃(cid:3052)𝑐𝑜𝑠𝜃(cid:3043) + 𝑠𝑖𝑛𝜃(cid:3045)𝑠𝑖𝑛𝜃(cid:3043)
𝑐𝑜𝑠𝜃(cid:3043)𝑠𝑖𝑛𝜃(cid:3052) 𝑠𝑖𝑛𝜃(cid:3045)𝑠𝑖𝑛𝜃(cid:3052)𝑠𝑖𝑛𝜃(cid:3043) + 𝑠𝑖𝑛𝛾𝑠𝑖𝑛𝜃(cid:3043) 𝑐𝑜𝑠𝛾𝑠𝑖𝑛𝜃(cid:3052)𝑠𝑖𝑛𝜃(cid:3043) − 𝑠𝑖𝑛𝜃(cid:3045)𝑐𝑜𝑠𝜃(cid:3043)

𝑅 = (cid:3429)

    = (cid:4686)

(3.11) 

(cid:4687)   

−𝑠𝑖𝑛𝜃(cid:3052)

𝑠𝑖𝑛𝜃(cid:3043)𝑐𝑜𝑠𝜃(cid:3052)

𝑐𝑜𝑠𝜃(cid:3043)𝑐𝑜𝑠𝜃(cid:3052)

其中𝜃(cid:3043)、𝜃(cid:3052)、𝜃(cid:3045)分别是 pitch（俯仰角），yaw（偏航角）和 roll（滚转角）。由上式（3.11）
可以得出三个方向的欧拉角为: 

⎧𝜃(cid:3043) = 𝑎𝑟𝑐𝑡𝑎𝑛 (cid:3436)
⎪⎪

𝜃(cid:3052) = 𝑎𝑟𝑐𝑡𝑎𝑛 (cid:4678)

⎨
⎪⎪
⎩

𝑟(cid:2870)(cid:2869)
𝑟(cid:2870)(cid:2870)

(cid:3440)               

−𝑟(cid:2870)(cid:2868)
(cid:2870)
(cid:2870) + 𝑟(cid:2870)(cid:2870)

(cid:3493)𝑟(cid:2870)(cid:2869)
𝑟(cid:2869)(cid:2868)
𝑟(cid:2868)(cid:2868)

𝜃(cid:3045) = 𝑎𝑟𝑐𝑡𝑎𝑛 (cid:3436)

(cid:3440)             

(cid:4679) 

(3.12) 

在 Dlib 人脸识别 68 特征点检测基础上，通过经典头部姿态估计方法求解欧拉角，计算
得出的𝜃(cid:3043)、𝜃(cid:3052)、𝜃(cid:3045)分别为 pitch、yaw 和 roll 转动角度，其中正常头部姿态和仰头姿势检测效
果如图 3.12 所示。 

（a）正常头部姿势                                                       （b）仰头姿势 

图 3.12 基于 Dlib 的头部姿态特征提取 

根据统计，驾驶员在疲劳驾驶时常常伴随着点头的动作，很少有摆头和摇头的动作，因

此单位时间内是否发生点头可以作为驾驶员出现疲劳状态的表征依据[52]。在头部姿态估计

中，可以提取表示驾驶员人脸朝向的转动角度，参考 PERCLOS 的 P80 标准，以 0 度 pitch
为基准，最终将提取的点头俯仰角𝜃(cid:3043)作为头部姿态疲劳特征。 

25 

  
 
3.3 疲劳驾驶数据集的建立 

杭州电子科技大学硕士学位论文 

由于本文所采用的分类模型是监督学习类的神经网络，因此在对采集到信号进行特征值

提取后需进行预先标注分类，然后让每段疲劳驾驶数据拥有相应的等级编号，以便后续建立

疲劳驾驶数据集。 

3.3.1 疲劳驾驶等级评判 

疲劳驾驶等级评判的过程中一般标注方式有两种：他人客观评判法和驾驶员主观评判法。

驾驶员主观评判法主要用在驾驶员在行车过程中对自身疲劳状态的描述，以问卷的形式定时

让驾驶员进行主观疲劳程度描述。驾驶员主观评判法对驾驶员疲劳状态分类简单、高效以及

实时好，但是在实际操作中测试者会由于体质、检测经验等因素对疲劳状态不敏感，导致对

自己状态判断会出现较大的偏差。为了使数据集标注更加准确、客观，本文将使用他人客观

评判法驾驶员与主观评判法相结合的评判机制。 

面部专家评判是客观评价法的一种，通过选取多名具有专业识别技术的评判专家，结合

疲劳驾驶等级划分表，对驾驶员的疲劳程度做出准确的划分[53]。在前文中，对另一路摄像

头采集的视频进行观测，根据视频中驾驶员的精神状态以及驾驶员驾车是否正常平稳等驾驶

员行为对疲劳程度进行标签分类。其中，专家评判分类参照表如下表 3.3 所示。 

疲劳等级 

疲劳状态 

疲劳等级划分标准 

表 3.3 疲劳等级划分标准 

I 

II 

III 

IV 

清醒状态 

精神状态良好，没有任何疲劳表现 

轻度疲劳  眨眼频率发生变化，出现打哈欠，头部轻微晃动，注意力不集中 

中度疲劳 

眨眼变慢，频繁打哈欠，头部晃动明显，注意力明显不集中 

重度疲劳 

眼睑闭合时间长，眨眼次数明显变少，逐渐进入瞌睡状态 

由于在使用面部专家评判法对驾驶员疲劳状态进行等级划分时，实时性较驾驶员主观评

判法会有差别，对驾驶员模拟驾驶时疲劳状态判定会有一定的偏差。因此将驾驶员主观评判

法与面部专家评判法结合起来综合判定，对于综合判定驾驶员的疲劳状态划分相差一个疲劳

等级的，以面部专家评判法为评判结果。如果相差在两个疲劳等级以上的，舍弃这段时间内

特征数据，选取下一段数据重新评定，确保最终疲劳状态数据集的准确性，建立可靠的标签

分类数据集。 

3.3.2 建立疲劳驾驶数据集 

对于基于监督学习的神经网络模型，数据集将包括输入特征值与所对应的输出向量标签。

输入数据包含六个特征值，分别是雷达采集的生理信号特征和摄像头采集的面部动态特征，

具体为呼吸幅值𝐵(cid:3035)、呼吸频率𝐵(cid:3033)、心跳频率𝐻(cid:3033)、眼部眨动频率𝐸(cid:3033)、嘴部哈欠频率𝑌(cid:3033)、和点

26 

头俯仰角𝜃(cid:3043)。根据前文确定疲劳状态对应输入输出，建立样本数据集可以表示为： 

杭州电子科技大学硕士学位论文 

𝐷 = {(𝑋((cid:3036)) 𝑌((cid:3036)))} , 𝑖 ∈ (cid:4670)1 ,  𝑁(cid:4671)

𝑋((cid:3036)) = (cid:3435)𝐵(cid:3035)

((cid:3046)) 𝐵(cid:3033)

((cid:3046)) 𝐻(cid:3033)

((cid:3046)) 𝐸(cid:3033)

((cid:3046)) 𝑌(cid:3033)

((cid:3046))

((cid:3036))

((cid:3046))(cid:3439)

𝜃𝑝

𝑌((cid:3036)) = (ℎ(𝑠 − 1) ℎ(𝑠 − 2) ℎ(𝑠 − 3) ℎ(𝑠 − 4))((cid:3036))

(3.13) 

(3.14) 

(3.15) 

其中𝐷为疲劳驾驶数据集，总样本为𝑁，𝑋((cid:3036))表示样本索引𝑖的输入数据，𝑋((cid:3036))表示样本索引𝑖

的输入标签，𝑠表示疲劳状态等级，可以取值 1、2、3、4。ℎ(𝑥)函数定义为： 

ℎ(𝑥) = (cid:4676)

1, 𝑥 = 0
0, 𝑥 ≠ 0

(3.16) 

本文将通过交叉验证法对疲劳数据集以 7:3 的比例进行随机分配，分别作为网络模型的

训练集与测试集。两类数据集中每种疲劳等级下的样本总数要求一致，确保分类算法对四种

疲劳状态的检测能力相同，减少数据集分配带来的测试误差。 

3.4 本章小结 

本章主要介绍了疲劳驾驶特征的提取，首先利用设计零相位偏移的 IIR 滤波器进行滤波

处理原始雷达信号，分离出呼吸信号和心跳信号，提取疲劳驾驶生理特征值。对 Dlib 采集

的人脸信息做面部动态信息分析，得出眨眼频率、打哈欠频率等疲劳特征，选取合适的特征

值。最终选取呼吸信号的幅值𝐵(cid:3035)、呼吸信号的频率𝐵(cid:3033)、心跳信号的频率𝐻(cid:3033)、眨眼频率𝐸(cid:3033)、
打哈欠频率𝑌(cid:3033)、和点头俯仰角𝜃(cid:3043)六个特征值作为本文疲劳驾驶检测数据集输入特征向量，通
过面部专家评判法与驾驶员主观评判法相结合建立疲劳驾驶等级评判制度，建立了疲劳驾驶

数据集。 

27 

杭州电子科技大学硕士学位论文 

第 4 章 基于 AWPSO-ROS-ELM 的驾驶员疲劳状态检测 

神经网络是一种非线性处理的网络系统，将数据由输入经过非线性映射到输出，就像人

类大脑一样能够处理任意复杂非线性问题，达到逼近的预期效果。本文将设计一种前馈神经

网络模型对驾驶员疲劳状态进行分类学习，并对这种分类模型进行算法优化，设计出泛化能

力更强的疲劳状态识别模型。 

4.1 正则在线序贯极限学习机 

随着大数据分析技术的不断发展，人工神经网络被广泛用于拟合分类问题中，然而传统

的网络模型计算繁杂，需要进行大量 CPU 运算，因此在实际需求中效率低下。针对上述问

题，2004 年 Huang  G.B.教授等人提出极限学习机（Extreme  Learning  Machine，ELM）理论，

作为一种全新的监督学习算法，该算法极大弥补了大部分前馈神经网络训练效率低、易陷入

局部解空间的缺点[54]。ELM 拥有更强大的特性，且效率更高，具备更快的机器学习效率与

更高效的泛化性能，并通过进一步发展而被广泛应用在分析、回归、聚合、特征教学等实际

问题中[55]。 

4.1.1 极限学习机理论 

1x

2x

nx

1H

jH

LH

1o

2o

mo

输入层

单隐藏层

输出层

图 4.1 ELM 网络模型 

极限学习机是一种全新基于前馈神经网络的优秀监督学习算法，其单隐含层节点参数是

随机产生且不需要调节，学习过程中只需要计算输出权重。ELM 最重要的优势就是相比于

常规的神经网络，特别是单隐层前馈神经网络，在保证学习的前提下速度比常规的机器学习

28 

 
杭州电子科技大学硕士学位论文 

算法还要快。ELM 的网络结构如图 4.1 所示，从结构上主要分为输入层、隐藏层和输出层。

其中隐藏层的主要参数为输入权值与输出偏置，通常用权重矩阵表示，在模型训练阶段根据

任意连续的概率分布随机加以初始化。极限学习机的算法在处理隐藏层输出偏置时通过输出

误差最小化的方式加以解决，因此损失函数最小时即为最佳解。具体分析如下： 

假设样本总数𝑁、数据集𝑆 = (cid:4670)𝑋, 𝑇(cid:4671)输入特征向量维度𝑛、隐藏层节点数𝐿、输出向量维

度𝑚。那么，输入数据为: 

输出标签为: 

隐藏层输入权重𝑊: 

隐藏层输入偏置𝑏: 

隐藏层输出权重𝛽: 

𝑋 = (cid:4670)𝑋((cid:2869)) 𝑋((cid:2870)) ⋯ 𝑋((cid:3015))(cid:4671)(cid:3041)×(cid:3015)

𝑋((cid:3036)) = (𝑥(cid:2869) 𝑥(cid:2870)    ⋯ 𝑥(cid:3041))(cid:3021)

𝑇 = (cid:4670)𝑇((cid:2869)) 𝑇((cid:2870)) ⋯ 𝑇((cid:3015))(cid:4671)(cid:3021)
𝑡(cid:2870) ⋯ 𝑡(cid:3040))(cid:3021)

𝑇((cid:3036)) = (𝑡(cid:2869)

(cid:3015)×(cid:3040)

𝑊 = (cid:4670)𝑊(cid:2869) 𝑊(cid:2870) ⋯ 𝑊(cid:3013)(cid:4671)(cid:3021)
(cid:3013)×(cid:3041)
𝑊(cid:3037) = (𝑤(cid:3037)(cid:2869) 𝑤(cid:3037)(cid:2870)    … 𝑤(cid:3037)(cid:3041))(cid:3021)

𝑏 = (𝑏(cid:2869) 𝑏(cid:2870)    … 𝑏(cid:3013))(cid:3021)

𝛽 = (cid:4670)𝛽(cid:2869) 𝛽(cid:2870) ⋯ 𝛽(cid:3013)(cid:4671)(cid:3021)
(cid:3013)×(cid:3040)
𝛽(cid:3038) = (𝛽(cid:3038)(cid:2869) 𝛽(cid:3038)(cid:2870) ⋯ 𝛽(cid:3038)(cid:3040))(cid:3021)

(4.1) 

(4.2) 

(4.3) 

(4.4) 

(4.5) 

(4.6) 

(4.7) 

(4.8) 

(4.9) 

在前馈神经网络中较为流行的激活函数常用有四类，即𝑠𝑖𝑔𝑚𝑜𝑖𝑑 函数、𝑡𝑎𝑛ℎ函数、

𝑅𝑒𝐿𝑈函数和𝑠𝑜𝑓𝑡𝑝𝑢𝑙𝑠函数，几大常用激活函数大致曲线的绘制如图 4.2 所示，。 

sigmoid

ReLU

1

0

1

0

x

x

图 4.2 四个常用激活函数曲线 

29 

tanh

-1

Softplus

1

0

1

0

x

x

 
杭州电子科技大学硕士学位论文 

为使得极限学习机模型对不同数据特征更加敏感，从而获得更好训练效果，选取

sigmoid 函数作为隐藏层的激活函数，定义为: 

𝑔(𝑥) =

1
1 + 𝑒(cid:2879)(cid:3051)

通过对激活函数加入非线性处理机制，使学习更快、更有效，因此有: 
((cid:3036)) = 𝑔(cid:3435)𝑊(cid:3037)𝑋((cid:3036)) + 𝑏(cid:3037)(cid:3439) =

𝐻(cid:3037)

1
1 + 𝑒(cid:2879)(cid:3435)(cid:3024)(cid:3285)(cid:3025)((cid:3284))(cid:2878)(cid:3029)(cid:3285)(cid:3439)

用𝐻矩阵表示隐藏层如下: 

𝐻(𝑊, 𝑏, 𝑋) = (cid:4686)

𝑔(cid:3435)𝑊(cid:2869)𝑋((cid:2869)) + 𝑏(cid:2869)(cid:3439) ⋯ 𝑔(cid:3435)𝑊(cid:3013)𝑋((cid:2869)) + 𝑏(cid:3013)(cid:3439)
⋱
𝑔(cid:3435)𝑊(cid:2869)𝑋((cid:3015)) + 𝑏(cid:2869)(cid:3439) ⋯ 𝑔(cid:3435)𝑊(cid:3013)𝑋((cid:3015)) + 𝑏(cid:3013)(cid:3439)

⋮

⋮

(cid:4687)

(cid:3015)×(cid:3013)

根据上文所述，样本输出𝑂((cid:3036))用公式描述为: 

𝐻((cid:3036))𝛽 = 𝑂((cid:3036)),  𝑖 = 1, ⋯ , 𝑁

(4.10) 

(4.11) 

(4.12) 

(4.13) 

训练极限学习机模型的最终目标就是预测输出与实际输出误差趋于最小化，实现训练样

本的预测输出零误差。所以训练神经网络的损失函数目标为: 

(cid:3015)
(cid:3533) ∥ 𝑂((cid:3036)) − 𝑇((cid:3036)) ∥(cid:3040)×(cid:3015)= 0
(cid:3036)(cid:2880)(cid:2869)

因此存在𝛽，𝑊(cid:3037)和𝑏(cid:3037)使得:  

(cid:3630)𝐻(𝑊, 𝑏, 𝑋)𝛽(cid:4632) − 𝑇(cid:3630) = 𝑚𝑖𝑛
(cid:3024),(cid:3029),(cid:3081)

‖𝐻(𝑊, 𝑏, 𝑋)𝛽 − 𝑇‖

(4.14) 

(4.15) 

在 ELM 中，一旦隐藏层输入权重𝑊和隐藏层输入偏置𝑏被随机确定，隐藏层的输出矩

阵𝐻就被唯一确定，根据𝐻𝛽 = 𝑇，求最小二乘解有： 

𝛽(cid:4632) = 𝐻(cid:2993)𝑇

(4.16) 

其中，𝛽(cid:4632)是输出偏置训练值，𝐻(cid:2993)是𝐻的 Moore-Penrose 广义逆。计算 Moore-Penrose 广义逆矩
阵的方法有奇异值分解、正交投影法和迭代法等方法。当𝐻(cid:3021)𝐻满足非奇异矩阵时通过正交
投影法有𝐻(cid:2993) = (𝐻(cid:3021)𝐻)(cid:2879)(cid:2869)𝐻(cid:3021)。根据经典极限学习机的描述，ELM 算法实现过程为： 

Step 1：初始化随机产生隐藏层连接权值矩阵𝑊与输入偏置向量𝑏； 

Step 2：计算输入层与隐藏层之间的权重矩阵𝐻； 

Step 3：根据式（4.16）计算隐藏层输出权重𝛽。 

如图 4.3 为极限学习机的具体训练流程，可以发现，ELM 没有复杂的迭代过程只需调

整合适的神经元个数，即可得到高效率的训练模型。但是，对于训练误差较小的前馈神经网

络，网络的泛化能力随权值范数的大小而改变，通常权值越小，网络性能更强大。在权值与

阈值问题的解决方法中，与传统神经网络方式不同的是，不需要通过反复迭代来调整权重矩

阵。ELM 能够直接将隐藏层参数的求解转换为计算 Moore-Penrose 广义逆矩阵，通过最小二

乘法来计算逆矩阵的极小范数最小二乘解，从而得到权重和阈值的输出。 

30 

杭州电子科技大学硕士学位论文 

开始

给定样本训练集

初始化隐藏层神经
元个数L，输入权
重W和输入b 

计算隐藏层输出矩
阵H=g(W*X+b)

训练得出输出权重β

增加神经元个数

N

是否满足误差要求

在样本测试集上进行

测试

Y

结束

4.1.2 正则化极限学习机 

图 4.3 ELM 网络模型训练流程 

在一个数学模型中，需要同时权衡经验风险和结构风险两种因素，才能有较好的泛化能

力。经典极限学习机理论忽略结构风险，通常在面临实际问题时训练的模型容易过拟合，导

致网络模型最终预测结果误差偏大。为了解决过拟合问题，Deng 等在极限学习机中引入了

经 验 风 险 正 则 化 因 子 𝛾 ， 提 出 了 正 则 化 极 限 学 习 机 模 型 （ Regularized  Extreme  Learning 
Machine,  RELM）[56]。该算法模型在衡量预测误差与输出误差都取最小值情况下，对经验风

险和结构风险进行综合考虑，如下所示： 

⎧ min
⎨
⎩

1
2

‖𝜃‖(cid:2870) +

1
2

(cid:3015)

𝛾 (cid:3533)‖𝜉(cid:3036)‖(cid:2870)

(cid:3036)(cid:2880)(cid:2869)
(cid:3021) , 𝑖 = 1,2, … , 𝑁

𝑠. 𝑡. ℎ(𝑥(cid:3036))𝛽 = 𝑡(cid:3036)
其中，‖𝛽‖(cid:2870)表示结构风险， 𝜉(cid:3036) 是样本 𝑥(cid:3036) 的误差，‖𝜉(cid:3036)‖(cid:2870)表示经验风险。 

(cid:3021) − 𝜉(cid:3036)

(4.17) 

这两种风险在最佳权衡下使得模型获得最佳泛化性能，构建拉格朗日函数求解公式： 

𝐿(𝛽, 𝜉, 𝑎) =

1
2

‖𝛽‖(cid:2870) +

1
2

(cid:3015)

(cid:3015)

(cid:3040)

𝛾 (cid:3533)‖𝜉(cid:3036)‖(cid:2870)

− (cid:3533) (cid:3533) 𝑎(cid:3036),(cid:3037)(ℎ(𝑥(cid:3036))𝛽(cid:3037) − 𝑡(cid:3036),(cid:3037) + 𝜉(cid:3036),(cid:3037))

(4.18) 

(cid:3036)(cid:2880)(cid:2869)

(cid:3036)(cid:2880)(cid:2869)

(cid:3037)(cid:2880)(cid:2869)

其中，𝑎为拉格朗日算子，由于式（4.18）关于(𝛽, 𝜉, 𝛼)的梯度为 0，然后根据 KKT 条件，最

终可以求解出 RELM 最小二乘解： 

31 

 
         
         
杭州电子科技大学硕士学位论文 

𝛽(cid:4632) = (𝐻𝐻(cid:3021) +

1
𝛾

)(cid:2879)(cid:2869)𝐻(cid:3021)𝑇

(4.19) 

从式（4.19）可以看出，加入正则化因子后的 RELM 一样无需频繁调节训练参数，在实

际训练时只需设定合适的隐藏层神经元个数就能达到满意的预测效果。当正则化因子𝛾过大

时，RELM 会无限近似于无正则化因子的 ELM。RELM 在继承 ELM 高效训练性能后，通过

加入正则化因子𝛾来解决因结构风险导致的过拟合问题，从而获得较优拟合效果。 

4.1.3 正则在线序贯极限学习机 

RELM 是对所有训练数据进行训练，然而在实际应用中，数据会随着时间不断更新。若

在训练完成后有新的样本加入还需重新训练整个数据集，无法继续在线更新模型，因此必须

针对这种情况进行修改 RELM 算法，在初始训练后可以继续逐块或者单个再训练，当有新

增样本加入训练时仅需训练新增加入样本即可得到新的网络输出权值，完成更新网络，实现

在线学习，提高模型的训练速率和泛化能力。2017 年，李在结合正则化极限学习机与在线

序贯极限学习机的基础上提出正则在线序贯极限学习机（Regularized  Online  Sequential  ELM，
ROS-ELM），用于神经元分类算法的研究[57]。ROS-ELM 是对正则化极限学习机的一种改进，

在保证它原有的性能基础上，具有持续学习的能力，对新样本的加入只需序贯训练，而不需

对所有样本重新迭代，减少重复训练带来的时间损耗。 

ROS-ELM 网络模型的训练过程分为离线训练阶段与序贯学习阶段这两个阶段，首先利

用部分样本训练得到输出权重𝛽，如果有新增样本，将进入序贯学习阶段，即通过新增样本
((cid:3036)))的数量为𝑁(cid:2868)，根据
在线训练对𝛽进行在线更新。在离线训练阶段，假设训练样本(𝑋(cid:2868)
经典极限学习机理论的思想，希望𝛽(cid:2868)使||𝐻(cid:2868)(𝑊, 𝑏, 𝑋(cid:2868))𝛽 − 𝑇(cid:2868)||最小，隐藏层权重矩阵与实际
输出可以表示为 

((cid:3036)), 𝑇(cid:2868)

𝑔(cid:3435)𝑊(cid:2869)𝑋(cid:2868)

𝐻(cid:2868)(𝑊, 𝑏, 𝑋) = (cid:4686)

𝑔(cid:3435)𝑊(cid:2869)𝑋(cid:2868)

((cid:2869)) + 𝑏(cid:2869)(cid:3439) ⋯ 𝑔(cid:3435)𝑊(cid:3013)𝑋(cid:2868)
⋱
⋮
((cid:3015)) + 𝑏(cid:2869)(cid:3439) ⋯ 𝑔(cid:3435)𝑊(cid:3013)𝑋(cid:2868)

((cid:2869)) + 𝑏(cid:3013)(cid:3439)
⋮
((cid:3015)) + 𝑏(cid:3013)(cid:3439)

𝑇(cid:2868) = (cid:3427)𝑇(cid:2868)

((cid:2869)) 𝑇(cid:2868)

((cid:2870)) ⋯ 𝑇(cid:2868)

(cid:3021)
((cid:3015)(cid:3116))(cid:3431)

(cid:3015)(cid:3116)×(cid:3040)

根据前文的 RELM 算法，可以计算出𝛽(cid:2868)： 

𝛽(cid:2868) = (cid:3436)𝐻(cid:2868)

(cid:3021)𝐻(cid:2868) +

(cid:2879)(cid:2869)

1
𝛾

(cid:3440)

𝐻(cid:2868)

(cid:3021)𝑇(cid:2868)

(cid:4687)

(cid:3015)(cid:3116)×(cid:3013)

(4.20) 

(4.21) 

(4.22) 

令𝐾(cid:2868) = 𝐻(cid:2868)

(cid:3021)𝐻(cid:2868) +

(cid:2869)

(cid:3082)

。当有新样本进入模型学习时，假设训练过程中有𝑁(cid:2869)个新增样本，此

时基于 ELM 思想，希望𝛽(cid:2869)满足下式𝛽使其最小： 

𝑚𝑖𝑛 (cid:3631) (cid:3428)

𝐻(cid:2868)
𝐻(cid:2869)

(cid:3432) 𝛽 − (cid:3428)

𝑇(cid:2868)
𝑇(cid:2869)

(cid:3432) (cid:3631)

(4.23) 

32 

 
杭州电子科技大学硕士学位论文 

根据前文求解广义逆矩阵的推导方式，𝛽(cid:2869)的值为： 
𝑇(cid:2868)
𝑇(cid:2869)

𝛽(cid:2869) = 𝐾(cid:2869)

𝐻(cid:2868)
𝐻(cid:2869)

(cid:2879)(cid:2869) (cid:3428)

(cid:3432)

(cid:3428)

(cid:3021)

(cid:3432)

其中， 

𝐾(cid:2869) = (cid:3428)

(cid:3021)

𝐻(cid:2868)
𝐻(cid:2869)

(cid:3432)

𝐻(cid:2868)
(cid:3428)
𝐻(cid:2869)

(cid:3432)

(4.24) 

(4.25) 

对于后续新数据集的在线学习，我们希望把𝛽(cid:2869)表示成𝛽(cid:2868)，𝐾(cid:2869)，𝐻(cid:2869)和𝑇(cid:2869)的等式，𝐾(cid:2869)可以

表示为： 

𝐾(cid:2869) = (cid:4670)𝐻(cid:2868)

(cid:3021) 𝐻(cid:2869)

(cid:3021)(cid:4671) (cid:3428)

𝐻(cid:2868)
𝐻(cid:2869)

(cid:3432) = 𝐾(cid:2868) + 𝐻(cid:2869)

(cid:3021)𝐻(cid:2869)

(4.26) 

因此，式（4.25）可以写成： 

   (cid:3428)

(cid:3021)

𝐻(cid:2868)
𝐻(cid:2869)

(cid:3432)

(cid:3428)

𝑇(cid:2868)
𝑇(cid:2869)

(cid:3432) = 𝐻(cid:2868)

(cid:3021)𝑇(cid:2868) + 𝐻(cid:2869)

(cid:3021)𝑇(cid:2869)

                                                          = 𝐾(cid:2868)𝐾(cid:2868)

(cid:2879)(cid:2869)𝐻(cid:2868)

(cid:3021)𝑇(cid:2868) +   𝐻(cid:2869)

(cid:3021)𝑇(cid:2869)# 

                                                          = 𝐾(cid:2868)𝛽(cid:2868) + 𝐻(cid:2869)𝑇(cid:2869) 

                                                          = (𝐾(cid:2869) − 𝐻(cid:2869)𝐻(cid:2869))𝛽(cid:2868) + 𝐻(cid:2869)

(cid:3021)𝑇(cid:2869)  

再结合式（4.24）和式（4.27）可以得知： 

  = 𝐾(cid:2869)𝛽(cid:2868) − 𝐻(cid:2869)

(cid:3021)𝐻(cid:2869)𝛽(cid:2868) + 𝐻(cid:2869)

(cid:3021)𝑇(cid:2869)

(4.27) 

                                                             𝛽(cid:2869) = 𝐾(cid:2869)

                                                           = 𝐾(cid:2869)

(cid:3021)𝐻(cid:2869)𝛽(cid:2868) + 𝐻(cid:2869)

(cid:3021)𝑇(cid:2869)) 

(cid:3021)

(cid:3432)  

(cid:3428)

(cid:3432)

(cid:2879)(cid:2869) (cid:3428)

𝐻(cid:2868)
𝐻(cid:2869)

𝑇(cid:2868)
𝑇(cid:2869)
(cid:2879)(cid:2869)(𝐾(cid:2869)𝛽(cid:2868) − 𝐻(cid:2869)

= 𝛽(cid:2868) + 𝐾(cid:2869)

(cid:3021)𝐻(cid:2869)(𝑇(cid:2869) − 𝐻(cid:2869)𝛽(cid:2868))

因此，根据式（4.26）和式（4.28），计算得到在线学习的递推表达式为： 

𝐾(cid:3038)(cid:2878)(cid:2869) = 𝐾(cid:3038) + 𝐻(cid:3038)(cid:2878)(cid:2869)

(cid:3021)𝐻(cid:3038)(cid:2878)(cid:2869)

其中，𝐾(cid:3038)(cid:2878)(cid:2869)
                        𝐾(cid:3038)(cid:2878)(cid:2869)

(cid:2879)(cid:2869)𝐻(cid:3038)(cid:2878)(cid:2869)
(cid:2879)(cid:2869)通过 Woodbury 公式[58]推导可得： 

𝛽(cid:3038)(cid:2878)(cid:2869) = 𝛽(cid:3038) + 𝐾(cid:3038)(cid:2878)(cid:2869)

(cid:3021)(𝑇(cid:3038)(cid:2878)(cid:2869) − 𝐻(cid:3038)(cid:2878)(cid:2869)𝛽(cid:3038))

(cid:2879)(cid:2869) = (𝐾(cid:3038) + 𝐻(cid:3038)(cid:2878)(cid:2869)

(cid:3021)𝐻(cid:3038)(cid:2878)(cid:2869))(cid:2879)(cid:2869)  

= 𝐾(cid:3038)

(cid:2879)(cid:2869) − 𝐾(cid:3038)

(cid:2879)(cid:2869)𝐻(cid:3038)(cid:2878)(cid:2869)

(cid:3021)(cid:3435)𝐼 + 𝐻(cid:3038)(cid:2878)(cid:2869)𝐾(cid:3038)

(cid:2879)(cid:2869)𝐻(cid:3038)(cid:2878)(cid:2869)

(cid:3021)(cid:3439)

(cid:2879)(cid:2869)

𝐻(cid:3038)(cid:2878)(cid:2869)𝐾(cid:3038)

(cid:2879)(cid:2869)

最后，用𝑃𝑘+1替换𝐾(cid:3038)(cid:2878)(cid:2869)

(cid:2879)(cid:2869)，递推式可表示为： 

𝑃(cid:3038)(cid:2878)(cid:2869) = 𝑃(cid:3038) − 𝑃(cid:3038)𝐻(cid:3038)(cid:2878)(cid:2869)

(cid:3021)(cid:3435)𝐼 + 𝐻(cid:3038)(cid:2878)(cid:2869)𝑃(cid:3038)𝐻(cid:3038)(cid:2878)(cid:2869)

(cid:3021)(cid:3439)

(cid:2879)(cid:2869)

𝐻(cid:3038)(cid:2878)(cid:2869)𝑃(cid:3038)

𝛽(cid:3038)(cid:2878)(cid:2869) = 𝛽(cid:3038) + 𝑃(cid:3038)(cid:2878)(cid:2869)𝐻(cid:3038)(cid:2878)(cid:2869)

(cid:3021)(𝑇(cid:3038)(cid:2878)(cid:2869) − 𝐻(cid:3038)(cid:2878)(cid:2869)𝛽(cid:3038))

(4.28) 

(4.29) 

(4.30) 

(4.31) 

(4.32) 

(4.33) 

以上为正则在线序贯极限学习机的算法原理，具体过程如图 4.4 所示，首先使用离线样

33 

 
杭州电子科技大学硕士学位论文 

本初始化网络模型的输出权重𝛽(cid:2868)，初始化结束后进入在线序贯学习阶段，通过每一次新增样
本数据不断调整𝛽，这样模型具有批量学习的能力，在复杂环境下，具有广泛的自适应能力，

而不需重复训练全部样本。相对于 RELM，ROS-ELM 更适用于实际工程应用，可以在疲劳

驾驶检测时充分体现。由对检测的实时性要较高，在实际应用中缩短再训练时长，有效对驾

驶员疲劳状态做出迅速识别，并且不断完成自身的检测能力。 

新增样本
1

新增样本
2

新增样本
k

离线样本

RELM
分类模型

ROS-ELM
分类模型1

ROS-ELM
分类模型2

ROS-ELM
分类模型k

图 4.4 ROS-ELM 网络模型训练过程 

正则在线序贯极限学习机与传统的分类模型比较，ROS-ELM 具备了以下三点优势： 

（1）能够随意选择隐藏层节点的输入连接权值和偏置，而不需像传统 BP 的神经网络

需要通过不断地迭代反复调节参数，从而能够把传统非线性模型转换为线性模型； 

（2）不需要过多的人为干涉，只需设置合适的神经元个数； 

（3）支持在线批量学习，将输出最大权值矩阵的解转换为极小范数最小二乘法解的问

题，提高了网络学习速率。 

4.2 自适应权重粒子群优化算法 

由于正则在线序贯极限学习机的在线学习阶段是对离线阶段训练模型的迭代更新并且依

赖于初始阶段，而离线阶段隐藏层的输入权值与偏置是通过连续概率分布随机产生的，可能

出现某些随机权值非常小的情况，甚至几乎趋于零的隐藏层节点。这会造成隐藏层部分神经

元失去激活效果，同时初始化随机产生的权重矩阵不为最优模型参数，进而影响 ROS-ELM

的稳定性与泛化性能。虽然在理论上可以使用和样本数量一致的隐藏层节点数，以提高模型

的训练精确度和使神经网络产生更良好的泛化特性。但在实际应用中，有较大程度上依赖隐

藏层节点的输入连接权值和偏置，却很难随意选取最合适的权值和偏置逼近目标矩阵，以确

保每一个的训练结果都能获得一个令人满意的精度。因此，本文引入改进的 PSO 算法来优

化 ROS-ELM 的离线阶段模型隐藏层输入权重和偏置，从而获得最优的网络结构。 

4.2.1 经典粒子群优化算法 

粒子群优化算法（Particle  Swarm  Optimization，PSO）是一种群智能优化算法，可以在

d 维空间中随机搜索，解决目标函数最优值问题。在使用 PSO 求解问题时，每一个粒子可以

34 

 
杭州电子科技大学硕士学位论文 

被看做问题的一个解。PSO 的独特之处主要在于 PSO 是通过全局更新与个体更新相结合的

方式更新粒子的位置。粒子群中包含若干个粒子，粒子群中的粒子在搜索过程中通过若干次

迭代，不断更新粒子位置最终完成搜索，以找到最终的解。 

在𝑑维空间里，假设有𝑛个粒子集合𝑃 = (𝑃((cid:2869)) 𝑃((cid:2870)) ⋯ 𝑃((cid:3041)))，每个粒子𝑖有位置𝑃((cid:3036)) =
(𝑃(cid:2869) 𝑃(cid:2870) ⋯ 𝑃(cid:3031))(cid:3021) 和速度𝑉((cid:3036)) = (𝑉(cid:2869) 𝑉(cid:2870) ⋯ 𝑉(cid:3031))(cid:3021) 两个属性。在每次搜索解空间时，记录
粒子 i 搜索到的最佳位置𝑝𝑏𝑒𝑠𝑡((cid:3036)) = (𝑝𝑏𝑒𝑠𝑡(cid:2869) 𝑝𝑏𝑒𝑠𝑡(cid:2870) ⋯ 𝑝𝑏𝑒𝑠𝑡(cid:3031))(cid:3021)作为局部最优解，记录
所有粒子搜索到的最佳位置𝑔𝑏𝑒𝑠𝑡 = (𝑔𝑏𝑒𝑠𝑡(cid:2869) 𝑔𝑏𝑒𝑠𝑡(cid:2870) ⋯ 𝑔𝑏𝑒𝑠𝑡(cid:3031))(cid:3021)作为当前全局最优解。
一般为了防止粒子盲搜索增加随机有效性，会给粒子的速度和位置限制条件： 

𝑉((cid:3036)) ∈ (cid:4670)−𝑣(cid:3040)(cid:3028)(cid:3051), 𝑣(cid:3040)(cid:3028)(cid:3051)(cid:4671), 𝑃((cid:3036)) ∈ (cid:4670)−𝑝(cid:3040)(cid:3028)(cid:3051), 𝑝(cid:3040)(cid:3028)(cid:3051)(cid:4671)

(4.34) 

在每一次迭代的过程中，全局最优粒子是整个粒子群所有粒子到当前迭代完成时的最好

粒子，相较之下，个体最优粒子就是当前粒子到当前迭代完成时的最好粒子。每个粒子的运

动速度和搜索位置更新公式如下： 

𝑉((cid:3036))(𝑡 + 1) = 𝑉((cid:3036))(𝑡) + 𝑐(cid:2869)𝑟(cid:2869) (cid:4672)𝑝𝑏𝑒𝑠𝑡((cid:3036))(𝑡) − 𝑃((cid:3036))(𝑡)(cid:4673) + 𝑐(cid:2870)𝑟(cid:2870) (cid:4672)𝑔𝑏𝑒𝑠𝑡(𝑡) − 𝑃((cid:3036))(𝑡)(cid:4673)

(4.35)   

𝑃((cid:3036))(𝑡 + 1) = 𝑃((cid:3036))(𝑡) + 𝑉((cid:3036))(𝑡 + 1)

(4.36) 

其中，𝑡为迭代次数，𝑉((cid:3036))(𝑡 + 1)为第𝑡 + 1代粒子𝑖的速度，𝑉((cid:3036))(𝑡)为第𝑡代粒子𝑖的速度，
𝑃((cid:3036))(𝑡 + 1)为第𝑡 + 1代粒子𝑖的位置，𝑃((cid:3036))(𝑡)为第𝑡代粒子𝑖的位置，𝑝𝑏𝑒𝑠𝑡((cid:3036))(𝑡)为第𝑡代个体最
优粒子𝑖的位置，𝑔𝑏𝑒𝑠𝑡(𝑡)为第𝑡代全局最优粒子的位置，𝑐(cid:2869)和𝑐(cid:2870)为学习因子，𝑟(cid:2869)和𝑟(cid:2870)为(0,1)之
间的随机数。 

若优化目标函数用适应度函数𝑓(𝑋)表示，那么通过 PSO 算法搜索当前粒子𝑖所在的最佳

位置可以表示为： 

𝑝𝑏𝑒𝑠𝑡((cid:3036))(𝑡 + 1) = (cid:4688)

𝑝𝑏𝑒𝑠𝑡((cid:3036))(𝑡) 𝑓 (cid:4672)𝑃((cid:3036))(𝑡 + 1)(cid:4673) ≥ 𝑓 (cid:4672)𝑝𝑏𝑒𝑠𝑡((cid:3036))(𝑡)(cid:4673)

𝑃((cid:3036))(𝑡 + 1) 𝑓 (cid:4672)𝑃((cid:3036))(𝑡 + 1)(cid:4673) < 𝑓 (cid:4672)𝑝𝑏𝑒𝑠𝑡((cid:3036))(𝑡)(cid:4673)

(4.37) 

因此对于个体粒子全局搜索所得到最优位置为： 

𝑔𝑏𝑒𝑠𝑡(𝑡) = min (cid:4676)𝑓 (cid:4672)𝑝𝑏𝑒𝑠𝑡((cid:2869))(𝑡)(cid:4673) , 𝑓 (cid:4672)𝑝𝑏𝑒𝑠𝑡((cid:2870))(𝑡)(cid:4673) , ⋯ , 𝑓 (cid:4672)𝑝𝑏𝑒𝑠𝑡((cid:3041))(𝑡)(cid:4673)(cid:4677)

(4.38) 

如图 4.5 所示，粒子的每一步选择，搜索到的位置可能不乐观，也可能较之前出现历史

最优情况。因此在一定的迭代次数内，每次舍弃更差的位置，保留更好的位置，最后尽可能

达到一个全局最优的位置。PSO 是一类通过对目标函数优化的群优化算法，与遗传算法不

同的是没有频繁交叉变异操作，它在当前寻找到的局部最优解基础上，迭代搜索到全局最优

解。PSO 算法在函数极值求解、神经网络参数优化等领域有良好的应用基础，但处理多峰

值问题时，容易早熟收敛，全局搜索能力弱等问题。后来 Eberhart 对 PSO 算法做出完善，
通过研究粒子群的收敛行为，在速度迭代公式中引入惯性因子𝜑，提出标准的 PSO 算法[59]。

标准 PSO 算法的粒子运动速度更新表达式为： 

35 

杭州电子科技大学硕士学位论文 

𝑉((cid:3036))(𝑡 + 1) = 𝜑𝑉((cid:3036))(𝑡) + 𝑐(cid:2869)𝑟(cid:2869) (cid:4672)𝑝𝑏𝑒𝑠𝑡((cid:3036))(𝑡) − 𝑃((cid:3036))(𝑡)(cid:4673) + 𝑐(cid:2870)𝑟(cid:2870) (cid:4672)𝑔𝑏𝑒𝑠𝑡(𝑡) − 𝑃((cid:3036))(𝑡)(cid:4673)

(4.39) 

图 4.5 PSO 优化示意图 

惯性权重𝜑的值会影响粒子的搜索能力，当𝜑较小时局部搜索能力强，当𝜑较大时由于

全局搜索。加入惯性因子的 PSO 算法，有了自我调节适应能力，凭借经验和多次实验来调

节参数，对于不同的场景选取不同的值是比较常用的方案。对每一种环境，粒子的规模数量

随样本特征维度变化。学习因子与惯性因子共同控制种群搜索能力，与惯性权重相反，学习

因子越大，粒子的局部开发能力越强，趋向于局部寻优。为了衡量粒子群的有效性，其分布

在问题空间的多样性必须充足，保证粒子群在初始搜索后随着优化深入程度而降低。 

4.2.2 自适应惯性权重优化 PSO 

由于经典的 PSO 算法搜索效率低，并且很容易陷入局部搜索空间，无法满足粒子群的

有效性。因此，很多改进的 PSO 算法被广泛的研究。Ratnaweera 等对粒子的速度添加扰动，

并且对惯性权重加入时变系数，使得粒子更具有种群特征[60]。Lin 等通过对学习因子增加线
性因素和非线性惯性权重改善搜索范围和速度[61]。Zaharis 等提出粒子的速度突变性改善粒
子的随机性和收敛速率[62]。他们在各自的研究领域中，使用改进的 PSO 算法证实了有效性。 

本文着手从惯性权重的选择出发，弱化其他参数对算法带来的影响，提高算法收敛能力，

增加一种的自适应惯性权重策略，可以根据整个粒子群的搜索进展动态调整𝑤参数的值，具

体设计如下： 

𝜑(𝑡 + 1) = (cid:4688)

𝜑(cid:3040)(cid:3036)(cid:3041) −

(𝜑(cid:3040)(cid:3028)(cid:3051) − 𝜑(cid:3040)(cid:3036)(cid:3041)) ∗ (𝑓 − 𝑓(cid:3040)(cid:3036)(cid:3041))
𝑓(cid:3028)(cid:3049)(cid:3034) − 𝑓
𝜑(cid:3040)(cid:3028)(cid:3051), 𝑓 > 𝑓(cid:3028)(cid:3049)(cid:3034)

, 𝑓 ≤ 𝑓(cid:3028)(cid:3049)(cid:3034)

(4.40) 

36 

 
杭州电子科技大学硕士学位论文 

其中，𝜑(cid:3040)(cid:3036)(cid:3041)表示历史最小惯性权重的值，𝜑(cid:3040)(cid:3028)(cid:3051)表示历史最大惯性权重的值，𝑓表示当前粒子
群体的目标函数值，𝑓(cid:3028)(cid:3049)(cid:3034)为历史目标函数均值。在粒子搜索的过程中，当个体粒子的路径与
总体目标趋向统一并趋向局部最优化时，则使惯性权重增大，而当个体粒子的路径与总体目

标相对离散时，则使惯性权重变小。同样，对目标函数值高于平均值的个体粒子而言，所对

应的惯性权重也较小，因此保护了该粒子。相反，对目标函数取值差于一般目标函数值的粒

子，其所相应的惯性权重增大，从而导致该粒子向较好的搜寻范围前进。 

粒子群优化算法无法从多个参数中获得最佳的改进策略，选择一个参数进行调优，即给

定一个关于𝜑参数的非线性的递减函数，这样的𝜑在粒子进化的过程中自适应的选取参数值，

从而调整不同时刻的搜索能力。相对于把𝜑看做固定常量来看，收敛能力更好，更加有利于

极限学习机参数优化问题的求解。 

4.3 构建 AWPSO-ROS-ELM 疲劳状态识别模型 

接下来使用带自适应惯性权重的 PSO（Adaptive  Weight  Particle  Swarm  Optimization，

AWPSO）优化算法对正则在线序贯极限学习进行离线优化，将 AWPSO 与 ROS-ELM 模型

的序贯学习能力结合起来，设计泛化性能更好的 AWPSO-ROS-ELM 疲劳状态识别模型。根

据自适应权重粒子群优化算法通过更新速度和替换，在反复迭代后获取最小偏差的权重矩阵，

使优化得到的权重矩阵与偏置矩阵构成极限学习机隐藏层矩阵，从而求解出最优的初始输出

权值。 

在 AWPSO-ROS-ELM 分类算法模型设计中，离线训练阶段通过 AWPSO 算法优化隐藏
层参数的选择过程，获取最优权重矩阵𝐻(cid:2868)与输出偏置𝛽(cid:2868)。选择的所有粒子即由输入权值和
偏置组成，粒子维度为𝐿 ∗ 𝑛 + 𝐿 ∗ 𝑚，𝐿为网络隐藏层结点的数目，𝑛为输入特征向量维数，

𝑚为输出向量维度，构造以 RELM 的输出均方误差为 AWPSO 适应度函数: 

𝐸 = (cid:3496)

∑

(cid:3015)
(cid:3037)(cid:2880)(cid:2869)

(cid:2870)
∑ ||𝛽(cid:3036)𝑔(𝑤(cid:3036) ⋅ 𝑥(cid:3037) + 𝑏(cid:3037)) − 𝑡(cid:3037)||(cid:2870)

(cid:3013)
(cid:3036)(cid:2880)(cid:2869)

𝑁 × 𝑚

(4.41) 

对于给定的疲劳驾驶样本训练集，最终训练过程为： 

Step 1：初始化 AWPSO 参数，设定 RELM 隐藏层节点数为𝐿，随机生成 RELM 的权重

𝑊和偏置𝑏的值； 

Step 2：根据式（4.20）计算 RELM 隐藏层输出权重矩阵𝐻(cid:2868)，根据式（4.22）计算输出

权重𝛽(cid:2868)； 

Step 3：根据式（4.41）计算粒子适应度值，根据式（4.40）更新粒子惯性权重𝜑 ； 

Step 4：根据式（4.39）和式（4.36）更新粒子的搜索位置和运动速度； 

Step 5：迭代 Step 2-Step 4，达到最大收敛次数后得到 RELM 最优输入权重和输入偏置; 

Step 6：当有新样本序贯式加入时，根据式（4.32）和式（4.33）实现第𝑘 + 1步对第𝑘步

的输出权值在线更新； 

37 

杭州电子科技大学硕士学位论文 

Step 7：最终训练得出的输出权值𝛽(cid:3038)(cid:2878)(cid:2869)； 
用选取好的测试集样本对网络进行测试，当输出误差不在设定的范围内时，增加隐藏层

神经元数量并继续训练样本，直到测试误差满足网络模型的训练要求。AWPSO-ROS-ELM

网络模型训练流程如下图 4.6 所示。 

开始

离线样本

最优输入权重W和
输入偏置b 

优化RELM分类模型

AWPSO-ROS-ELM优
化分类模型1

AWPSO-ROS-ELM优
化分类模型2

Y

AWPSO-ROS-ELM优
化分类模型K

结束

随机初始化粒子群
和参数

输入RELM，计算粒
子适应度值

根据适应度更新
Pbest、Qbest

更新粒子速度位置

N

输入RELM，计算粒
子适应度值,更新
惯性权重φ

是否达到最大迭
代次数或者收敛

新增样本1

新增样本2

新增样本k

4.4 实验结果与分析 

图 4.6 AWPSO-ROS-ELM 网络模型训练流程 

本节主要使用疲劳驾驶数据集对设计的 AWPSO-ROS-ELM 模型进行实验验证。首先介

绍仿真实验环境和模型性能评价指标，以及选择合适的参数对实验结果的分析，通过大量的

实验证明基于 AWPSO-ROS-ELM 的疲劳状态识别模型的可行性。 

38 

 
杭州电子科技大学硕士学位论文 

4.4.1 实验环境与性能评价指标 

（1）本地软硬件环境 

本文中所建立的疲劳驾驶数据集数量相对较少，设计的神经网络为前馈网络模型，不需

要用到复杂的深度学习训练环境，进行大规模数值计算。因此，本文设计的疲劳状态分类算

法模型可以在本地 MATLAB 软件中训练测试。具体仿真实验所使用的硬件和软件环境如表

4.1 所示。 

名称 

CPU 

主存 

操作系统 

MATLAB 

表 4.1 实验环境 

版本号/型号 

Inter(R)Core(TM)i5-11400 cpu @2.7GHz 

16G 

Windows 10 

MATLAB R2018b 

（2）性能评价指标 

在多分类模型中，通常以准确率（accuracy）、精确率（precision）、召回率（recall）作

为评价模型优劣的主要性能指标[63]。准确率表示为分类模型正确输出样本数与实际样本数

量的比值，精确率表示为分类模型正确输出样本数与检索样本数量的比值，召回率表示为实

际检索样本数所占总样本数量比率。本文数据集输入为一维特征向量，不存在网络模型无法

检测的问题，此时召回率可以忽略不计，并且有准确率等于精确率，因此对于本文设计的网

络模型以准确率作为性能评判指标。 

4.4.2 实验结果分析 

为体现 AWPSO-ROS-ELM 的改进效果，本小节将使用 AWPSO-ROS-ELM 与 RELM、

ROS-ELM 和 PSO-ROS-ELM 进行训练对比，验证 AWPSO-ROS-ELM 在疲劳状态检测问题

上相较于其他 ELM 的识别准确率与训练时间是否有提高。实验使用包含 800 个样本的疲劳

驾驶数据集进行实验验证，数据集已经过归一化处理。每次实验都从疲劳驾驶数据集中以

7:3 随机选取训练样本和测试样本，为了降低这种随机性对实验的影响，进行 10 次交叉验证，

然后取表现最佳实验结果。 

在极限学习机的训练流程中，调整隐藏神经元个数是其中重要的一环。为使设置的神经

元个数较为合理，实验首先在疲劳驾驶数据集上测试隐藏层神经元个数对 ELM 的影响。初

始选取 ELM 隐藏层神经元个数从 50 开始，然后在此基础上逐渐增加神经元个数到 300，分

析在增加神经元数量时疲劳状态识别效果，共进行 6 次实验。记录每次实验的训练时间、训

练集准确率和测试集准确率，实验结果如表 4.2 所示。 

39 

 
杭州电子科技大学硕士学位论文 

表 4.2 不同神经元数量对 ELM 分类准确率的影响 

隐藏层 

神经元个数 

训练时间（s） 

训练集 

测试集 

准确率（%） 

准确率（%） 

50 

100 

150 

200 

250 

300 

0.0412 

0.0418 

0.0421 

0.0434 

0.0447 

0.0465 

68.04 

69.29 

69.64 

70.35 

69.82 

69.82 

63.75 

64.58 

65.83 

66.25 

65.83 

65.02 

按照表 4.2 所示内容，可以绘制 ELM 算法训练时间与两类数据集疲劳识别准确率随隐

藏层中神经元的递增的关系曲线，如图 4.7 所示。从图 4.7（a）中可以发现模型的训练时间

与神经元数量呈单调递增趋势，说明隐藏层神经元数量过多会造成网络模型训练速率下降。

根据图 4.7（b）中图象变化可以得到当隐藏层神经元个数到达一定数量时，数据集的识别准

确率会趋于稳定，当神经元个数增加到 250 时，明显低于 200 个神经元时识别率，出现隐藏

层神经元个数偏多导致的网络过拟合问题。因此，选择合适的神经元个数对模型的识别效果

有很大的影响。 

0.047

0.046

0.045

0.044

0.043

0.042

0.041

50

100

150

200

250

300

神经元个数

71

70

69

68

67

66

65

64

63

50

训练集
测试集

100

150

200

250

300

神经元个数

（a）模型训练时间关系曲线                                   （b）模型识别准确率关系曲线 

图 4.7 ELM 神经元数量对训练时间和准确率的影响曲线 

接下来本文将利用疲劳驾驶数据集对 RELM、ROS-ELM、PSO-ROS-ELM 和 AWPSO-

ROS-ELM 识别模型分别进行训练测试，经过多次实验对比，将四种极限学习机的正则化因
子𝛾设置为 105。为验证在线学习的优越性，用于训练的数据集将分成 5 份，RELM 进行 5

次样本累计训练，而对于 ROS-ELM、PSO-ROS-ELM 和 AWPSO-ROS-ELM，一份用于离线

学习，剩余 4 份用于在线序贯学习。PSO-ROS-ELM 和 AWPSO-ROS-ELM 识别模型粒子群
种群大小为 10，最大进化次数设为 30，粒子群优化学习权重因子𝑐(cid:2869)和𝑐(cid:2870)都设为 1.5，惯性因
子𝜑初始系设为 1。本文设定三种递增数量的隐藏层节点个数进行对比验证，实验结果如下

40 

 
表 4.3 所示。 

杭州电子科技大学硕士学位论文 

表 4.3 RELM、ROS-ELM、PSO-ROS-ELM 和 AWPSO-ROS-ELM 实验结果对比 

疲劳状态识别模型 

隐藏层 

节点数 

训练时间（s） 

训练集 

测试集 

准确率（%） 

准确率（%） 

RELM 

ROS-ELM 

PSO-ROS-ELM 

AWPSO-ROS-ELM 

50 

100 

200 

50 

100 

200 

50 

100 

200 

50 

100 

200 

0.215932 

0.225835 

0.250996 

0.052446 

0.055222 

0.063675 

0.135803 

0.584069 

0.921182 

0.136819 

0.586660 

0.922567 

76.61 

83.21 

88.39 

76.42 

84.82 

89.64 

78.56 

86.07 

89.35 

80.54 

86.43 

90.18 

74.17 

76.67 

77.08 

74.58 

76.25 

77.5 

75.42 

78.75 

81.67 

76.25 

80.42 

82.92 

从表 4.3 可以发现，随着隐藏层神经元数的增加，RELM、ROS-ELM、PSO-ROS-ELM

以及 AWPSO-ROS-ELM 分类模型在疲劳检测样本中训练集和测试集的识别准确率均在不断

提高。当神经元个数设置 50 个时，AWPSO-ROS-ELM 在识别准确率上达到 76.25%的识别

效果，在测试集上超过另外三个分类模型，也验证 AWPSO 算法对 ROS-ELM 分类模型中隐

藏层参数有显著的优化效果，在降低模型复杂程度的同时增强了整个网络的识别能力。同时

也可以看出 RELM 和 ROS-ELM 在神经元个数为 100 时，识别准确率为 76.5%左右浮动，基

本相似，也说明了在线序贯学习对网络模型的识别率没有明显的提升，但提高了模型的泛化

能力，让模型更健壮。对于重新加入的样本数据，无需重新训练，一定程度上减少模型的训

练时间，有利于对驾驶员的疲劳特征数据做出实时训练。从表中还可以看出，由于加入粒子

群优化算法，PSO-ROS-ELM 和 AWPSO-ROS-ELM 有了迭代优化过程，增加一些训练时间

损耗。总体对比，AWPSO-ROS-ELM 比 PSO-ROS-ELM 识别效果更突出，AWPSO-ROS-

ELM 分类模型在疲劳驾驶测试集上最高取得 82.92%的准确率，相比 ROS-ELM 识别准确率

提升 5.42%，表明自适应权重粒子群算法对 ROS-ELM 提升效果更明显。 

为验证四种分类模型在各个疲劳等级上的分类效果，具体检测效果如下图 4.8 至图 4.19

所示。依次是 50、100 和 200 个神经元时四种模型识别型效果，图中横坐标从小到大表示不

同等级的样本编号，纵坐标表示驾驶员的疲劳标签：1 表示清醒（1 级）状态，2 表示轻度

（2 级）疲劳状态，3 表示中度（3 级）疲劳状态，4 表示重度（4 级）疲劳状态。 

41 

真实类别
RELM预测类别

4

3

2

杭州电子科技大学硕士学位论文 

真实类别
RELM预测类别

4

3

2

1

0

50

100
150
测试集样本编号

200

250

1

0

50

100
150
测试集样本编号

200

250

图 4.8 RELM（50）识别效果                                     图 4.9 RELM（100）识别效果 

真实类别
RELM预测类别

4

3

2

1

0

50

100
150
测试集样本编号

200

250

图 4.10 RELM（200）识别效果                                  图 4.11 ROS-ELM（50）识别效果 

真实类别
ROS-ELM预测类别

4

3

2

级
等
劳
疲

1

0

50

100
150
测试集样本编号

200

250

图 4.12 ROS-ELM（100）识别效果                              图 4.13 ROS-ELM（200）识别效果 

42 

 
 
 
 
真实类别
PSO-ROS-ELM预测类别

4

3

2

杭州电子科技大学硕士学位论文 

真实类别
PSO-ROS-ELM预测类别

4

3

2

1

0

50

100
150
测试集样本编号

200

250

1

0

50

100
150
测试集样本编号

200

250

图 4.14 PSO-ROS-ELM（50）识别效果                      图 4.15 PSO-ROS-ELM（100）识别效果 

真实类别
PSO-ROS-ELM预测类别

4

3

2

真实类别
AWPSO-ROS-ELM预测类别

4

3

2

级
等
劳
疲

1

0

50

100
150
测试集样本编号

200

250

1

0

50

100
150
测试集样本编号

200

250

图 4.16 PSO-ROS-ELM（200）识别效果                    图 4.17 AWPSO-ROS-ELM（50）识别效果 

真实类别
AWPSO-ROS-ELM预测类别

4

3

2

级
等
劳
疲

1

0

50

100
150
测试集样本编号

200

250

图 4.18 AWPSO-ROS-ELM（100）识别效果              图 4.19 AWPSO-ROS-ELM（200）识别效果 

从图 4.8 至图 4.19 中大概能够发现，在本文所采集的疲劳驾驶测试集样本中，无论神经

元的个数为 50，100 还是 200，同其它三种模型相比，AWPSO-ROS-ELM 模型的预测疲劳

状态与真实疲劳状态重合的样本个数更多，具有更好的疲劳状态检测效果。然而，可以看出

43 

 
 
 
 
杭州电子科技大学硕士学位论文 

四种分类模型的预测输出与实际输出有大量样本不完全重合，出现较大的误差。其中较多样

本预测结果出现在相邻疲劳类别，从而影响整个模型的识别准确率。 

为更好地分析四种改进 ELM 算法对各种疲劳状态的识别效果，下图 4.20 给出了四种分

类模型在神经元数量设定为 200 时对四种疲劳程度的识别准确率。可以得出四种模型在不同

疲劳状态的识别准确率均到达 75%，AWPSO-ROS-ELM 优势明显，对中度疲劳状态的识别

AWPSO-ROS-ELM 略低于 PSO-ROS-ELM。其中，加入序贯学习的 ROS-ELM 模型、PSO-

ROS-ELM 模型和 AWPSO-ROS-ELM 模型对单个疲劳状态的识别率偏差较大，也说明整个

模型的分类效果鲁棒性不强，仍有很大的优化空间。分析原因主要是疲劳特征数据存在个体

的差异性，在两种不同疲劳程度之间没有明显界限，大量的特征样本都是呈冗杂重叠分布。

并且在轻度疲劳和中度疲劳上行为表现相差微小，疲劳识别模型很难处理，导致标签分类过

拟合，影响模型最终识别准确率。 

100

95

90

85

80

75

70

65

60

55

50

RELM
ROS-ELM
PSO-ROS-ELM
AWPSO-ROS-ELM

清醒状态

轻度疲劳

中度疲劳

重度疲劳

图 4.20 四种分类模型不同疲劳状态识别效果 

疲劳状态

4.5 本章小结 

本章主要设计了一种用于疲劳状态检测分类算法模型，并进行实验验证。首先介绍了

ELM 理论，针对 ELM 模型无法在线更新、容易过拟合的问题，引入 ROS-ELM 分类模型。

但传统极限学习机网络存在参数随机选取、模型泛化能力弱，因此引入自适应权重粒子群算

法优化 ROS-ELM，完成了  AWPSO-ROS-ELM 分类模型的设计。通过实验验证了 AWPSO-

ROS-ELM 模型取得了 82.92%的准确率，识别效果有明显提升，但特征数据存在的问题导致

识别效果依旧不理想。 

44 

 
杭州电子科技大学硕士学位论文 

第 5 章 基于多源特征融合的驾驶员疲劳状态检测 

本文通过多普勒雷达和 Dlib 人脸特征识别采集驾驶员在模拟驾驶过程中的信息，并对

采集的信息进行有效处理，提取用于疲劳驾驶检测的生理信号特征和面部动态特征，建立疲

劳驾驶数据集。为对数据进行分析得出驾驶员疲劳程度，上一章设计了 AWPSO-ROS-ELM

疲劳状态识别模型，实验分析发现仍有很大改进空间。本章将针对特征数据存在的问题，进

行特征处理，建立新的疲劳状态特征数据，最后进行实验验证模型的识别效果。 

5.1 多源特征融合 

多信息源疲劳特征提取一定程度上克服了单一信息源的局限性，能实现各信息源的优势

互补。但不同信号源之间的特征存在信息冗杂重复或者信息无效，以及同一信息源之间的特

征存在个体的差异性，这些都直接影响到识别精度和增加算法的计算耗时。为了减少这些干

扰，接下来将引入一种信息融合技术。 

5.1.1 信息融合理论 

信息融合是指对多个同类或者异类的信息进行数据校准、特征变换以及决策仲裁的综合

处理过程，经过处理的目标数据比单一信息更加可靠、稳定。信息融合与人类对外界环境感

知类似，人类通过嗅觉、视觉、听觉等多种感官获取外界信息，然后大脑对这些混合信息综

合分析，最终对外界环境做出判断，信息融合就是对混合信息综合分析并进行最终决策[64]。

根据信息融合的处理过程主要有三个层次：数据层融合、特征层融合和决策层融合。 

数据层融合是将多种信息物理信息接近以及维度相同的原始数据开展底层融合，如图

5.1 所示，融合过程发生在数据采集时，融合的前提比较苛刻，需要保证数据源信息的同构

性。数据层的融合虽然保留了原有信息内容的完整性，但它所需要处理的数据信息量却很多，

容易导致数据拥塞，实时性差。 

信息源1

信息源2








信息源n

数据
配准

数据
关联

数据
融合

特征
提取

决策

特征层融合发生在原始数据预处理和特征提取之后，对每个信息源的特征进行融合，从

而得到所需要的目标信息。如图 5.2 所示，特征层融合最关键的地方在于融合前对采集的数

图 5.1 数据层融合 

45 

 
 
杭州电子科技大学硕士学位论文 

据的进行特征提取，对特征信息进行融合，这样使数据量大幅度地减少，消除特征数据重叠

效应，提高了目标信息的有效性和实时性。 

信息源1

特征提取

信息源2

特征提取








信息源n

特征提取

图 5.2 特征层融合 

特征
融合

决策

决策层融合是指将单一信息预测的结果进行融合处理，得到最终目标决策。如图 5.3 所

示，在对单一信源数据进行预处理和特征提取后，得到单一的局部决策结果，然后将局部结

果进行关联融合，获得决策层的融合结果。这种融合方式相对简单，数据量也最小，但适用

于模糊推理和结果突出较小的场景。 

信息源1

特征提取

信息源2

特征提取

决策

决策








信息源n

特征提取

决策

图 5.3 决策层融合 

决策
关联

决策
融合

最终
决策

本文以多普勒雷达采集生理信息和 Dlib 采集的面部动态信息作为疲劳驾驶检测的多类

信息源，对检测结果的准确性和实时性要求较高。其中驾驶员的生理信息和面部动态信息具

有互补的特点，属于明显的异构信息。对于这种特性的多源异构信息，将选择从特征融合这

个层次展开。 

5.1.2 LDA 特征融合技术 

线性判别分析（Linear Discriminant Analysis，LDA）是一种特征处理技术，常用于监督

学习，由 Fisher 提出，所以也称 Fisher’s Linear Discriminant。LDA 一般用作在特征变换阶段

的降维融合处理中，其目标是把特征投影到更低维空间来减少高维度数据冗杂所引起的过拟

合，并且还保持良好的可分性。而 LDA 的基本原理就是找到并最大化了一个函数，这种函

数可以把类内均值的投影范围分割得很大，并且使各个类型内部的方差贡献率都较小，这样

简化了类内的重叠问题[65]。 

对于给定的两类可分的𝑚个𝑛维数据集{(𝑥(cid:3036), 𝑦(cid:3036)), 𝑖 = 1,2, … , 𝑚}，其中𝑦(cid:3036) ∈ {1,2}表示分类
类别，定义𝑁(cid:3037)为第𝑗类样本个数，𝑋(cid:3037)为第𝑗类的样本特征，𝑗 = 1,2，那么两类样本数据的中心

46 

 
 
 
 
即均值向量为： 

杭州电子科技大学硕士学位论文 

𝜇(cid:3037) =

1
𝑁(cid:3037)

(cid:3533) 𝑥

(cid:3051)∈(cid:3025)(cid:3285)

则第𝑗类样本的协方差矩阵∑(cid:3037)为： 

(cid:2870)

∑(cid:3037) = (cid:3533) (cid:3435)𝑥−𝜇(cid:3037)(cid:3439)
(cid:3051)∈(cid:3025)(cid:3285)

= (cid:3533) (cid:3435)𝑥 − 𝜇(cid:3037)(cid:3439)(cid:3435)𝑥 − 𝜇(cid:3037)(cid:3439)

(cid:3021)

(cid:3051)∈(cid:3025)(cid:3285)

(5.1) 

(5.2) 

由于二维平面的投影是一条直线，为了保证投影的中心距离尽可能的大，也就是最大化

两类样本均值向量的投影距离,便于计算这里取𝐺(𝑟)： 

𝐺(𝑤) = ‖𝑟(cid:3021)𝜇(cid:2869) − 𝑟(cid:3021)𝜇(cid:2870)‖(cid:2870) = 𝑟(cid:3021)(𝜇(cid:2869) − 𝜇(cid:2870))(𝜇(cid:2869) − 𝜇(cid:2870))(cid:3021)𝑟

(5.3) 

其中，𝑟为投影直线，𝑟(cid:3021)𝜇(cid:2869)与𝑟(cid:3021)𝜇(cid:2870)为𝜇(cid:2869)、𝜇(cid:2870)在投影直线上𝑟的投影，对于任意一个样本𝑥(cid:3036)，它
在直线𝑟上的投影为𝑟(cid:3021)𝑥(cid:3036)。因此，第𝑗类样本投影后的协方差Σ(𝑟)为： 

Σ(cid:3037)(𝑟) = (cid:3533) (cid:3435)𝑟(cid:3021)𝑥−𝑟(cid:3021)𝜇(cid:3037)(cid:3439)

(cid:2870)

= (cid:3533) 𝑟(cid:3021)(cid:3435)𝑥 − 𝜇(cid:3037)(cid:3439)(cid:3435)𝑥 − 𝜇(cid:3037)(cid:3439)

(cid:3021)

𝑟

(cid:3051)∈(cid:3025)(cid:3285)

(cid:3051)∈(cid:3025)(cid:3285)

(5.4) 

那么投影后类内方差为： 

Σ(𝑟) = Σ(cid:2869)(𝑟) + Σ(cid:2870)(𝑟) = (cid:3533) 𝑟(cid:3021)(𝑥 − 𝜇(cid:2869))(𝑥 − 𝜇(cid:2869))(cid:3021)𝑟
(cid:3051)∈(cid:3025)(cid:3117)

+ (cid:3533) 𝑟(cid:3021)(𝑥 − 𝜇(cid:2870))(𝑥 − 𝜇(cid:2870))(cid:3021)𝑟

(5.5) 

(cid:3051)∈(cid:3025)(cid:3118)

同时要求同一种类别的样本投影之间尽可能接近，即同类样本投影的协方差最小化。根

据 Fisher 准则，定义类间距离与类内协方差的比值为优化目标： 

𝐽(𝑟) =

𝐺(𝑟)
Σ(𝑟)

=

∑

(cid:3051)∈(cid:3025)(cid:3117)

𝑟(cid:3021)(𝑥 − 𝜇(cid:2869))(𝑥 − 𝜇(cid:2869))(cid:3021)𝑟

𝑟(cid:3021)(𝜇(cid:2868) − 𝜇(cid:2869))(𝜇(cid:2868) − 𝜇(cid:2869))(cid:3021)𝑟
+ ∑

(cid:3051)∈(cid:3025)(cid:3118)

𝑟(cid:3021)(𝑥 − 𝜇(cid:2870))(𝑥 − 𝜇(cid:2870))(cid:3021)𝑟

可以写成： 

𝐽(𝑟) =

𝑟(cid:3021)(𝜇(cid:2868) − 𝜇(cid:2869))(𝜇(cid:2868) − 𝜇(cid:2869))(cid:3021)𝑟

𝑟(cid:3021)(cid:3435)∑

(cid:3051)∈(cid:3025)(cid:3117)

(𝑥 − 𝜇(cid:2869))(𝑥 − 𝜇(cid:2869))(cid:3021)

+ ∑

(cid:3051)∈(cid:3025)(cid:3118)

(𝑥 − 𝜇(cid:2870))(𝑥 − 𝜇(cid:2870))(cid:3021)

(cid:3439)𝑟

一般定义类间散度矩阵𝑆(cid:3029)，形式为： 

𝑆(cid:3029) = (𝜇(cid:2868) − 𝜇(cid:2869))(𝜇(cid:2868) − 𝜇(cid:2869))(cid:3021)

定义类内散度矩阵𝑆(cid:3045)，形式为： 

𝑆(cid:3045) = (cid:3533) (𝑥 − 𝜇(cid:2869))(𝑥 − 𝜇(cid:2869))(cid:3021)

+ (cid:3533) (𝑥 − 𝜇(cid:2870))(𝑥 − 𝜇(cid:2870))(cid:3021)

(cid:3051)∈(cid:3025)(cid:3117)

(cid:3051)∈(cid:3025)(cid:3118)

因此，𝐽(𝑟)可以被简写为： 

𝐽(𝑟) =

𝑟(cid:3021)𝑆(cid:3029)𝑟
𝑟(cid:3021)𝑆(cid:3045)𝑟

47 

(5.6) 

(5.7) 

(5.8) 

(5.9) 

(5.10) 

杭州电子科技大学硕士学位论文 

要使投影直线最佳，则𝐽(𝑟)的取值应最大化。由于𝑟对进行增大，𝐽(𝑟)可以任意增大，通

过引入 Lagrange 乘子法将最值问题转化为对偶问题，具体表示如下： 

约束条件为： 

然后求解有： 

𝑚𝑎𝑥𝐺(𝑟) = 𝑟(cid:3021)𝑆(cid:3029)𝑟

𝑠. 𝑡.   𝑟(cid:3021)𝑆(cid:3045)𝑟 = 1

𝐿(𝑟, 𝜆) = −𝑟(cid:3021)𝑆(cid:3029)𝑟 + 𝜆(𝑟(cid:3021)𝑆(cid:3045)𝑟 − 1)

其中，𝜆为 Lagrange 系数，对𝐿(𝑟, 𝜆)求导并令其导数为 0： 

𝜕(cid:3045)𝐿(𝑟, 𝜆) = −2𝑆(cid:3029)𝑟 + 2𝜆𝑆(cid:3045)𝑟 = 0

可以得到： 

𝑆(cid:3045)

(cid:2879)(cid:2869)𝑆(cid:3029)𝑟 = 𝜆𝑟

(5.11) 

(5.12) 

(5.13) 

(5.14) 

(5.15) 

对矩阵𝑆(cid:3045)

(cid:2879)(cid:2869)𝑆(cid:3029)进行特征值分解，可以得到最大特征值对应的特征向量𝑟，求得最优投影

直线。因此，对于两类样本特征𝑋(cid:3036)的进行 LDA 融合结果可以表示为： 

𝑍(cid:3037) = 𝑟(cid:3021)𝑋(cid:3037)

(5.16) 

在二维特征空间中，有两类样本红色和蓝色，将其投影到一条直线上，为使投影的样本

尽可能的区分度，会有两种投影处理。如图 5.4 所示，图 5.4（a）中将不同类型的特征数据

在某一方向上投影，两类数据投影点之间有交集，而图 5.4（b）使用 LDA 思想到达了对两

类数据尽可能分离的效果，融合后的特征样本可以有效的解决不同类别数据冗杂重叠问题。 

（a）一般特征融合                                              （b）LDA 特征融合 

图 5.4 特征融合效果图 

LDA 在多维空间搜索最佳区分类的空间向量与二分类特征融合类似，假设有数据集𝐷 =
{(𝑥(cid:2869), 𝑦(cid:2869)), (𝑥(cid:2870), 𝑦(cid:2870)), … , (𝑥(cid:3040), 𝑦(cid:3040))}，其中任意样本𝑥(cid:3036)为 n 维特征向量，𝑦(cid:3036) ∈ {𝐶(cid:2869), 𝐶(cid:2870), … , 𝐶(cid:3038)}。定义
𝑁(cid:3037)(𝑗 = 1,2, … , 𝑘) 为 第 𝑗 类 样 本 的 个 数 ， 𝑋(cid:3037)(𝑗 = 1,2, … , 𝑘) 为 第 𝑗 类 样 本 的 集 合 ， 而 𝜇(cid:3037)(𝑗 =
1,2, … , 𝑘)为第𝑗类样本的均值向量。 

48 

 
杭州电子科技大学硕士学位论文 

由于多类别特征向低维投影是一个超平面，假设投影到低维空间维度为𝑑，对应的基向
量为(𝑟(cid:2869), 𝑟(cid:2870), … , 𝑟(cid:3031))，基向量组成一个𝑛 × 𝑑的𝑅矩阵，即所求的超平面投影。在多分类问题中，
类内散度矩阵依然存在，定义与之前保持不变，即𝑆(cid:3019)为： 

(cid:3038)
𝑆(cid:3019) = (cid:3533) 𝑆(cid:3045)(cid:3037)
(cid:3037)(cid:2880)(cid:2869)

(cid:3038)

= (cid:3533) (cid:3533) (cid:3435)𝑥 − 𝜇(cid:3037)(cid:3439)(cid:3435)𝑥 − 𝜇(cid:3037)(cid:3439)

(cid:3021)

(cid:3037)(cid:2880)(cid:2869)

(cid:3051)∈(cid:3025)(cid:3285)

定义全局散度矩阵𝑆(cid:3047)，形式为： 

(cid:3041)

𝑆(cid:3047) = (cid:3533)(𝑥(cid:3036) − 𝜇)

(𝑥(cid:3036) − 𝜇)(cid:3021)

(cid:3036)(cid:2880)(cid:2869)

其中，𝜇表示所有样本数据的均值向量，计算公式如下： 

𝜇 =

1
𝑛

(cid:3038)
(cid:3533) 𝑁(cid:3037)𝜇(cid:3037)
(cid:3037)(cid:2880)(cid:2869)

根据𝑥(cid:3036)对应的类别，式（5.18）可以写成: 

(cid:3038)

𝑆(cid:3047) = (cid:3533) (cid:3533) (𝑥 − 𝜇)(𝑥 − 𝜇)(cid:3021)

(cid:3037)(cid:2880)(cid:2869)

(cid:3051)∈(cid:3025)(cid:3285)

(5.17) 

(5.18) 

(5.19) 

(5.20) 

全局散度矩阵为类内散度矩阵与类间散度矩阵的和，即𝑆(cid:3047) = 𝑆(cid:3003) + 𝑆(cid:3019) ，其数学意义就是
定义各个类别到全局中心之间的距离，而为使各类别之间足够分散，就必须让各个类别的样

本经过再投影之后，离全局中心足够远。因此有𝑆(cid:3003) = 𝑆(cid:3047) − 𝑆(cid:3019)，可以得到： 
(cid:3038)

𝑆(cid:3003) = (cid:3533) 𝑁(cid:3037)(cid:3435)𝜇(cid:3037) − 𝜇(cid:3439)

(cid:3435)𝜇(cid:3037) − 𝜇(cid:3439)

(cid:3021)

(cid:3037)(cid:2880)(cid:2869)

那么根据 LDA 的思想，求解最佳投影矩阵𝐽(𝑅)的问题为： 

𝐽(𝑅) = (cid:3537)

(cid:3031)

(cid:3036)(cid:2880)(cid:2869)

𝑟(cid:3036)
𝑟(cid:3036)

(cid:3021)𝑆(cid:3003)𝑟(cid:3036)
(cid:3021)𝑆(cid:3019)𝑟(cid:3036)

=

(cid:3031)
∏ 𝑟(cid:3036)
(cid:3036)(cid:2880)(cid:2869)
(cid:3031)
∏ 𝑟(cid:3036)
(cid:3036)(cid:2880)(cid:2869)

(cid:3021)𝑆(cid:3003)𝑟(cid:3036)
(cid:3021)𝑆(cid:3019)𝑟(cid:3036)

=

𝑡𝑟(cid:4670)𝑅(cid:3021)𝑆(cid:3003)𝑅(cid:4671)
𝑡𝑟(cid:4670)𝑅(cid:3021)𝑆(cid:3019)𝑅(cid:4671)

(5.21) 

(5.22) 

其中，𝑡𝑟(cid:4670)∙(cid:4671)表示矩阵的主对角线元素乘积，引入 Lagrange 乘子法求解对偶问题，限制向量
𝑅(cid:3021)𝑆(cid:3019)𝑅为单位向量𝐼，可以表示为： 

𝐿(𝑅, Λ) = −𝑡𝑟(cid:4670)𝑅(cid:3021)𝑆(cid:3003)𝑅(cid:4671) + 𝑡𝑟(cid:4670)Λ(cid:3021)(𝑅(cid:3021)𝑆(cid:3019)𝑅 − 𝐼)(cid:4671)

Λ为 Lagrange 系数，𝐿(𝑅, Λ)求导后令其为 0，得到了： 

𝜕(cid:3019)𝐿(𝑅, Λ) = −2𝑆(cid:3029)𝑅 + 2𝑆(cid:3019)𝑅Λ = 0

然后有： 

𝑆(cid:3019)

(cid:2879)(cid:2869)𝑆(cid:3003)𝑅 = 𝑅Λ

(5.23) 

(5.24) 

(5.25) 

因此，通过求解矩阵𝑆(cid:3019)

(cid:2879)(cid:2869)𝑆(cid:3003)的𝑑个最大的广义特征值，得出超平面𝑅为对应特征向量组

49 

杭州电子科技大学硕士学位论文 

成的矩阵。将𝑅看成一个投影矩阵，那么实际上就是将原来的特征空间投影到了𝑑维空间中，

最终实现了多特征融合的效果。算法步骤如下图 5.5 所示，首先输入数据特征，计算类间散

度矩阵与类内散度矩阵的积。然后计算类内散度矩阵的逆与类间散度矩阵的积，通过式

（5.22）计算最优投影矩阵𝐽(𝑅)，得到最大𝐾个特征值对应特征向量，构成超平面𝑅。最后

对特征矩阵进行投影，得到融合的特征数据。 

输入
特征
样本
X

计算
SB,SR
计算

(SR

-1)SB

计算J(R)
得到投影面R

特征
变换
Zi=RTXi

特征
融合
样本Z

5.2 构建多源特征融合的疲劳状态识别模型 

图 5.5 LDA 特征融合步骤 

本文在第四章设计了基于 AWPSO-ROS-ELM 的疲劳状态检测模型，发现疲劳驾驶数据

集存在个体的差异性导致分类模型对于不同疲劳等级识别没有明显界限，不同等级的特征数

据都是冗杂重叠在一起，导致最终的识别准确率较低。接下来将使用 LDA 特征融合技术对

原始数据集样本进行特征处理，构建多源特征融合的疲劳状态检测模型。本文使用 LDA 的

目标是对疲劳驾驶数据集进行的特征融合，在满足 LDA 类内类间方差原理基础上，找到多

维样本数据的最佳投影方向，改善多源特征数据存在信息重叠和信息无效的问题。从而减少

信息冗杂度，提高疲劳状态分类模型的准确性。 

开始

多信息源疲劳特征

生理信号特征

面部动态特征

LDA特征融合

AWPSO-ROS-ELM模型训练

AWPSO-ROS-ELM模型测试

结束

图 5.6 基于多源特征融合的疲劳状态识别流程 

50 

 
 
杭州电子科技大学硕士学位论文 

如上图 5.6 展示了基于多源特征融合的疲劳状态等级识别流程。针对本文疲劳驾驶数据

集特点，结合 LDA 特征融合技术，设计多源特征融合的 AWPSO-ROS-ELM 疲劳状态识别

模型，具体步骤如下： 

Step 1：输入疲劳数据集样本𝑋; 

Step 2：计算类间散度矩阵与类内散度矩阵的积; 

Step 3：计算类内散度矩阵的逆与类间散度矩阵的积; 

Step 4：通过式（5.22）和式（5.25）计算最优投影矩阵𝐽(𝑅)，得到最大𝐾个特征值对应

特征向量构成超平面𝑅; 

Step 5：特征数据转化新样本𝑍(cid:3036) = 𝑅(cid:3021)𝑋(cid:3036)，完成特征融合; 
Step 6：使用训练样本进行 AWPAO-ROS-ELM 训练，训练过程如图 4.6 所示； 

Step 7：AWPAO-ROS-ELM 进行疲劳状态等级测试，判定结果。 

5.3 实验结果与分析 

本节主要使用疲劳驾驶数据集对设计的多源特征融合疲劳状态识别方法进行实验验证。

首先介绍实验的比较模型，通过大量实验与当前流行  的疲劳状态识别算法进行比较，证明

多源特征融合的优越性以及 AWPAO-ROS-ELM 在多源特征融合下的最佳识别效果。 

5.3.1 比较模型 

针对疲劳驾驶样本数据集的特点，本实验将与代表性的 SVM 和 BPNN 进行比较，这两

种分类算法充分利用自身分类模型的优势，在疲劳驾驶检测领域取得了满意的应用效果。 

SVM 多用于解决二分类的问题，属于监督学习算法的一种。SVM 的目标是利用超平面

分割原理，以间隔最大化寻找一个最佳超平面，然后对数据样本加以分类，从而使样本数据

分类更准确。对于多分类问题，采用核映射的方法，使用高维空间线性可分的特征结构，把

低维非线性数据特征映射到高维区域，最终通过多个 SVM 组合的形式解决多分类。 

BPNN 是一种前馈神经网络模型，主要研究前馈神经网络学习训练的误差后向传播过程，

以解决在隐含层中连接权值的调整问题，获得输出与预想结果匹配的模型。把训练过程分成

正向计算和误差反向传播两个步骤，在误差反向传播时不断地修正权值来最小化均方误差。

对于每个样本数据，都需要进行多次正向计算和反向传播计算，以获得合适的权值和阈值来

拟合样本中输入和输出的非线性关系。 

5.3.2 实验结果分析 

为了证明特征融合后的疲劳状态识别效果，本小节将使用 AWPSO-ROS-ELM 与 SVM

和 BPNN 进行训练对比，并验证 AWPSO-ROS-ELM 在疲劳状态检测问题上相较于两种传统

分类算法的识别优势。其中 SVM 和 BPNN 是已经应用于疲劳状态识别的分类算法，很多文

献有所涉及，具体原理本文不再赘述。 

51 

杭州电子科技大学硕士学位论文 

接下来将前文所建立疲劳驾驶数据样本和实验环境在 LDA 特征融合前后依次输入 SVM、

BPNN 以及 AWPSO-ROS-ELM 网络模型中进行训练，然后在测试集上进行测试。在实验中，

经过进行多次试验和比较，选择合适的模型参数。SVM 选择 sigmoid 核函数作为核映射方法，

惩罚因子设置为 1。BPNN 中学习率设为 0.3，动量梯度下降因子设为 0.9，训练迭代次数为
10000 次。AWPSO-ROS-ELM 中正则化因子𝛾设为 105，粒子数量设为 10，学习权重因子𝑐(cid:2869)
和𝑐(cid:2870)都设为 1.5，初始惯性因子𝜑设为 1。BPNN 模型和 AWPSO-ROS-ELM 模型神经元个数
都设为 200。三种模型经过训练集和测试集在特征融合前后表现最好的识别效果如表 5.1 所

示。 

表 5.1 三种分类模型在特征融合前后实验对比 

疲劳状态识别模型 

SVM 

SVM（LDA） 

BPNN 

BPNN（LDA） 

AWPSO-ROS-ELM 

AWPSO-ROS-ELM（LDA） 

训练时间

训练集 

测试集 

（s） 

准确率（%） 

准确率（%） 

1.068840 

1.065989 

43.236694 

43.234525 

0.922567 

0.920183 

87.36 

94.22 

88.39 

96.96 

90.18 

97.14 

76.25 

89.17 

80.41 

93.75 

82.92 

95.42 

从表 5.1 可以看出，三种模型都在 60s 以内完成了模型的训练，其中 BPNN 分类模型时

间消耗最长，达到 43s。BPNN 的识别结果优于 SVM，测试准确率达到 93.75%，但需要大

量的迭代学习时间才能使网络收敛，造成时间和效率的损失。SVM 模型由于对多分类问题

需要采用核函数映射构建多个分类器，与本文设计的 AWPSO-ROS-ELM 模型都保持在 1s 左

右。SVM 是传统机器学习分类器，在多分类识别效果上与其他两种神经网络模型相差较大，

最终对测试集的识别准确率偏低，只有 89.17%，与特征融合后的 AWPSO-ROS-ELM 相差

6.25%。然后从表 5.1 也可以得知，三种模型在特征融合后识别准确率均优于原始特征，总

体识别效果有明显改善，相比 SVM 模型和 BPNN 模型，AWPSO-ROS-ELM 提升效果最明

显。特别地，特征融合后的 AWPSO-ROS-ELM 模型识别效果达到了 95.42%，从而也验证本

文所设计的多源特征融合的疲劳状态识别方法优越性。说明 AWPSO-ROS-ELM 在特征融合

后保持高效训练的同时，依旧保持着最高的识别准确率。 

为了体现三种分类模型在各个疲劳等级上的分类效果，在测试集样本上具体检测效果如

下图 5.7 至图 5.12 所示，图中横坐标从小到大表示不同等级的样本编号，纵坐标表示驾驶员

的疲劳标签：1 表示清醒（1 级）状态，2 表示轻度（2 级）疲劳状态，3 表示中度（3 级）

疲劳状态，4 表示重度（4 级）疲劳状态。  

52 

真实类别
SVM预测类别

4

3

2

杭州电子科技大学硕士学位论文 

真实类别
SVM预测类别

4

3

2

1

0

50

100
150
测试集样本编号

200

250

1

0

50

100
150
测试集样本编号

200

250

图 5.7 SVM 识别效果                                            图 5.8 SVM（LDA）识别效果 

真实类别
BPNN预测类别

4

3

2

真实类别
BPNN预测类别

4

3

2

1

0

50

100
150
测试集样本编号

200

250

1

0

50

100
150
测试集样本编号

200

250

图 5.9 BPNN 识别效果                                         图 5.10 BPNN（LDA）识别效果 

真实类别
AWPSO-ROS-ELM预测类别

4

3

2

真实类别
AWPSO-ROS-ELM预测类别

4

3

2

1

0

50

100
150
测试集样本编号

200

250

1

0

50

100
150
测试集样本编号

200

250

图 5.11 AWPSO-ROS-ELM 识别效果                      图 5.12 AWPSO-ROS-ELM（LDA）识别效果 

可以看出，三种分类模型在疲劳等级上的识别效果有些相似，在特征融合前后对每疲劳

等级的识别相差较大。AWPSO-ROS-ELM 模型的预测类别与实际类别重合的样本数量比另

外两种模型更多，表明本文所设计模型的识别准确率更高。并且可以发现同一分类模型在特

征融合后都有着比较好的识别分类效果，体现了疲劳驾驶数据集在 LDA 特征融合融合后检

53 

 
 
 
 
杭州电子科技大学硕士学位论文 

测效果更佳。表明使用 LDA 方法对疲劳驾驶数据集进行的特征融合后，在满足 LDA 类内

类间方差最小原则后，找到疲劳驾驶多维样本数据的最佳投影方向，减少了多源特征存在信

息交叉现象，提高了疲劳状态分类模型的准确性。为了更清晰直观地观察特征融合前后不同

疲劳状态等级的识别效果，本文选择 AWPSO-ROS-ELM 为代表模型，给出每个疲劳等级检

测准确率，如下表 5.2 所示。 

表 5.2 AWPSO-ROS-ELM 在特征融合前后不同疲劳状态识别效果 

疲劳状态等级 

清醒状态（1 级） 

轻度疲劳（2 级） 

中度疲劳（3 级） 

重度疲劳（4 级） 

原始 

多源特征融合 

准确率（%） 

准确率（%） 

81.67 

88.33 

83.33 

78.33 

96.67 

95 

91.67 

98.33 

从上表 5.2 可以看出，在清醒状态和重度疲劳状态的识别率上，原始数据集表现的准确

率远落后与经过特征融合后的识别准确率。分析原因，主要由于模拟驾驶的过程中，Dlib 面

部动态特征提取对这两种状态会因不同检测人群表现特征差异性，也就是出现混叠现象更严

重，说明对原始疲劳特征进行映射处理尤为重要。在其他模拟驾驶员疲劳状态上，多源特征

融合识别以 95%和 91.67%也胜于原始不经过数据融合处理的数据集。整体疲劳状态的识别

多源特征融合也更有明显优势，多源特征融合后的识别精度平均提升了 13.5%，优于融合之

前的数据集表现，不同程度地改善了每个疲劳状态的识别率。说明特征融合后让疲劳检测特

征数据集更优，对检测结果有一定的增益。 

接下来为了分析 AWPSO-ROS-ELM 与 SVM、BPNN 在每个疲劳等级的识别情况，如下

图 5.13 给出三种分类模型在特征融合后不同疲劳状态识别效果。可以看出 BPNN 和

AWPSO-ROS-ELM 在清醒状态、轻度疲劳状态与重度疲劳状态的识别准确率接近，且都高

于 SVM 模型，在中度疲劳状态识别上 AWPSO-ROS-ELM 最高，说明两种前馈神经网络模

型在单个疲劳状态识别也有着不错的识别效果。但在中度疲劳状态识别上，三种模型识别效

果与其他状态偏差较大，很大原因是进行疲劳等级评判时对这一状态标签判定制约了模型分

类准确性，后续可对驾驶员的疲劳状态做出多次筛选，得到有效的等级评判。总体而言，

SVM 在识别准确率上劣于其他两种分类模型，AWPSO-ROS-ELM 模型在每个状态识别上都

超 过 90% ， 都 有 着 非 常 好 的 识 别 效 果 ， 是 三 种 分 类 算 法 中 表 现 最 佳 的 ， 同 时 也 表 明

AWPSO-ROS-ELM 在所设计的检测方法中具有最优的疲劳状态识别率。鉴于本文数据集样

本数量有限，未来可以采集更多的特征数据，在大样本训练后测试效果会更精确，最终训练

的疲劳状态识别模型的泛化能力和鲁棒性也将会更强大。 

54 

100

98

96

94

92

90

88

86

84

82

80

杭州电子科技大学硕士学位论文 

SVM
BPNN
AWPSO-ROS-ELM

清醒状态

轻度疲劳

中度疲劳

重度疲劳

图 5.13 三种分类模型在特征融合后不同疲劳状态识别效果 

疲劳状态

5.4 本章小结 

本章首先针对疲劳驾驶数据集进行特征融合，在得到新的特征数据后设计实验验证。然

后通过与两种流行的分类算法进行特征融合前后对比，特征融合后 AWPSO-ROS-ELM 识别

准确率提升了 13.5%，到达了 95.42%。证明多源特征融合对疲劳状态分类的有益提升，同

时验证了 AWPSO-ROS-ELM 分类模型在本文设计的检测方法中具有最佳识别效果，能有效

地对驾驶员的疲劳等级进行判别。 

55 

 
 
杭州电子科技大学硕士学位论文 

第 6 章 总结与展望 

驾驶员的疲劳状态极易受到自身身心影响和外部环境干扰，给疲劳驾驶检测的可靠性和

实时性等方面带了诸多问题。本文通过疲劳驾驶检测技术国内外研究动态分析，研究非接触

式多源特征融合的检测方法。首先在模拟驾驶仿真平台上搭建非接触式疲劳驾驶数据采集系

统，从驾驶员生理信息和面部动态信息中提取疲劳特征，根据疲劳驾驶等级评判机制建立疲

劳驾驶数据集。然后在 ROS-ELM 分类模型上进行改进优化，构建自适应粒子群优化算法优

化在线序贯极限学习机分类模型，用于检测疲劳驾驶程度的分类模型。最后针对特征数据交

叉重叠的问题，引入 LDA 特征融合技术，得到疲劳状态识别最优分类模型。 

6.1 工作总结及创新点 

本文研究一种非接触式多源特征融合的疲劳驾驶检测方法，主要包括疲劳驾驶数据采集、

疲劳特征提取和疲劳状态识别模型设计三个部分，具体研究内容如下： 

（1）疲劳驾驶数据采集：主要搭建疲劳驾驶仿真实验平台，最大程度还原真实驾驶环

境，最后给出详细的疲劳信息采集流程，保证采集数据真实有效。设计非接触式数据采集系

统，在模拟驾驶过程利用多普勒雷达采集模块获取人体生理信息，并通过 Dlib 人脸特征识

别采集人脸 68 点特征信息，同时使用一路摄像头保存模拟驾驶时的身体行为特征，作为疲

劳等级评判时进行等级标注的主要依据。 

（2）疲劳特征提取：主要通过数据处理提取疲劳驾驶特征值，建立疲劳数据集。首先

设计零相位偏移的 IIR 滤波器进行滤波处理原始雷达信号，分离出呼吸、心跳信号，经过频

谱分析，提取驾驶员生理信号特征。然后对人脸特征采集信息进行疲劳特征处理，引入眼睑

纵横比、嘴部纵横比和头部姿态估计提取合适的特征。最终选取呼吸信号的幅值𝐵(cid:3035)、呼吸
信号的频率𝐵(cid:3033)、心跳信号的频率𝐻(cid:3033)、眼部眨动频率𝐸(cid:3033)、瞌睡哈欠频率𝑌(cid:3033)、和点头俯仰角𝜃(cid:3043)六
个特征值，通过面部专家评判法与驾驶员主观评判法相结合建立疲劳驾驶等级评判制度，对

有效信息进行标签分类建立可靠的疲劳驾驶数据集。 

（3）疲劳状态识别模型设计：主要针对疲劳驾驶数据集设计一种分类模型用于疲劳驾

驶状态分类，由于 ROS-ELM 存在参数随机选取、性能不稳定、模型泛化能力弱的问题，并

对 ROS-ELM 进行优化，引入 LDA 特征融合技术，建立多源特征融合的 AWPSO-ROS-ELM

疲劳状态识别模型。通过与传统疲劳状态识别模型实验，对比测试发现特征融合后，具有较

好的疲劳状态识别率，其中本文设计的 AWPSO-ROS-ELM 识别准确率达到 95.42%，较特征

融合之前提升 13.5%。实验结果表明本文的非接触式多源特征融合的疲劳驾驶检测方法能够

有效提高疲劳检测准确度的同时避免对驾驶员行为造成影响。 

56 

本文的主要创新点如下： 

杭州电子科技大学硕士学位论文 

（1）设计非接触式疲劳驾驶数据采集系统。本文基于易驾星模拟驾驶系统设计多普勒

雷达模块和 Dlib 人脸识别模块对驾驶员非接触式信息采集，该数据采集系统可多信息源实

时采集驾驶员的生理信号和面部动态信息，不影响驾驶员操作，实验数据更真实可靠。 

（2）多信息源疲劳特征提取。设计零相位 IIR 滤波器处理冗杂的雷达信号，提取驾驶
员的呼吸幅值𝐵(cid:3035)、呼吸频率𝐵(cid:3033)、心跳频率𝐻(cid:3033)等生理信号特征。同时对 Dlib 人脸特征信息进
行处理，分析眼部纵横比、嘴部纵横比和头部姿态估计提取面部疲劳特征值，计算得到眨眼

频率𝐸(cid:3033)、打哈欠频率𝑌(cid:3033)、和点头俯仰角𝜃(cid:3043)。 

（3）设计 AWPSO-ROS-ELM 疲劳状态识别模型。在 RELM 基础上引入 ROS-ELM 网

络，增强了 RELM 的序贯学习能力，支持在线训练的模式。通过自适应权重粒子群算法对

ROS-ELM 进行优化，实现性能更强 AWPSO-ROS-ELM 疲劳状态识别模型。 

（4）多信息源疲劳特征融合。采用 LDA 特征融合技术与 AWPSO-ROS-ELM 相结合，

构建多源特征融合的疲劳状态识别模型，减少多源特征存在的信息重叠，提高疲劳检测准确

度。将设计的模型与经典分类算法 SVM、BPNN 进行实验对比，结果表明特征融合后的

AWPSO-ROS-ELM 在所设计的检测方法中具有最优的疲劳状态识别率。 

6.2 研究展望 

本文的疲劳驾驶实验只是基于模拟驾驶实验平台上研究和设计的，在实际道路行驶过程

中，疲劳驾驶检测结果容易受到道路情况、车辆环境以及驾驶员身体素质的影响，所检测的

信息采集模块稳定性还有待提升，在疲劳状态分类算法方面还可更深入探究。针对本文研究

内容，未来仍可以从下面几点进一步探索研究： 

（1）本文实验的疲劳等级判别主要依据面部专家评判与驾驶员主观评判相结合的评判

制度，只是通过双方主观的感受进行识别判定，难以对疲劳状态做出精确评判，这也导致识

别模型对中度疲劳状态识别率偏低，未来可以探索脑电波的变化规律作为更客观的评判依据。 

（2）本文对面部疲劳特征的提取比较依赖驾驶员的配合，由于人面部表情复杂多样应

避免选取易受干扰的特征。随着机器视觉技术的不断发展，可以根据每个驾驶员进行人脸三

维建模降低个体差异性，挖掘更多视频检测特征，并与微型红外摄像传感器相结合，可 24

小时全天候数据采集，提升特征提取的可信度。 

（3）设计滤波方法可以做进一步优化，由于生理信号微弱冗杂，采用更优秀的滤波算

法对多普勒雷达信号滤波分离。在分类检测时，本文选择的自适应权重粒子群优化算法增加

了模型训练时间，可以选择更快的优化算法对 ROS-ELM 模型改进，在保持高效训练的同时，

提升模型的精度和抗干扰能力。 

总之，随着科技高速发展，非接触式多源特征融合的疲劳驾驶检测技术必会持续发展，

在道路安全驾驶中扮演着越来越重要的角色。 

57 

杭州电子科技大学硕士学位论文 

致  谢 

时间如白驹过隙般飞快流逝，转眼间三年的研究生生活到了尾声。想起三年前收到研究

生录取通知书的激动时刻，对未来的杭电校园生活充满憧憬，不曾后悔自己努力拼搏考上研

究生。回首这三年的学习生活，起起伏伏，迷茫过也努力过，有过喜悦也有过挫败，从一个

懵懂小白逐渐成长起来。能够顺利走到今天，离不开身边人的支持与鼓励，在此要对你们致

以最真挚的感谢。 

首先要感谢我的研究生导师陈龙教授，在他的悉心指导下完成了这篇学位论文。陈龙教

授亦师亦友，在科研学习上给予了我莫大的帮助，很幸运研究生期间成为了陈老师的学生。

陈老师谦虚谨慎，待人热情，工作上认真负责、刻苦拼搏，始终保持着优良作风。这些美好

的品质，时刻在熏陶着我，教会我如何不畏困难，拼搏向上，能让我积极面对生活坎坷，受

益终身。从实验室项目到科研项目，给我提供了良好的研究学习环境，一步步指引我如何锻

炼自己，提升自身的能力，保质保量的完成项目任务。在研究课题上，陈老师尊重个人想法，

充分肯定我的思路，帮助我解决遇到的困难，让我的课题研究能够顺利进行。这里再向陈老

师致以最真诚的谢意和祝福，祝老师万事顺意。 

感谢我的各位同门，你们是我研究生生活最大组成成分。感谢智小杰师兄和葛文杰师兄

在课题仿真实验平台搭建上的巨大帮助。感谢颜斌、陈泽华、张铭元和储梦贤在实验测试以

及论文修改上的建议和帮助，在你们身上我学习到了很多优秀品质。 

感谢我的室友，徐豪、陈泽华和欧阳文卿，很荣幸能够成为你们的室友，你们的存在给

了我奋斗的精神动力，今后富贵勿相忘，有苦一直走。 

感谢我的家人对我支持和鼓励，从小到大，一直给我营造良好的成长环境，让我健康成

长，坚定地支持我，让我专心完成学业。谢谢你们的无私付出，让我有了坚强的后盾。你们

的养育之恩，我终身无以报答。 

最后感谢论文评审专家和答辩委员会的各位老师，祝老师们身体健康，阖家幸福。 

58 

杭州电子科技大学硕士学位论文 

参 考 文 献 

[1] Lin H, Xingqian B, Miao L, et al. Research on risky driving behavior evaluation model based on 

CIDAS real data[J]. Proceedings of the Institution of Mechanical Engineers, Part D: Journal of 

Automobile Engineering, 2021, 235(8). 

[2] Ramzan  M,  Khan  H  U,  Awan  S  M,  et  al.  A  Survey  on  state-of-the-art  Drowsiness  Detection 

Techniques[J]. IEEE Access, 2019, 7: 61904-61919. 

[3] Kamran M A, Mannan M M N, Jeong M Y. Drowsiness, Fatigue and Poor Sleep's Causes and 

Detection:A Comprehensive Study[J]. IEEE Access, 2019, 7: 167172-167186. 

[4] Klauer  S  G,  Dingus  T  A,  Neale  T  V,  et  al.  The  Impact  of  Driver  Inattention  on  Near-Crash 

Risk:An  Analysis  Using  the  100-Car  Naturalistic  Driving  Study  Data[J].  U.s.department  of 

Transportation Washington D.c, 2006. 

[5] Juan H, Zihui L. Multi-feature fatigue driving detection based on computer vision[J]. Journal of 

Physics:Conference Series, 2020, 1651(1). 

[6] Liu Y, Zhang T, Li Z. DCNN-based Real-time Driver Fatigue Behavior Detection in Urban Rail 

Transit[J]. IEEE Access, 2019, 7: 144648-144662. 

[7] 罗典媛. 基于驾驶员脑电信号警觉度检测的车辆速度控制研究[D]. 西南交通大学, 2016. 

[8] Yong  Du,  Yu  Wang,  Xin  Huang,  et  al.  Driver  State  Analysis  Based  on  Imperfect  Multi-view 

Evidence Support[J]. Neural Processing Letters, 2018, 48(1). 

[9] N.  Dong,  Y.  Li,  Z.  Gao,  et  al.  A  WPCA-Based  Method  for  Detecting  Fatigue  Driving  From 

EEG-Based Internet of Vehicles System[J]. IEEE Access, 2019, 7: 124702-124711. 

[10] Chun-Hsiang Chuang. An EEG-based perceptual function integration network for application 

to drowsy driving[J]. Knowledge-Based Systems, 2015, 80: 143-152. 

[11] Ding  D,  Lilt  D,  Zhang  S.  Fatigue  driving  detection  method  based  on  eeg  analysis  in  low-

voltage  and  hypoxia  plateau  environment[J].  International  Journal  of  Transportation  Science 

and Technology, 2020. 

[12] N.  Dong,  Y.  Li,  Z.  Gao,  et  al.  Yung.  A  WPCA-Based  Method  for  Detecting  Fatigue  Driving 

From EEG-Based Internet of Vehicles System[J]. IEEE Access, 2019, 7: 124702-124711. 

[13] 徐礼胜,  张闻勖,  庞宇轩,  吴承暘.  基于短时心电信号的疲劳驾驶检测算法[J].  东北大学学

报(自然科学版), 2019, 40(07): 937-941. 

[14] Henni Khadidja, Mezghani Neila, Gouin Vallerand Charles, et al, Ouakrim Youssef, Vallières 

Évelyne. Feature selection for driving fatigue characterization and detection using visual- and 

59 

signal-based sensors[J]. Applied Informatics, 2018, 5(1). 

杭州电子科技大学硕士学位论文 

[15] 曹景胜, 石晶, 李刚, 郭银景, 单鹏. 基于 PVDF 的汽车驾驶员心电呼吸监测系统研究[J]. 现

代电子技术, 2019, 42(10): 79-82+87. 

[16] Chen  P.  Research  on  driver  fatigue  detection  based  on  human  eye  state[C].  2017  Chinese 

Automation Congress (CAC). IEEE, 2017: 619-623. 

[17] Zhang W, Murphey Y L, Wang T, et al. Driver yawning detection based on deep con-volutional 

neural  learning  and  robust  nose  tracking[C].  International  Joint  Conference  on  Neural 

Networks (IJCNN). IEEE, 2015: 1-8. 

[18] Vural E, Cetin M, Ercil A, et al. Drowsy driver detection through facial movement analysis[C]. 

International Workshop on Human-Computer Interaction. Springer Berlin Heidelberg, 2007: 6-

18. 

[19] 冯宇航, 叶辉, 黄文禧. 基于头部多姿态融合识别的疲劳检测与预警研究[J]. 电脑知识与技

术, 2021, 17(13): 12-14. 

[20] 吴雅萱,  李文书,  施国生等.  疲劳驾驶检测技术研究综述[J].  工业控制计算机,  2011,  24(8): 

44-46. 

[21] Zuojin L, Shengbo L, Renjie L, et al. Online Detection of Driver Fatigue Using Steering Wheel 

Angles for Real Driving Conditions[J]. Sensors, 2017, 17(3): 495. 

[22] Mortazavi  A,  Eskandarian  A,  Sayed  R  A.  Effect  of  drowsiness  on  driving  performance 

variables  of  commercial  vehicle  drivers[J].  International  Journal  of  Automotive  Technology, 

2009, 10(3): 391-404. 

[23] 张希波, 成波, 冯睿嘉. 基于方向盘操作的驾驶人疲劳状态实时检测方法[J]. 清华大学学报

(自然科学版), 2010, 50(7): 23-36. 

[24] S.  Y.  Shi,  W.  Z.  Tang,  Y.  Y.  Wang.  A  Review  on  Fatigue  Driving  Detection[J].  ITM  Web  of 

Conferences, 2017, 12: 14-21. 

[25] J. Y. Zhang, W. W. Qiu, H. J. Fu, et al. Review of Techniques for Driver Fatigue Detection[J]. 

Applied Mechanics and Materials, 2013, Vols(433-435): 928-931. 

[26] Leng  L  B,  Giin  L  B,  Chung  W  Y.  Wearable  driver  drowsiness  detection  system  based  on 

biomedical and motion sensors[C]. Sensors. IEEE, 2016. 

[27] Tong  Zhang.  An  Introduction  to  Support  Vector  Machines  and  Other  Kernel-Based  Learning 

Methods[J]. AI magazine: Artificial intelligence, 2001, 22(2). 

[28] Shuyan H, Gangtie Z. Driver drowsiness detection with eyelid related parameters by Support 

Vector Machine[J]. Expert Systems with Applications, 2009, 36(4): 7651-7658. 

[29] M,  Mohamed,  Rabik.  Distributive  Aware  Probabilistic  Back  Propagation  (DAPBP)  Routing 

Scheme for Vehicular Networks[J]. Wireless Personal Communications, 2017, 97(1): 483-493. 

60 

杭州电子科技大学硕士学位论文 

[30] Ying  Y,  Jing  S,  Wei  Z.  The  Monitoring  Method  of  Driver's  Fatigue  Based  on  Neural 

Network[C].  2007  International  Conference  on  Mechatronics  and  Automation.  IEEE,  2007: 

3555-3559. 

[31] Wu  Z,  Tang  H,  He  S,  et  al.  Fast  dynamic  hysteresis  modeling  using  a  regularized  online 

sequential  extreme  learning  machine  with  forgetting  property[J].  International  Journal  of 

Advanced Manufacturing Technology, 2017. 

[32] 杨希宁.  基于多源信息融合的非接触式疲劳驾驶检测系统研究[D].  杭州电子科技大学, 

2017. 

[33] Fangzheng  Zhang  and  Jingzhan  Shi  and  Shilong  Pan.  Photonics-based  wideband  Doppler 

frequency shift measurement by in-phase and quadrature detection[J]. Electronics Letters, 2018, 

54(11): 708-710. 

[34] Chaitanya Krishna VB  et  al. Face Recognition Based Attendance Management System using 

DLIB[J]. International Journal of Engineering and Advanced Technology (IJEAT), 2019, 8(5s): 

57-61. 

[35] 赵晓琳. 基于面部信息的疲劳驾驶检测方法研究[D]. 吉林大学, 2016. 

[36] Ganapathi  Raju  Nadimpalli.  Driver's  Drowsiness  Detection  Using  Dlib  and  IoT[J]. 

International Journal of Sensors, Wireless Communications and Control, 2021, 11(7): 725-732. 

[37] Khan  Sajid  Ali  et  al.  An  Effective  Framework  for  Driver  Fatigue  Recognition  Based  on 

Intelligent Facial Expressions Analysis[J]. IEEE Access, 2018, 6: 67459-67468. 

[38] 李冰.  基于正则极限学习机的非接触式疲劳驾驶检测方法研究[D].  杭州电子科技大学, 

2020. 

[39] Abbas  Q,  Alsheddy  A.  Driver  Fatigue  Detection  Systems  Using  Multi-Sensors,  Smartphone, 

and Cloud-Based Computing Platforms: A Comparative Analysis[J]. Sensors, 2020, 21(1). 

[40] 汪依帆,  王敏,  李海龙.  基于 MATLAB 的 IIR 数字滤波器设计研究[J].  通讯世界,  2019, 

26(09): 226. 

[41] 文胜福,  王硕,  魏宇豪,  王浩.  基于 IIR 数字滤波器的人体脉搏信号分析[J].  科学技术创新, 

2020(15): 18-19. 

[42] Hu  J,  Min  J.  Automated  detection  of  driver  fatigue  based  on  EEG  signals  using  gradient 

boosting decision tree model[J]. Cognitive Neurodynamics, 2018. 

[43] 刘伟锋, 仝方. 基于眼部特征的疲劳驾驶检测算法研究[J]. 现代交通技术, 2017, 14(01): 69-

71. 

[44] Soukupova T, Cech J. Real-time eye blink detection using facial landmarks[C]. Proceedings of 

21st Computer Vision Winter Work-shop. CVWW, 2016. 

[45] 郭慧利,  王恁,  郭浩.  基于面部多特征的疲劳驾驶预警系统的研究[J].  通信学报,  2018, 

61 

39(S1): 22-29. 

杭州电子科技大学硕士学位论文 

[46] Gallup  Andrew  C,  Church  Allyson  M,  Pelegrino  Anthony  J.  Yawn  duration  predicts  brain 

weight and cortical neuron number in mammals[J]. Biology letters, 2016, 12(10). 

[47] Ruiz N, Chong E, Rehg J M. Fine-Grained Head Pose Estimation Without Keypoints[J]. IEEE, 

2018. 

[48] Gupta A, Thakkar K, Gandhi V, et al. Nose, eyes and ears: Head pose estimation by locating 

facial keypoints[J]. International Conference on Acoustics, Speech and Signal Processing, 2018: 

1977-1981. 

[49] Huber  P,  Hu  G,  Tena  R,  et  al.  A  multiresolution  3D  morphable  face  model  and  fitting 

framework[C].  International  Conference  on  Computer  Vision  Theory  and  Applications  (VIS 

APP), 2016:79-86. 

[50] Xu  S,  Sun  X  X,  Liu  S  G,  et  al.  Model  reference  approaching  method  of  camera  distortion 

calibration[J]. Acta Optica Sinica, 2013, 33(7): 224-235. 

[51] A.  Rahil.  Comparative  Analysis  of  Two  Different  Adjustment  Techniques  as  Applied  to  The 

Least Squares Processing of The Direct Linear Transformation (DLT)[J]. International Journal 

of Engineering and Advanced Technology (IJEAT), 2017, 6(4): 189-192. 

[52] He  Hu.  A  Real-time  Driver  Fatigue  Detection  Method  Based  on  Two-Stage  Convolutional 

Neural Network[J]. IFAC Papers On Line, 2020, 53(2): 15374-15379. 

[53] Wierwille W W, Ellsworth L A. Evaluation of driver drowsiness by trained raters[J]. Accident 

Analysis & Prevention, 1994, 26(5): 571-581. 

[54] Huang  G  B,  Zhu  Q  Y,  Siew  C  K.  Extreme  learning  machine:  a  new  learning  scheme  of 

feedforward  neural  networks[C].  IEEE  International  Joint  Conference  on  Neural  Networks. 

IEEE, 2005, 2: 985-990. 

[55] 吉新媛. 基于极限学习机的集成特征选择算法研究与应用[D]. 陕西师范大学, 2019. 

[56] Deng  W,  Zheng  Q,  Lin  C.  Regularized  Extreme  Learning  Machine[C].  IEEE  Symposium  on 

Computational Intelligence and Data Mining. IEEE, 2009: 389-395. 

[57] 李佳. 基于集成极限学习机的神经元分类算法研究[D]. 东华大学, t2017. 

[58] X.Q.  Liang,  Q.  Gao  ,  W.A.  Yao.  An  efficient  algorithm  based  on  group  theory  and  the 

Woodbury  formula  for  the  dynamic  responses  of  periodic  structures[J].  Computers  and 

Structures, 2017, 182: 238-251. 

[59] Kennedy  J,  Eberhart  R.  Particle  swarm  optimization[C].  Proceedings  of  IEEE  International 

Conference on Neural Networks. Piscataway, 1995: 1942-1948. 

[60] Ratnaweera  A,  Halgamuge  S  K,  Watson  H  C.  Self-Organizing  Hierarchical  Particle  Swarm 

Optimizer With Time-Varying Acceleration Coefficients[J]. IEEE Transactions on Evolutionary 

62 

Computation, 2004, 8(3): 240-255. 

杭州电子科技大学硕士学位论文 

[61] Lin Y F, Deng H M, Shi X Y. Application of BP Neural Network Based on Newly Improved 

Particle  Swarm  Optimization  Algorithm  in  Fitting  Nonlinear  Function[J].  Computer  Science, 

2017. 

[62] Zaharis Z D, Gravas I P, Yioultsis T V, et al. Exponential Log-Periodic Antenna Design Using 

Improved  Particle  Swarm  Optimization  with  Velocity  Mutation[J].  IEEE  Transactions  on 

Magnetics, 2017, 53(6): 1-4. 

[63] 蒋忠新,  蒋颖,  蒋光和.  基于机器学习的入侵检测方法性能评估[J].  企业技术开发,  2013, 

32(34): 1-4. 

[64] 方毅. 基于信息融合的驾驶员疲劳状态检测方法研究[D]. 哈尔滨工业大学, 2018. 

[65] 张娜,  刘坤,  韩美林,  陈晨.  一种基于 PCA 和 LDA 融合的人脸识别算法研究[J].  电子测量

技术, 2020, 43(13): 72-75. 

63 

杭州电子科技大学硕士学位论文 

附 录 

作者在读期间发表的学术成果及参加的科研项目 

A. 软件著作权 

[1]  一种多源特征融合的疲劳驾驶检测软件，授权时间为 2022.01（排名第一） 

B. 科研项目 

[1]  国家自然科学基金面上项目——非接触式多源信息融合的疲劳驾驶检测方法研究

（61771178） 

[2]  虚拟仿真实验室建设项目——远程数电实验平台 

C. 获奖情况 

[1]  杭州电子科技大学研究生学业奖学金二等奖，2019.10 
[2]  杭州电子科技大学研究生学业奖学金三等奖，2020.10 
[3]  第二届集成电路 EDA 设计精英挑战赛二等奖，2020.11 
[4]  杭州电子科技大学研究生学业奖学金三等奖，2021.10 

64 

 
